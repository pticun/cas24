define.experiment.Class("wixapps.apps.ecommerce.parts_logic.EcomStoreManageTrait.StoreManagerPopupWidth.New",function(e){var t=e;t.methods({getDataEditDialogParams:function(){this._addPostMessageEvent(this._handleMessageFromManage);var e=window.innerHeight-this.DIALOG_MARGIN;return e=this.DIALOG_MIN_HEIGHT>e?this.DIALOG_MIN_HEIGHT:e,{url:this._getStoreManageURL(),params:{width:992,height:e,title:this._localizer.localize("ECOM_MANAGE_ONLINE_STORE_TITLE"),description:this._localizer.localize("ECOM_MANAGE_ONLINE_STORE_DESC"),dialogSkin:"wysiwyg.editor.skins.dialogs.JustWindowDialogSkin",dialogId:"econManage",nonModal:!1},onClosedCallback:function(){this._dataProvider.reloadAllData()}.bind(this)}}})}),define.experiment.Class("wixapps.automation.EditorActions.AppBuilderListSettings2.New",function(e){e.methods({addPart2:function(e){e=e||"BasicPosts";var t=automation.observers.waitForSelectionChange().then(function(e){var t=Q.defer();return self._addedComponents.push(comp),automation.observers.waitForComponentState(e,"content").then(function(){t.resolve(e)}),t.promise});return resource.getResourceValue("W.AppsEditor2",function(t){t.getAppBuilderApplicationInstance(function(i){t._createAppPartFromTemplate(i,e,"list")})}),t}})}),define.experiment.Class("wixapps.core.apprepo.AppPartDefinition.AppBuilderPage.New",function(e,t){var i=e;i.traits(["wixapps.core.apprepo.traits.AppRepoItem"]),i.fields({_dataSelector:null,_viewName:null,_type:null,_displayName:null,_appPageId:"home"}),i.methods({initialize:function(e){this._appInstance=e},loadFromDefinition:function(e){this.setDataSelectorId(e.dataSelector),this.setViewName(e.viewName),this.setCustomizations(e.customizations),this.setEventHandlers(e.eventHandlers),this.setType(e.type),this.setDisplayName(e.displayName)},setDataSelectorId:function(e){this._dataSelector=e},getDataSelectorId:function(){return this._dataSelector},getDataSelector:function(){return this._appInstance.getDataSelectors().getById(this._dataSelector)},setViewName:function(e){this._viewName=e},getViewName:function(){return this._viewName},setType:function(e){this._type=e},getType:function(){return this._type},getTypeDef:function(){return this._appInstance.getTypesManager().getType(this._type)},setCustomizations:function(e){this._customizations=e},getCustomizations:function(){return this._customizations},setEventHandlers:function(e){this._eventHandlers=e},getEventHandlers:function(){return this._eventHandlers},setDisplayName:function(e){this._displayName=e},getDisplayName:function(){return this._displayName},getSerializableProperties:function(){return["dataSelector","viewName","type","displayName"]}})}),define.experiment.Class("wixapps.core.apprepo.AppPartsRepository.AppBuilderListSettings2.New",function(e){e.methods({createAndRegister:function(e,t,i,n){var a=new this.imports.AppPartDefinition(this._appInstance);a.setDataSelectorId(e),a.setViewName(t),a.setType(i),a.setDisplayName(n);var o=this.register("apppart",a);return o},filterByType:function(e,t){return this.filter(function(i){var n=i.getType()===e&&i.isUsed();if(t){var a=i.getDataSelector();return n&&!a.isPageBased()}return n})},countAppPartOfType:function(e,t){var i=this.filterByType(e,t);return i.length}})}),define.experiment.Class("wixapps.core.apprepo.AppPartsRepository.AppBuilderPage.New",function(e,t){var i=e;i.methods({createAndRegister:function(e,t,i,n){var a=new this.imports.AppPartDefinition(this._appInstance);a.setDataSelectorId(e),a.setViewName(t),a.setType(i),a.setDisplayName(n);var o=this.register("apppart",a);return o},filterByType:function(e,t){return this.filter(function(i){var n=i.getType()===e&&i.isUsed();if(t){var a=i.getDataSelector();return n&&!a.isPageBased()}return n})},countAppPartOfType:function(e,t){var i=this.filterByType(e,t);return i.length}})}),define.experiment.Class("wixapps.core.apprepo.ApplicationInstance2.AppBuilderListSettings2.New",function(e){e.methods({_migrateDefinitions:function(){var e=1,t=this._appDef.getAppPartDefinitions();for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];n.hasOwnProperty("displayName")||(n.displayName="List "+e,e++)}}})}),define.experiment.Class("wixapps.core.apprepo.ApplicationInstance2.AppBuilderPage.New",function(e,t){var i=e;i.methods({_migrateDefinitions:function(){var e=1,t=this._appDef.getAppPartDefinitions();for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];n.hasOwnProperty("displayName")||(n.displayName="List "+e,e++)}}})}),define.experiment.Class("wixapps.core.apprepo.DataSelectorsRepository.AppBuilderListSettings2.New",function(e){e.methods({createInstance:function(e,t,i,n){var a=null,o=n.itemIds||[],s=this._getInstanceClass({logicalTypeName:e});switch(a=new s(this._appInstance),a.setDataProvider(t),a.setSelectionType(i),e){case"IB.ManualSelectedList":a.setItemIds(o);break;case"IB.ManualSelectedItem":o.length&&(n.itemIds=o[0]),a.setItemId(o);break;case"IB.PageSelectedItem":a.setAppPageId(n.appPageId)}return a},createBasedOnOtherSelector:function(e){var t=this._appInstance.getDataSelectors(),i=e.getLogicalTypeName(),n=e.getDataProvider(),a=e.getSelectionType(),o=e.toObject(),s=t.createAndRegister(i,n,a,o),r=t.getById(s);return r}})}),define.experiment.Class("wixapps.core.apprepo.traits.AppRepoItem.AppBuilderListSettings2.New",function(e){e.methods({toObject:function(){var e=this.getSerializableProperties(),t={};return e.each(function(e){t[e]=_.clone(this["_"+e],!0)}.bind(this)),t}})}),define.experiment.Class("wixapps.core.data.providers.wixdb.WixDbDraftDataProvider.AppBuilderListSettings2.New",function(e,t){e.binds(t.merge(["_migrateDisplayName"])),e.methods({_addAdminTypeMigrations:function(){this._adminTypeMigrations.push(this._migrateLinks),this._adminTypeMigrations.push(this._ensureTitleField),this._adminTypeMigrations.push(this._migrateDisplayName)},_migrateDisplayName:function(e){for(var t=this.getManagedTypes(),i=[],n=0;t.length>n;n++){var a=t[n];a.name!=e.name&&i.push(a.displayName)}for(var o=0,s=e.displayName,r=s;i.contains(r);)o++,r=s+" "+o;return e.displayName=r,e}})}),define.experiment.Class("wixapps.core.data.providers.wixdb.WixDbDraftDataProvider.AppBuilderPage.New",function(e,t){var i=e,n=t;i.binds(n.merge(["_migrateDisplayName"])),i.methods({_addAdminTypeMigrations:n.after(function(){this._adminTypeMigrations.push(this._migrateDisplayName)}),_migrateDisplayName:function(e){for(var t=this.getManagedTypes(),i=[],n=0;t.length>n;n++){var a=t[n];a.name!=e.name&&i.push(a.displayName)}for(var o=0,s=e.displayName,r=s;i.contains(r);)o++,r=s+" "+o;return e.displayName=r,e}})}),define.experiment.Class("wixapps.core.data.selectors.AllItemsOfTypeDataSelector.AppBuilderListSettings2.New",function(e){e.methods({getItemIdIndex:function(e){return this.getItemIdRealIndex(e)},getItemIdRealIndex:function(e){return this.getItemsIdsLocally().indexOf(e)}})}),define.experiment.Class("wixapps.core.data.selectors.ListDataSelector.AppBuilderListSettings2.New",function(e){e.methods({_refresh:function(e,t){e||(e=function(){}),t||(t=function(){}),this.getItems(e,t)},setSelectedItemByIndex:function(e){this._selectedItemIndex=e,this.getAllItems(function(t){var i=t.getChildByIndex(e);this.setSelectedItem(i)}.bind(this),function(){})}})}),define.experiment.Class("wixapps.core.data.selectors.ManualSelectedListDataSelector.AppBuilderListSettings2.New",function(e){e.fields({_virtualArray:null}),e.methods({loadFromDefinition:function(e){this.parent(e),this._itemIds=e.itemIds,e.hiddenItemIds&&(this._itemIds=_.difference(this._itemIds,e.hiddenItemIds))},getItems:function(e,t){this._dataProvider.readItems(this.getSelectionType(),this._itemIds,function(t){this._virtualArray=this._virtualArray||this._dataItemFactory.createVirtualArray(),this._virtualArray.setChildren(t),this.fireEvent("dataSelectorRefreshed"),e(this._virtualArray)}.bind(this),t)},getAllItems:function(e,t){this.getItems(e,t)},getItemIdIndex:function(e){return this._itemIds.indexOf(e)},getBiInfo:function(){return{v:this._itemIds.length,h:0}}})}),define.experiment.component("wixapps.core.utils.ListCursor.AppBuilderListSettings2.New",function(e){e.methods({setSelectedIndex:function(e,t){if(e!=this._currentItemIndex){var i=this._currentItemIndex,n=this._getItemsLength();this._currentItemIndex=0===n?-1:e>=n?0:0>e?n-1:e,t||this.fireChangeEvent(this._currentItemIndex,i)}},hasSelection:function(){this._currentItemIndex>-1}})}),define.experiment.Class("wixapps.core.views.ProxyFactory.WixAppsApplicationData.New",function(e,t){var i=e,n=t;i.methods({initialize:n.after(function(e,t,i,n,a,o,s,r,l,p){this._externalVars=p}),createView:function(e,t,i){i=i||"view";var n={parent:void 0,vars:{}};this._externalVars&&this._externalVars.getChildrenRefs&&this._externalVars.getChildrenRefs().forEach(function(e){n.vars[e]=this._externalVars.getChildByRef(e)}.bind(this));var a=new this.imports.ViewEnvironment(this._dataItemFactory,this._typesManager,this,t,e.getTypeName(),i,this._eventDispatcher,[],n,void 0,this._lifecycleManager),o=new this.imports.ViewContext(a,e);return this._createViewInternal(o,t)}})}),define.experiment.Class("wixapps.core.views.ViewBuilder.AppBuilderListSettings2.New",function(e){e.methods({generatePageView:function(e,t,i){var n=_.clone(e,!0),a=this._findCompByNames(n,"FieldBox");if(0==a.length)throw"Cannot generate page view based on view with no field boxes";var o=_.findIndex(a,{id:t});-1==o&&(o=0);for(var s=a[o],r=0;a.length>r;r++)if(r!==o){var l=a[r];if(l.comp.items&&0!=l.comp.items.length){var p=o>r?"before":"after";"before"==p&&l.comp.items.reverse();for(var d="before"==p?s.comp.items.unshift:s.comp.items.push;l.comp.items.length>0;){var c=l.comp.items.shift();d.call(s.comp.items,c)}}}if(void 0!==i){var h=_.find(s.comp.items,{comp:{items:[{comp:{name:"Image"}}]}});if(h||(h=_.find(s.comp.items,{comp:{items:[{comp:{name:"Video"}}]}})),h&&h.comp&&h.comp.width>80){var u=h.comp.width;h.comp.width=i,h.comp.height=h.comp.height*i/u,h.comp.spacers["xax-before"]=0,h.comp.spacers["xax-after"]=0}}return n},getExtraFieldContainers:function(e){var t,i,n,a,o,s={},r=this._findCompByNames(e,"FieldBox");for(t=0;r.length>t;t++){if(n=r[t],o=[],n.comp.hasOwnProperty("items"))for(i=0;n.comp.items.length>i;i++)a=n.comp.items[i],o.push(a);s[n.id]=o}return s},getViewFieldsMapping:function(e){var t,i,n,a,o,s=[],r=function(e){return"object"===this._utils.getType(e)&&e.hasOwnProperty("comp")&&e.comp.hasOwnProperty("name")&&("Field"===e.comp.name||"TextField"===e.comp.name)}.bind(this),l=this._findCompByNames(e,"FieldBox");for(t=0;l.length>t;t++){n=l[t];var p=n.id;if(n.comp&&n.comp.editorData&&n.comp.editorData.displayName){var d=n.comp.editorData.displayName;this._localizer.isValidKey(d)&&(d=this._localizer.localize(this._localizer.getKeyValue(d),p)),p=d}if(s.push({containerId:n.id,containerName:p,containerFields:[],hasFields:!1,orientation:n.comp.orientation}),n.comp.items){for(i=0;n.comp.items.length>i;i++)a=n.comp.items[i],r(a)&&(this.isFieldHidden(e,a.id)?this.removeFieldFromView(e,a.id):(o=a.comp.items[0],s[t].containerFields.push({id:a.id,data:a.data,compName:o.comp.name,fieldType:a.comp.name,containerId:n.id,containerName:p})));s[t].containerFields.length>0&&(s[t].hasFields=!0)}}return s},removeFieldFromView:function(e,t){for(var i,n=this._findCompByNames(e,"FieldBox"),a=0;n.length>a;a++){var o=n[a];o.comp.items&&(o.comp.items=o.comp.items.filter(function(e){return e.id===t&&(i=e),e.id!==t}))}return i},_findCompByNames:function(e,t){if("string"===this._utils.getType(t)&&(t=[t]),"array"!==this._utils.getType(t))throw"ViewBuilder::_findCompByNames - argument compNames should be string of an array of strings but got '"+t+"'.";return this._find(e,function(e){return"object"===this._utils.getType(e)&&e.hasOwnProperty("comp")&&e.comp.hasOwnProperty("name")&&t.contains(e.comp.name)}.bind(this))}})}),define.experiment.Class("wixapps.core.views.proxies.ArrayProxy.AppBuilderListSettings2.New",function(e){e.methods({_onChildCreated:function(){},_onBeforeChildDisposed:function(){}})}),define.experiment.component("wixapps.integration.components.AppPart.AutoResizeEvent.New",function(e){var t=e;t.propertiesSchemaType("AppPartProperties"),t.methods({_onAppPartRenderComplete:function(){this._stylesheetManager.updateDocumentStylesheet(),this.fireEvent("proxyDisplayed",this._mainProxy),this._eventDispatcher.fireEvent(Constants.WixAppEvents.APP_VIEW_READY),this.fireEvent("autoSized"),this.setState("content"),window.requestAnimFrame(function(){this._updateHeight()}.bind(this))},_setupMainProxyListeners:function(e){var t=this;e.addEvent("wix:zoom-link:open-zoom",function(e){var i=e.zoomParams,n=t.getPartDef().zoomPartName,a=t._logic.getZoomExtraParams&&t._logic.getZoomExtraParams(),o=Object.merge(i.extraParams,a);t.getAppInstance().getZoomHandler().openZoomForItemsList(i.list,i.selectedIndex,n,o)}),e.addEvent("wix:edit-link:open-editor",function(e){var i=e.zoomParams,n=t.getPartDef().zoomPartName;t.getAppInstance().getZoomHandler().openZoomForItemsList(i.list,i.selectedIndex,n)}),e.addEvent("wix:app-link:navigate",function(e){t._navigateToAppPage(e)})}})}),define.experiment.component("wixapps.integration.components.AppPart.WixAppsApplicationData.New",function(e,t){var i=e;i.methods({_initializeProxyFactory:function(){this._stylesheetManager=new this.imports.StylesheetManager("#"+this.getID()),this._proxyFactory=new this.imports.ProxyFactory(this._appInstance.getDataItemFactory(),this._appInstance.getTypesManager(),this._viewDefinitions,this._eventDispatcher,this._appInstance.resolveResourcePath,this._appInstance.getPackageName(),this._lifecycleManager,this,this._stylesheetManager,this._appInstance.getAppVars()),(new this.imports.ProxyMap).registerComponentProxies(this._proxyFactory)},applyCustomizationRule:function(e,t){if("appVars"==e.fieldId)return this._appInstance.setAppVar(e.key,e.value),void 0;var i,n,a=this._data.get("appLogicCustomizations");e.type="AppPartCustomization";for(var o=0;a.length>o;o++)if(i=a[o],i.forType===e.forType&&i.view===e.view&&i.fieldId===e.fieldId&&i.mode===e.mode&&i.key===e.key){n=a.splice(o,1);break}a.push(e),this._ignoreUpdate=!t;var s=n?n[0]:void 0,r=this.getCustomizationDefaultValue(e.forType,e.view,e.fieldId,e.key),l=s?!this.injects().Utils.areObjectsEqual(e,s):r!=e.value;l&&this.injects().Commands.executeCommand("WViewerCommands.AppDataChange",[e,s,this]),this._data.fireDataChangeEvent(this._data,e,s,this,!0),this._ignoreUpdate=!1,this._applyCustomizationRulesToDefinitions(),this._eventDispatcher.fireEvent(Constants.WixAppEvents.APP_CONTENT_RESIZE),this._eventDispatcher.fireEvent(Constants.WixAppEvents.APP_PART_RESIZE),window.requestAnimFrame(function(){this.fireEvent("autoSized")}.bind(this))}})}),define.experiment.component("wixapps.integration.components.AppPart.WixAppsContentResize.New",function(e){e.methods({initialize:function(e,t,i){this.parent(e,t,i),this._logger=new this.imports.WixAppsLogger,this._appInstance=null,this._eventDispatcher=new this.imports.ProxyEventBus,this.setState("content"),this._resizeHandler=new this.imports.AppResizeHandler,this._lifecycleManager=new this.imports.LifecycleManager(this._eventDispatcher,!0),this._eventDispatcher.addEvent(Constants.WixAppEvents.APP_CONTENT_RESIZE,this._onContentResize),this.injects().Commands.registerCommand("WViewerCommands.AppDataChange",!0),this.setMaxH(8e3)},_activateHandlers:function(){this._resizeHandler.activateResizeHandler(this._eventDispatcher,this._skinParts.inlineContent)},_updateHeight:function(){this._allowHeightResize===!1&&(this.setHeight(this._getMinPhysicalHeight(),!1,!1),this.fireEvent("autoSizeChange"),this.fireEvent("autoSized"))}})}),define.experiment.component("wixapps.integration.components.AppPart2.AppBuilderListSettings2.New",function(e){e.methods({markNeedsDuplication:function(){throw"AppPart2 should not be duplicated"},onDuplicate:function(){throw"AppPart2 should not be duplicated"}})}),define.experiment.component("wixapps.integration.components.AppPart2.AppBuilderPage.New",function(e,t){var i=e,n=t;i.methods({markNeedsDuplication:n.remove(),onDuplicate:n.remove()})}),define.experiment.Class("wixapps.integration.components.ClippedParagraph.AutoResizeEvent.New",function(e,t){var i=e;i.methods({_clipParagraphByLines:function(e,t,i,n,a,o){var s=e!==this._paragraphClipping.getLastTextContent();s&&t.set("html",this._paragraphClipping.wrapWordsInSpans(e)),this._paragraphClipping.hideEllipsis(),this._paragraphLineMap.updateMap(t),this._paragraphClipping.showEllipsis();var r=Math.min(a,this._paragraphLineMap.getLineNum()),l=this._paragraphLineMap.getParagraphHeight(r),p=l/r;this._paragraphClipping.clipParagraph(e,t,i,l);var d=0;if("none"!==o&&a>r){var c=parseInt((a-r)*p,10);l+=c,"bottom"===o?d=c:"middle"===o&&(d=Math.floor(c/2))}n>0&&(l=Math.max(l,p*n)),t.setStyle("margin-top",d),this.setHeight(l,void 0,!1),this._view.setStyles({height:l}),this.fireEvent("autoSized")}})}),define.experiment.component("wixapps.integration.components.PaginatedGridGallery.AppBuilderListSettings2.New",function(e){e.skinParts({graphicCounter:{optional:!0,type:"wixapps.integration.components.Counter",skin:"wysiwyg.viewer.skins.paginatedgrid.counter.CounterGraphicSkin"}}),e.methods({render:function(){var e=this._data.get("items");this._displayerDict={},this._skinParts.counter&&this._skinParts.counter.set("text",this._getCounterText(this._currentItemIndex,e.length)),this._pageItemsCount=parseInt(this.getComponentProperty("numCols")*this._getRowNumber(),10),this._displayedItems=this._getPageItems(e,this._currentItemIndex);var t=this._displayedItems;if(e.length>this._pageItemsCount?(this._nextPageItems=this._getPageItems(e,this._getNextPageItemIndex()),this._prevPageItems=this._getPageItems(e,this._getPrevPageItemIndex()),t=t.concat(this._nextPageItems).concat(this._prevPageItems),this._skinParts.buttonNext.setStyles({display:"block"}),this._skinParts.buttonPrev.setStyles({display:"block"})):(this._skinParts.buttonNext.setStyles({display:"none"}),this._skinParts.buttonPrev.setStyles({display:"none"})),this._sequencer.createComponents(this._skinParts.itemsContainer,t),this._skinParts.graphicCounter){var i=Math.floor(this._currentItemIndex/this._pageItemsCount),n=Math.max(this._getTotalPageCount(),1);this._skinParts.graphicCounter.refresh(i,n)}},_checkSkinPartsVisibility:function(){this._skinParts&&(this._updateRollover(),this._skinParts.buttonPrev.setStyle("visibility",this.getComponentProperty("showNavigation")?"visible":"hidden"),this._skinParts.buttonNext.setStyle("visibility",this.getComponentProperty("showNavigation")?"visible":"hidden"),this._skinParts.counter&&this._skinParts.counter.setStyle("visibility",this.getComponentProperty("showCounter")?"visible":"hidden"),this._skinParts.rolloverHolder&&this._skinParts.rolloverHolder.setStyle("cursor",this.getComponentProperty("expandEnabled")?"pointer":"default"),this._skinParts.graphicCounter&&this._skinParts.graphicCounter.getViewNode().setStyle("visibility",this.getComponentProperty("showCounter")?"visible":"hidden"))}})}),define.experiment.component("wixapps.integration.components.PaginatedGridGallery.AppBuilderPage.New",function(e,t){var i=e,n=t;i.skinParts(n.merge({graphicCounter:{optional:!0,type:"wixapps.integration.components.Counter",skin:"wysiwyg.viewer.skins.paginatedgrid.counter.CounterGraphicSkin"}})),i.methods({render:n.after(function(){if(this._skinParts.graphicCounter){var e=Math.floor(this._currentItemIndex/this._pageItemsCount),t=Math.max(this._getTotalPageCount(),1);this._skinParts.graphicCounter.refresh(e,t)}}),_checkSkinPartsVisibility:n.after(function(){this._skinParts&&this._skinParts.graphicCounter&&this._skinParts.graphicCounter.getViewNode().setStyle("visibility",this.getComponentProperty("showCounter")?"visible":"hidden")})})}),define.experiment.component("wixapps.integration.components.editor.AppCustomizerBase.WixAppsApplicationData.New",function(e,t){var i=e;i.methods({_updateViewCustomizations:function(e,t){var i=W.AppsEditor.getViewsTree(t),n=!1;e.disposeFields(),this.removeEvents("customizationUpdate"),this._lastViewContext&&this._lastViewContext.getEnvironment()&&this._lastViewContext.getEnvironment().removeEventIncludedViewsChanged(this._refreshUpdateViewCustomizations),this._lastViewContext=t,this._lastPanel=e,this._lastViewContext.getEnvironment().addEventIncludedViewsChanged(this._refreshUpdateViewCustomizations);for(var a=[],o=0;i.length>o;o++){var s=i[o].getValue();if(s.customizations){for(var r=0;s.customizations.length>r;r++){var l=s.customizations[r];a.push({view:s,rule:l})}n=!0}}return a=this._sortCustomizations(a),a.forEach(function(i){var n;if(n=this._addCustomizationControl(e,i),n&&n.input){var a=function(e){var t=e.value;if(n.valToRule&&(t=n.valToRule(t)),this._isURMExperimentOpen&&this.injects().UndoRedoManager.startTransaction(),"comp.events"==i.rule.key){this._lastEventValues[i.view.forType+"|"+i.view.name+"|"+i.rule.fieldId]=t;var a=this._getRootProxy(),o=a.getElement("[vcfield='"+i.rule.fieldId+"']"),s=o.getViewProxy();s.fireEvent(t,e)}else this._applyCustomizationRule({forType:i.view.forType,view:i.view.name,fieldId:i.rule.fieldId,mode:i.rule.mode||"*",key:i.rule.key,value:t},!1)}.bind(this);n.input.addEvent("inputChanged",a);var o=function(e){var o,s=this._getViewRepo().getViewDefinition(i.view.forType,i.view.name);if("comp.events"==i.rule.key&&i.rule.fieldId&&this._lastEventValues[i.view.forType+"|"+i.view.name+"|"+i.rule.fieldId])o=this._lastEventValues[i.view.forType+"|"+i.view.name+"|"+i.rule.fieldId];else if("appVars"==i.rule.fieldId){var r=t.getEnvironment(),l=r.getVar(i.rule.key);o=l&&l.getValue()}else o=this.imports.ViewsCustomizer.getCurrentValue(s.getValue(),i.rule),void 0===o&&(o=n.defaultVal);n.ruleToVal&&(o=n.ruleToVal(o)),n.input.setValue(o),"comp.events"==i.rule.key&&e&&a({value:o})}.bind(this);this.addEvent("customizationUpdate",o),o(!0)}i.rule&&i.rule.input&&i.rule.input.spaceAfter&&e.addBreakLine(parseInt(i.rule.input.spaceAfter,10)+"px")}.bind(this)),e.setCollapsed(!n),n}})}),define.experiment.component("wixapps.integration.components.editor.DataEditorDialog.AppBuilderListSettings2.New",function(e){e.methods({_onDialogClosing:function(e){if(this._inSaveProcess)return!1;var t=this.resources.W.Commands.getCommand("WAppsEditorCommands.DataEditorFinish"),i={appId:this._targetComp.getDataItem().get("appInnerID")},n=this._appsEnvironment;if("DISCARD"==e.result||"CANCEL"==e.result){var a=function(){i.dataChanged=!1,t.execute(i),this._dialogWindow.closeDialog(),n.popDataServiceContext(),this.dispose()}.bind(this);return this.injects().EditorDialogs.openPromptDialog("Discard Changes","You have unsaved changes. Are you sure you want to discard them?","",this.resources.W.EditorDialogs.DialogButtonSet.YES_NO,function(e){e.result==this.resources.W.EditorDialogs.DialogButtons.YES&&setTimeout(a,0)}.bind(this),!1),!1}$$("body").removeEvent("click",this._closeAddItemCombo);var o=n.getDataService();if("SAVE"==e.result){var s,r=o.getItemCache(),l=[],p=[],d=[],c=r.getItemsMarkedAsDeleted(),h=c.length;r.each(function(e,t){!e.isDirty()&&e.getChildValue("_hash")||r.isItemMarkedAsNonPersistent(t)||l.push(t)});var u=function(){if(this._inSaveProcess=!1,d.length>0)this.injects().EditorDialogs.openErrorDialog("Error Saving Data","Please try again in a few minutes",s.code+"\n"+s.description,null);else{n.popDataServiceContext();try{var e=n.getItemCache();p.forEach(function(t){if(r.isItemMarkedAsDeleted(t))e.remove(t);else{var i=e.put(t,r.get(t).getValue(0));i.resetDirtyFlag()}})}catch(a){var o=n.getLogger();o.reportError(o.Errors.UNABLE_TO_REFRESH_AFTER_SAVE,this.$className,"onSuccess",o.SubCategory.DATA_EDITING)}var l=this.injects().EditorDialogs;l.openPromptDialog("Saved Successfully!","Data is saved successfully and published","",l.DialogButtonSet.OK),i.dataChanged=!0,t.execute(i),this._dialogWindow.closeDialog(),this._appsEnvironment.getAppInstance().fireEvent(Constants.WixAppEvents.INVALIDATE_PART_DATA,{}),this.dispose()}}.bind(this),m=function(e,t){return function(){"create"==t?p.unshift(e):p.push(e),l.length+h==p.length+d.length&&u()}},g=function(e){return function(t){s=t,d.push(e),l.length+h==p.length+d.length&&u()}};if(l.forEach(function(e){var t=r.get(e);t.getChildValue("_hash")?o.updateItem(r.idsFromKey(e).collectionId,t,m(e,"update"),g(e)):o.createItem(r.idsFromKey(e).collectionId,t,m(e,"create"),g(e))}),c.forEach(function(e){var t=r.idsFromKey(e);o.deleteItem(t.collectionId,t.itemId,m(e,"delete"),g(e))}),l.length>0||c.length>0)return this._inSaveProcess=!0,this.setState("saving"),!1;i.dataChanged=!1,t.execute(i),n.popDataServiceContext(),this._resizeHandler.deactivateResizeHandler(),this.dispose()}},dispose:function(){for(;this._listProxies.length;){var e=this._listProxies.pop();e.dispose()}}})}),define.experiment.Class("wixapps.integration.components.editor.DataEditorDialog.AppsBuilderPage.New",function(e,t){var i=e;i.methods({_onDialogClosing:function(e){if(this._inSaveProcess)return!1;var t=this.resources.W.Commands.getCommand("WAppsEditorCommands.DataEditorFinish"),i={appId:this._targetComp.getDataItem().get("appInnerID")},n=this._appsEnvironment;if("DISCARD"==e.result||"CANCEL"==e.result){var a=function(){i.dataChanged=!1,t.execute(i),this._dialogWindow.closeDialog(),n.popDataServiceContext(),this.dispose()}.bind(this);return this.injects().EditorDialogs.openPromptDialog("Discard Changes","You have unsaved changes. Are you sure you want to discard them?","",this.resources.W.EditorDialogs.DialogButtonSet.YES_NO,function(e){e.result==this.resources.W.EditorDialogs.DialogButtons.YES&&setTimeout(a,0)}.bind(this),!1),!1}$$("body").removeEvent("click",this._closeAddItemCombo);var o=n.getDataService();if("SAVE"==e.result){var s,r=o.getItemCache(),l=[],p=[],d=[],c=r.getItemsMarkedAsDeleted(),h=c.length;r.each(function(e,t){!e.isDirty()&&e.getChildValue("_hash")||r.isItemMarkedAsNonPersistent(t)||l.push(t)});var u=function(){if(this._inSaveProcess=!1,d.length>0)this.injects().EditorDialogs.openErrorDialog("Error Saving Data","Please try again in a few minutes",s.code+"\n"+s.description,null);else{n.popDataServiceContext();try{var e=n.getItemCache();p.forEach(function(t){if(r.isItemMarkedAsDeleted(t))e.remove(t);else{var i=e.put(t,r.get(t).getValue(0));i.resetDirtyFlag()}})}catch(a){var o=n.getLogger();o.reportError(o.Errors.UNABLE_TO_REFRESH_AFTER_SAVE,this.$className,"onSuccess",o.SubCategory.DATA_EDITING)}var l=this.injects().EditorDialogs;l.openPromptDialog("Saved Successfully!","Data is saved successfully and published","",l.DialogButtonSet.OK),i.dataChanged=!0,t.execute(i),this._dialogWindow.closeDialog(),this._appsEnvironment.getAppInstance().fireEvent(Constants.WixAppEvents.INVALIDATE_PART_DATA,{}),this.dispose()}}.bind(this),m=function(e,t){return function(){"create"==t?p.unshift(e):p.push(e),l.length+h==p.length+d.length&&u()}},g=function(e){return function(t){s=t,d.push(e),l.length+h==p.length+d.length&&u()}};if(l.forEach(function(e){var t=r.get(e);t.getChildValue("_hash")?o.updateItem(r.idsFromKey(e).collectionId,t,m(e,"update"),g(e)):o.createItem(r.idsFromKey(e).collectionId,t,m(e,"create"),g(e))}),c.forEach(function(e){var t=r.idsFromKey(e);o.deleteItem(t.collectionId,t.itemId,m(e,"delete"),g(e))}),l.length>0||c.length>0)return this._inSaveProcess=!0,this.setState("saving"),!1;i.dataChanged=!1,t.execute(i),n.popDataServiceContext(),this._resizeHandler.deactivateResizeHandler(),this.dispose()}},dispose:function(){for(;this._listProxies.length;){var e=this._listProxies.pop();e.dispose()}}})}),define.experiment.component("wixapps.integration.components.editor.DataItemEditorDialog.AppBuilderListSettings2.New",function(e){e.methods({_startEditItem:function(e){this._containmentOptions=this._model.getChildContainmentOptions(e.getTypeName()),this._containmentOptions.relation==Constants.DataEditingModel.ContainmentOptions.NONE?(this._skinParts.addToBtn.collapse(),this.setState("parentNonEditable","parentsEditing")):this._containmentOptions.relation==Constants.DataEditingModel.ContainmentOptions.ONE_TO_MANY_REFERENCE?(this._skinParts.addToBtn.setLabel(this._loc("MoveTo")),this._skinParts.addToHeader.appendText(this._loc("CancelMove")),this._allowMultiParents=!1):(this._skinParts.addToBtn.setLabel(this._loc("AddTo")),this._skinParts.addToHeader.appendText(this._loc("AddTo")),this._allowMultiParents=!0);var t=this._model.getTypeFriendlyName(e.getTypeName());this._isNewItem?this._dialogWindow.setTitle(this._loc("Add")+" "+t):this._dialogWindow.setTitle(this._loc("Edit")+" "+t),this._dialogWindow.clearTabs(),this._eventDispatcher=new this.imports.ProxyEventBus,this._resizeHandler=new this.imports.AppResizeHandler,this._resizeHandler.activateResizeHandler(this._eventDispatcher,this._view),this._stylesheetManager=new this.imports.StylesheetManager("#"+this.getID()),this._proxyFactory=new this.imports.ProxyFactory(this._appsEnvironment.getDataItemFactory(),this._appsEnvironment.getTypesManager(),this._appsEnvironment.getViewDefRepo(),this._eventDispatcher,this._appsEnvironment.getAppInstance().resolveResourcePath,this._appsEnvironment.getAppInstance().getPackageName(),new this.imports.LifecycleManager(this._eventDispatcher),this._appsEnvironment.getAppPart(),this._stylesheetManager),(new this.imports.ProxyMap).registerComponentProxies(this._proxyFactory),this._originalItem=e,this._editedItem=this._createEditableCopy(this._appsEnvironment.getDataItemFactory(),e),this._autoAddToParent&&this._connectToParent(this._autoAddToParent),this._showContainmentControls(),this.proxy=this._proxyFactory.createView(this._editedItem,"editorForm","edit");var i=this.proxy.createComponent();this.proxy.setupProxy(),window.requestAnimFrame(function(){this.proxy.updateLayoutWhenReady()}.bind(this)),this._skinParts.editViewContainer.empty(),this._skinParts.editViewContainer.grab(i),proxy.setupProxy(),this._stylesheetManager.updateDocumentStylesheet(),window.requestAnimFrame(function(){proxy.updateLayoutWhenReady()})},_onDialogClosing:function(e){if("CANCEL"==e.result)this._onCloseCallback&&this._onCloseCallback([{action:"cancel",originalItem:this._originalItem,editedItem:this._editedItem}]);else if("DELETE"==e.result)this._deleteItem();else{var t=this._appsEnvironment.getTypesManager().validateDataItem(this._editedItem);if(!t)return!1;if(W.Commands.executeCommand("WAppsEditorCommands.FinalizeDataItemEditing"),"DUPLICATE"==e.result)this._saveAsDuplicate();else if(("OK"==e.result||"OK_ADD_ANOTHER"==e.result)&&(this._isNewItem&&this._isRef&&(this._originalItem=this._model.addToCache(this._model.getItemDefaultCollection(this._originalItem.getTypeName()),this._originalItem.getValue(0))),this._editedItem.isDirty()&&(this._originalItem.isRef()?this._originalItem.setReferencedValue(this._editedItem.getValue(0)):this._originalItem.setValue(this._editedItem.getValue(0))),this._applyReparentingActions(this._originalItem),this._onCloseCallback&&this._onCloseCallback([{action:"update",originalItem:this._originalItem,editedItem:this._editedItem}]),"OK_ADD_ANOTHER"==e.result)){var i=this._model.getItemTemplate(this._editedItem.getTypeName(),this._isRef);return this._startEditItem(i),!1}}$(document.body).setStyle("overflow",this._bodyOverFlow),this._resizeHandler.deactivateResizeHandler(),this.dispose()},dispose:function(){this.proxy.dispose(),this._stylesheetManager&&this._stylesheetManager.reset()}})}),define.experiment.Class("wixapps.integration.components.editor.DataItemEditorDialog.AppsBuilderPage.New",function(e,t){var i=e;i.methods({_startEditItem:function(e){this._containmentOptions=this._model.getChildContainmentOptions(e.getTypeName()),this._containmentOptions.relation==Constants.DataEditingModel.ContainmentOptions.NONE?(this._skinParts.addToBtn.collapse(),this.setState("parentNonEditable","parentsEditing")):this._containmentOptions.relation==Constants.DataEditingModel.ContainmentOptions.ONE_TO_MANY_REFERENCE?(this._skinParts.addToBtn.setLabel("Move to"),this._skinParts.addToHeader.appendText("Cancel move"),this._allowMultiParents=!1):(this._skinParts.addToBtn.setLabel("Add to"),this._skinParts.addToHeader.appendText("Add to"),this._allowMultiParents=!0);
var t=this._model.getTypeFriendlyName(e.getTypeName());this._isNewItem?this._dialogWindow.setTitle("Add "+t):this._dialogWindow.setTitle("Edit "+t),this._dialogWindow.clearTabs(),this._eventDispatcher=new this.imports.ProxyEventBus,this._resizeHandler=new this.imports.AppResizeHandler,this._resizeHandler.activateResizeHandler(this._eventDispatcher,this._view),this._proxyFactory=new this.imports.ProxyFactory(this._appsEnvironment.getDataItemFactory(),this._appsEnvironment.getTypesManager(),this._appsEnvironment.getViewDefRepo(),this._eventDispatcher,this._appsEnvironment.getAppInstance().resolveResourcePath,this._appsEnvironment.getAppInstance().getPackageName(),new this.imports.LifecycleManager(this._eventDispatcher)),(new this.imports.ProxyMap).registerComponentProxies(this._proxyFactory),this._originalItem=e,this._editedItem=this._createEditableCopy(this._appsEnvironment.getDataItemFactory(),e),this._autoAddToParent&&this._connectToParent(this._autoAddToParent),this._showContainmentControls(),this._proxy=this._proxyFactory.createView(this._editedItem,"editorForm","edit");var i=this._proxy.createComponent();this._proxy.setupProxy(),window.requestAnimFrame(function(){this._proxy.updateLayoutWhenReady()}.bind(this)),this._skinParts.editViewContainer.empty(),this._skinParts.editViewContainer.grab(i)},_onDialogClosing:function(e){if("CANCEL"==e.result)this._onCloseCallback&&this._onCloseCallback([{action:"cancel",originalItem:this._originalItem,editedItem:this._editedItem}]);else if("DELETE"==e.result)this._deleteItem();else{var t=this._appsEnvironment.getTypesManager().validateDataItem(this._editedItem);if(!t)return!1;if(W.Commands.executeCommand("WAppsEditorCommands.FinalizeDataItemEditing"),"DUPLICATE"==e.result)this._saveAsDuplicate();else if(("OK"==e.result||"OK_ADD_ANOTHER"==e.result)&&(this._isNewItem&&this._isRef&&(this._originalItem=this._model.addToCache(this._model.getItemDefaultCollection(this._originalItem.getTypeName()),this._originalItem.getValue(0))),this._editedItem.isDirty()&&(this._originalItem.isRef()?this._originalItem.setReferencedValue(this._editedItem.getValue(0)):this._originalItem.setValue(this._editedItem.getValue(0))),this._applyReparentingActions(this._originalItem),this._onCloseCallback&&this._onCloseCallback([{action:"update",originalItem:this._originalItem,editedItem:this._editedItem}]),"OK_ADD_ANOTHER"==e.result)){var i=this._model.getItemTemplate(this._editedItem.getTypeName(),this._isRef);return this._startEditItem(i),!1}}$(document.body).setStyle("overflow",this._bodyOverFlow),this._resizeHandler.deactivateResizeHandler(),this.dispose()},dispose:function(){this._proxy.dispose()}})}),define.experiment.component("wixapps.integration.components.inputs.TextInput.AppBuilderListSettings2.New",function(e){e.methods({_changeEventHandler:function(e){if(!e.code||W.Utils.isInputKey(e.code)){if(13==e.code)return this.fireEvent("enterPressed"),void 0;this._skinParts.input.set("isPreset","");var t=this.getValue();t=this.injects().Utils.convertToHtmlText(t);var i={value:t,origEvent:e,compLogic:this};this.fireEvent("inputChanged",i)}}})}),define.experiment.component("wixapps.integration.components.panels.AppBuilderDialogPanel.AppBuilderListSettings2.New",function(e,t){e.skinParts({titleContent:{type:"htmlElement",optional:!0}}),e.resources(t.merge(["W.AppsGUI"])),e.methods({setupPanel:function(e,t,i){if(this.parent(e,t,i),this._skinParts.titleContent){var n=e.getDataItemFactory(),a=this.resources.W.AppsGUI.getViewDescriptor("DataPanelTitleView");a.forType=this._panelModel.getChildValue("_type")||("Array"!=a.forType?"wix:Object":"Array"),a.vars=a.vars||{},a.vars.presenter={};var o=this._viewDefRepo.setViewDefinition(a,!0);this._createPresenterVars(i,o),this._titleContentViewHolder=new this.imports.ViewHolder(n,this._typeManager,this._viewDefRepo,e.resolveResourcePath),this._updateTitleContentViewHolder()}this._hideDescription&&this._skinParts.panelDescription.collapse(),this._helpId&&this._skinParts.help.addEvent("click",this._openHelpDialog),this._skinParts.close&&this._skinParts.close.addEvent(Constants.CoreEvents.CLICK,this._onClose),this._skinParts.paneCloseBtn&&(this._skinParts.paneCloseBtn.addEvent(Constants.CoreEvents.CLICK,this._onExpand),this._skinParts.paneCloseBtn.set("text",this.resources.W.Resources.get("EDITOR_LANGUAGE","close")));var s=window.getSize(),r={x:[10,s.x-this.DRAG_OFFSET],y:[this.DRAG_OFFSET,s.y-this.DRAG_OFFSET]};this._drag=new Drag.Move(this._dialogBox,{snap:0,handle:this._skinParts.titleContent||this._skinParts.panelLabel,limit:r})},_updateTitleContentViewHolder:function(){this._titleContentViewHolder.setContainer(this._skinParts.titleContent),this._skinParts.titleContent.addClass("wixAppsGui"),this._presenter.runWhenReady?this._presenter.runWhenReady(function(){this._titleContentViewHolder.setupViewHolder(this._panelModel,"DataPanelTitleView","")}.bind(this)):this._titleContentViewHolder.setupViewHolder(this._panelModel,"DataPanelTitleView","")}})}),define.experiment.component("wixapps.integration.components.panels.AppBuilderDialogPanel.AppBuilderPage.New",function(e,t){var i=e;i.skinParts({titleContent:{type:"htmlElement",optional:!0},panelLabel:{type:"htmlElement"},panelDescription:{type:"htmlElement"},help:{type:"htmlElement",optional:!0},close:{type:"htmlElement",optional:!0},paneCloseBtn:{type:"htmlElement",optional:!0},inlineContent:{type:"htmlElement"}}),i.resources(["W.Resources","W.Commands","W.AppsGUI"]),i.methods({_updateTitleContentViewHolder:function(){this._titleContentViewHolder.setContainer(this._skinParts.titleContent),this._skinParts.titleContent.addClass("wixAppsGui"),this._presenter.runWhenReady?this._presenter.runWhenReady(function(){this._titleContentViewHolder.setupViewHolder(this._panelModel,"DataPanelTitleView","")}.bind(this)):this._titleContentViewHolder.setupViewHolder(this._panelModel,"DataPanelTitleView","")},setupPanel:function(e,t,i){if(this.parent(e,t,i),this._skinParts.titleContent){var n=e.getDataItemFactory(),a=this.resources.W.AppsGUI.getViewDescriptor("DataPanelTitleView");a.forType=this._panelModel.getChildValue("_type")||("Array"!=a.forType?"wix:Object":"Array"),a.vars=a.vars||{},a.vars.presenter={};var o=this._viewDefRepo.setViewDefinition(a,!0);this._createPresenterVars(i,o),this._titleContentViewHolder=new this.imports.ViewHolder(n,this._typeManager,this._viewDefRepo,e.resolveResourcePath),this._updateTitleContentViewHolder()}this._hideDescription&&this._skinParts.panelDescription.collapse(),this._helpId&&this._skinParts.help.addEvent("click",this._openHelpDialog),this._skinParts.close&&this._skinParts.close.addEvent(Constants.CoreEvents.CLICK,this._onClose),this._skinParts.paneCloseBtn&&(this._skinParts.paneCloseBtn.addEvent(Constants.CoreEvents.CLICK,this._onExpand),this._skinParts.paneCloseBtn.set("text",this.resources.W.Resources.get("EDITOR_LANGUAGE","close")));var s=window.getSize(),r={x:[10,s.x-this.DRAG_OFFSET],y:[this.DRAG_OFFSET,s.y-this.DRAG_OFFSET]};this._drag=new Drag.Move(this._dialogBox,{snap:0,handle:this._skinParts.titleContent||this._skinParts.panelLabel,limit:r})}})}),define.experiment.component("wixapps.integration.components.panels.AppBuilderManageDialog.AppBuilderListSettings2.New",function(e){e.methods({_initSkinParts:function(){var e=this._skinParts;this.resources.W.Commands.executeCommand(Constants.EditorUI.CLOSE_PROPERTY_PANEL),this.resources.W.Commands.executeCommand(Constants.EditorUI.CLOSE_ALL_PANELS),e.customizeItemTemplatePane.addEvent("closeClicked",this._closeDialog);var t=this.resources.W.AppsGUI;e.manageItemsPane.setupPanel(this._appInstance,t.getViewDescriptor("ManageItemsView"),this._manageItemPresenter),e.manageItemsPane.setTitle(this._loc("ManageItemsTitle")),e.manageItemsPane.setDescription(this._loc("ManageItemsDescription")),e.manageItemsPane.addEvent("expandIconClicked",this._expandCollapse);var i;i=this._appPart.getDataSelector().isPageBased()?this._typeDef.displayName:this._appPart.getAppPartDefinition().getDisplayName(),e.customizeItemTemplatePane.setTitle(i),e.customizeItemTemplatePane.setupPanel(this._appInstance,t.getViewDescriptor("CustomizeItemsView"),this._customizeItemsPresenter),e.itemDataPane.setTitle(""),e.itemDataPane.setDescription(""),e.itemDataPane.setupPanel(this._appInstance,t.getViewDescriptor("DataEditView"),this._dataEditPresenter),e.itemDataPane.addEvent("closeClicked",this._closeDialog),e.itemDataPane.getState("expanded")||(e.itemDataPane.setState("collapsed","expanded"),this.setState("collapsed","expanded")),this._skinParts.tabs.addEvent(Constants.CoreEvents.CLICK,this._onTabChanged),this._skinParts.tabs.getElement("[rel=dataPane]").set("html",this._loc("Tab_Data")),this._skinParts.tabs.getElement("[rel=templatePane]").set("html",this._loc("Tab_Template"));var n=window.getSize(),a={x:[10,n.x-this._dialogWindow.DRAG_OFFSET],y:[this._dialogWindow.DRAG_OFFSET,n.y-this._dialogWindow.DRAG_OFFSET]},o=this._dialogWindow._skinParts.dialogBox;this._drag=new Drag.Move(o,{snap:0,handle:this._skinParts.tabs,limit:a}),this.changeTab(this._defaultState)},changeTab:function(e){var t=this._skinParts.tabs.getElement("[rel="+e+"]");e!=this.getState("panes")&&(this._onTabChanged({target:t}),this.setState(e,"panes")),this._showTabHelp()},_onTabChanged:function(e){if(e&&e.target&&e.target!=this._skinParts.tabs){for(var t=e.target,i=this._skinParts.tabs.childNodes,n=0;i.length>n;n++)i[n]!=t?i[n].removeClass("selectedTab"):i[n].addClass("selectedTab");var a=t.get("rel");this._state=a,this.setState(a,"panes"),this._getActiveTab().getViewHolder().invalidateSize(),this._showTabHelp()}},_showTabHelp:function(){if(this._appPart.getDataSelector().isPageBased())this.resources.W.Commands.executeCommand("WAppsEditor2Commands.OpenHelpBubble",{appPart:this._appPart,ftHelpSetName:"FT_HELP_AFTER_ENABLE_PAGE",anchorElement:this._getActiveTab().getHelpIconElement()});else{var e=this._appInstance.getAppPartDefinitions(),t=e.filter(function(e){var t=e.getType()===this._typeName,i=e.getDataSelector().isPageBased();return t&&!i}.bind(this));t.length>1&&this.resources.W.Commands.executeCommand("WAppsEditor2Commands.OpenHelpBubble",{appPart:this._appPart,ftHelpSetName:"FT_AFTER_COPY_LIST",anchorElement:this._getActiveTab().getHelpIconElement()})}},_closeDialog:function(){this._dialogWindow.closeDialog(),this.dispose()},_removeCursor:function(){this._selectionHandler.dispose(),this._listCursor.removeEvent(Constants.WixAppEvents.SELECTED_INDEX_CHANGED,this._listCursorChanged)},_disposeSkinParts:function(){var e=this._skinParts;e.manageItemsPane.dispose(),e.customizeItemTemplatePane.dispose(),e.itemDataPane.dispose()},dispose:function(){this._skinParts.customizeItemTemplatePane.removeEvent("closeClicked",this._closeDialog),this._skinParts.itemDataPane.removeEvent("closeClicked",this._closeDialog),this._skinParts.itemDataPane.removeEvent("expandIconClicked",this._expandCollapse),this._dataEditPresenter.removeEvent("expandIconClicked",this._expandCollapse),this._skinParts.tabs.removeEvent(Constants.CoreEvents.CLICK,this._onTabChanged),this._selectionHandler.enableClickPropagation(),this._removeListeners(),this._disposePresenters()}})}),define.experiment.component("wixapps.integration.components.panels.AppBuilderManageDialog.AppBuilderPage.New",function(e,t){var i=e,n=t;i.methods({_initSkinParts:function(){var e=this._skinParts;this.resources.W.Commands.executeCommand(Constants.EditorUI.CLOSE_PROPERTY_PANEL),this.resources.W.Commands.executeCommand(Constants.EditorUI.CLOSE_ALL_PANELS),e.customizeItemTemplatePane.addEvent("closeClicked",this._closeDialog);var t=this.resources.W.AppsGUI;e.manageItemsPane.setupPanel(this._appInstance,t.getViewDescriptor("ManageItemsView"),this._manageItemPresenter),e.manageItemsPane.setTitle(this._loc("ManageItemsTitle")),e.manageItemsPane.setDescription(this._loc("ManageItemsDescription")),e.manageItemsPane.addEvent("expandIconClicked",this._expandCollapse);var i;i=this._appPart.getDataSelector().isPageBased()?this._typeDef.displayName:this._appPart.getAppPartDefinition().getDisplayName(),e.customizeItemTemplatePane.setTitle(i),e.customizeItemTemplatePane.setupPanel(this._appInstance,t.getViewDescriptor("CustomizeItemsView"),this._customizeItemsPresenter),e.itemDataPane.setTitle(""),e.itemDataPane.setDescription(""),e.itemDataPane.setupPanel(this._appInstance,t.getViewDescriptor("DataEditView"),this._dataEditPresenter),e.itemDataPane.addEvent("closeClicked",this._closeDialog),e.itemDataPane.getState("expanded")||(e.itemDataPane.setState("collapsed","expanded"),this.setState("collapsed","expanded")),this._skinParts.tabs.addEvent(Constants.CoreEvents.CLICK,this._onTabChanged),this._skinParts.tabs.getElement("[rel=dataPane]").set("html",this._loc("Tab_Data")),this._skinParts.tabs.getElement("[rel=templatePane]").set("html",this._loc("Tab_Template"));var n=window.getSize(),a={x:[10,n.x-this._dialogWindow.DRAG_OFFSET],y:[this._dialogWindow.DRAG_OFFSET,n.y-this._dialogWindow.DRAG_OFFSET]},o=this._dialogWindow._skinParts.dialogBox;this._drag=new Drag.Move(o,{snap:0,handle:this._skinParts.tabs,limit:a}),this.changeTab(this._defaultState)},changeTab:function(e){var t=this._skinParts.tabs.getElement("[rel="+e+"]");e!=this.getState("panes")&&(this._onTabChanged({target:t}),this.setState(e,"panes")),this._showTabHelp()},_onTabChanged:n.after(function(){this._showTabHelp()}),_showTabHelp:function(){if(this._appPart.getDataSelector().isPageBased())this.resources.W.Commands.executeCommand("WAppsEditor2Commands.OpenHelpBubble",{appPart:this._appPart,ftHelpSetName:"FT_HELP_AFTER_ENABLE_PAGE",anchorElement:this._getActiveTab().getHelpIconElement()});else{var e=this._appInstance.getAppPartDefinitions(),t=e.filter(function(e){var t=e.getType()===this._typeName,i=e.getDataSelector().isPageBased();return t&&!i}.bind(this));t.length>1&&this.resources.W.Commands.executeCommand("WAppsEditor2Commands.OpenHelpBubble",{appPart:this._appPart,ftHelpSetName:"FT_AFTER_COPY_LIST",anchorElement:this._getActiveTab().getHelpIconElement()})}},_removeCursor:function(){this._selectionHandler.dispose(),this._listCursor.removeEvent(Constants.WixAppEvents.SELECTED_INDEX_CHANGED,this._listCursorChanged)},_disposeSkinParts:function(){var e=this._skinParts;e.manageItemsPane.dispose(),e.customizeItemTemplatePane.dispose(),e.itemDataPane.dispose()},_closeDialog:function(){this._dialogWindow.closeDialog(),this.dispose()},dispose:function(){this._skinParts.customizeItemTemplatePane.removeEvent("closeClicked",this._closeDialog),this._skinParts.itemDataPane.removeEvent("closeClicked",this._closeDialog),this._skinParts.itemDataPane.removeEvent("expandIconClicked",this._expandCollapse),this._dataEditPresenter.removeEvent("expandIconClicked",this._expandCollapse),this._skinParts.tabs.removeEvent(Constants.CoreEvents.CLICK,this._onTabChanged),this._selectionHandler.enableClickPropagation(),this._removeListeners(),this._disposePresenters()}})}),define.experiment.component("wixapps.integration.components.panels.BuilderDialogPanel.AppBuilderListSettings2.New",function(e,t){e.states(t.merge(["loading","error","rendering","content"])),e.methods({setupPanel:function(e,t,i,n){var a=e.getDataItemFactory();this._presenter=i,this._typeManager=e.getTypesManager(),this._viewDefRepo=new this.imports.ViewDefinitionsRepository(a),this._viewHolder=new this.imports.ViewHolder(a,this._typeManager,this._viewDefRepo,e.resolveResourcePath),this._eventBinding=new this.imports.EventBinding(this._viewHolder.getEventDispatcher(),this._presenter);var o=this;this._presenter.setupPresenter(this),this._panelModel=i.getModel(),this._presenter.addEvent&&this._presenter.addEvent(Constants.WixAppsGUIEvents.MODEL_REPLACED,this._onModelReplaced);var s=this._panelModel.getChildValue("_type");if(s&&"[MODEL_TYPE]"===t.forType&&(t.forType=s),t.vars=t.vars||{},t.vars.presenter={},this._viewDefDataItem=this._viewDefRepo.setViewDefinition(t,!0),this._createPresenterVars(i,this._viewDefDataItem),n)for(var r=0;n.length>r;r++){var l=n[r];s&&(l.forType=l.forType.replace("[MODEL_TYPE]",s)),l.vars=l.vars||{},l.vars.presenter={};var p=this._viewDefRepo.setViewDefinition(l,!0);this._createPresenterVars(i,p)}this._view&&this._updateViewHolder(function(){var e=o._viewHolder.getRootProxy(),t=e.getViewDefinition().getValue();o._eventBinding.setupHandlers(t),_.forEach(n,function(e){o._eventBinding.setupHandlers(e)})}),this._dialogWindow&&this._dialogWindow.addEvent("onDialogClosing",this._onBeforeDialogClose)},_updateViewHolder:function(e){this._viewHolder.setContainer(this._skinParts.inlineContent);var t=this._viewDefDataItem.getChildValue("name");this._skinParts.inlineContent.addClass("wixAppsGui"),this._presenter.runWhenReady?this._presenter.runWhenReady(function(){this._viewHolder.setupViewHolder(this._panelModel,t,""),e&&e()}.bind(this)):(this._viewHolder.setupViewHolder(this._panelModel,t,""),e&&e())},dispose:function(){this._presenter.removeEvent&&this._presenter.removeEvent(Constants.WixAppsGUIEvents.MODEL_REPLACED,this._onModelReplaced),this._varBindings.forEach(function(e){e.dispose()}),this._presenter.dispose(),this._viewHolder.dispose(),this._eventBinding.dispose(),this._varBindings.forEach(function(e){e.dispose()}),this._appPart=null,this._presenter=null,this._panelModel=null,this._eventBinding=null,this.parent()}})}),define.experiment.component("wixapps.integration.components.panels.BuilderDialogPanel.AppsBuilderPage.New",function(e,t){var i=e;i.methods({dispose:function(){this._presenter.removeEvent&&this._presenter.removeEvent(Constants.WixAppsGUIEvents.MODEL_REPLACED,this._onModelReplaced),this._presenter.dispose(),this._eventBinding.dispose(),this._varBindings.forEach(function(e){e.dispose()}),this._viewHolder.dispose(),this.parent()}})}),define.experiment.component("wixapps.integration.components.panels.ChooseTextStylePanel.SyncWixify.New",function(e,t){var i=e;i.methods({setEditedComponent:function(e,t){this.disposeFields(),this._appPart=e,this._editedComponent=t,this._currentlySelectedStyle=this._originalStyle;for(var i,n,a,o,s=this._editedComponent.getViewNode().getViewProxy(),r=[],l=-1,p=this._originalStyle.split(/\s/),d=p.filter(function(e){return 0===e.indexOf("font_")}).pick(),c=0;10>=c;c++){i="font_"+(c+""),n="FONT_"+(c+"")+"_LABEL",a=new this.imports.Font(i,W.Preview.getPreviewManagers().Theme);var h=W.Data.createDataItem({type:"Button",label:this.injects().Resources.get("EDITOR_LANGUAGE",n),commandParameter:i},"Button");if(r.push(h),i===d){l=c,o=a;var u=W.Preview.getPreviewManagers().Theme.getProperty(i);this._setFontColor(o,u.getColorReference(),u.getColor())}}this._overrideStyleCheckBox=this.addCheckBoxField("Override text styles:");var m=this;this._overridesGroup=this.addInputGroupField(function(){this.setNumberOfItemsPerLine(0,10),m._fontStyle=this.addFontStyleField(),m._colorPicker=this.addFontColorField();var e=m._setFontStyles(o,p),t=s.getViewDefinition().getChildValue("bold"),i=s.getViewDefinition().getChildValue("italic");m._colorPicker.setValue(o),m._fontStyle.setValue(o);var n=m.addSelectionListInputField("",r,null,{type:"wixapps.integration.components.editor.ChooseTextStyleButton",skin:"wixapps.integration.skins.editor.ChooseTextStyleButtonSkin",numRepeatersInLine:1});n.addEvent("inputChanged",m._itemClick),n.addEvent("editStyleClicked",m._editStyleClicked),m._overrideStyleCheckBox.addEvent("inputChanged",m._colorOverrideChange),m._colorPicker.addEvent("inputChanged",m._colorSelected),m._fontStyle.addEvent("inputChanged",m._fontStyleSelected),m._setFontStyle(o,t,i),n.selectItemAtIndexAndUpdate(l),m._overrideStyleCheckBox.setValue(e);var a=this;a&&e?a.uncollapse():a.collapse()})}})}),define.experiment.component("wixapps.integration.components.panels.EditFieldPanel.AppBuilderListSettings2.New",function(e,t){e.resources(t.merge(["W.Config","W.Resources","W.Commands","W.Data","W.Preview","W.Theme","W.EditorDialogs","W.AppsEditor2","W.AppsGUI"])),e.methods({setupPanel:function(e){this._presenter=e;var t=this,i=this.resources.W.Resources.get("EDITOR_LANGUAGE","HELPLET_LEARN_MORE");this.setNumberOfItemsPerLine(3,20),t._addLinkButton(this,i,t._onHelpClicked,"linkLeft"),this.setNumberOfItemsPerLine(1,0),this._isVertical="vertical"===e.getBoxOrientation();var n=this._presenter.getAppInstance().getDataItemFactory().createDataItem(this._presenter.createFieldSelectionModel()),a={setupPresenter:function(){},getModel:function(){return n},fieldSelected:function(i){e.selectEditedField(i.data.getValue().selectedValue),n.setValue(t._presenter.createFieldSelectionModel()),t._recreateFieldSettings(),t._setFieldHighlighting()},renameField:function(){var e=n.getChildValue("fieldDisplayName");t._presenter.setFieldDisplayName(e),n.setValue(t._presenter.createFieldSelectionModel())},cancelRenameField:function(){n.getChildByRef("mode").setValue("selectField")},editFieldName:function(){var t=n.getValue();t.fields.isSelectedMandatory||(t.fieldDisplayName=e.getFieldDisplayName(),t.mode="editFieldName",n.setValue(t))},deleteField:function(){var e=n.getValue();e.fields.isSelectedMandatory||t._onDeleteClicked()},checkForEnterKey:function(e){var t=e.cause||window.event;13==t.code&&(a.renameField(),t.stopPropagation())},stopKeyUpPropagation:function(e){var t=e.cause||window.event;t.stopPropagation()}};this.resources.W.AppsGUI.addViewToPanel(this._presenter.getAppInstance(),this,"EditFieldSelectorView",a),this._recreateFieldSettings(),this._setFieldHighlighting(),this._dialogWindow.setCloseCallBack(this._onDialogClosing),this._dialogWindow.getViewNode().addEvent("dialogClosed",this._onDialogClosing),this.resources.W.Commands.registerCommandListenerByName("WPreviewCommands.WEditModeChanged",this,this._onEditModeChanged)},_recreateFieldSettings:function(){this._settings&&(delete this.boxAlign,delete this._heightMode,delete this.size,delete this.spacers,this._settings.getViewNode().destroy(),this._settings.dispose());var e=this;this.addInputGroupField(function(){e._settings=this,e._addCustomizationControl(this,e._presenter.getFieldType(),e._presenter.getCompName())},"skinless")},_addGenericFieldCustomizations:function(e,t){var i=this;e.addInputGroupField(function(){switch(t){case"Image":i._addImageCustomization(this);break;case"Video":i._minWidth=200,i._minHeight=220,i._addVideoCustomization(this);break;case"Button2":i._minHeight=14,i._addButtonCustomization(this);break;default:i._addImageCustomization(this)}}),this._addGenericSizeAndSpacing(e)},_addGenericSizeAndSpacing:function(e){var t=this;e.addInputGroupField(function(){this.addLabel(t._loc("Size")),this.addBreakLine(7,"1px solid #E5E5E5",10),t.size=t.size||{},t.size.width=t._addSlider(this,t._loc("Width"),{key:"comp.width"},t._minWidth,1200,1),t.size.height=t._addSlider(this,t._loc("Height"),{key:"comp.height"},t._minHeight,1200,1),"auto"==t._heightMode&&t.size.height.disable(),t._addBoxAlign(this,t._loc("SizeAlignmentLabel"))}),t._addSpacing(e)},_addSpacing:function(e){var t=this;e.addInputGroupField(function(){t._addCollapsiblePanel(this,t._loc("SpacingLabel"),function(){t.spacers=t.spacers||{},t.spacers.top=t._addSlider(this,t._loc("Spacing_Top"),{key:t._isVertical?"comp.spacers.before":"comp.spacers.xax-before"},0,600,1),t.spacers.bottom=t._addSlider(this,t._loc("Spacing_Bottom"),{key:t._isVertical?"comp.spacers.after":"comp.spacers.xax-after"},0,600,1),t.spacers.left=t._addSlider(this,t._loc("Spacing_Left"),{key:t._isVertical?"comp.spacers.xax-before":"comp.spacers.before"},0,600,1),t.spacers.right=t._addSlider(this,t._loc("Spacing_Right"),{key:t._isVertical?"comp.spacers.xax-after":"comp.spacers.after"},0,600,1)})})},_addTextFieldCustomizations:function(e){var t=this;e.addInputGroupField(function(){t._addTextCustomizations(this)}),this._addTextFieldSizeAndSpacing(e)},_addTextFieldSizeAndSpacing:function(e){var t=this;e.addInputGroupField(function(){this.addBreakLine(7,"1px solid #E5E5E5",10),t._addBoxAlign(this,t._isVertical?t._loc("TextHorizontalAlignment"):t._loc("TextVerticalAlignment")),t._addTextFieldWidth(this),t._addTextFieldHeight(this)}),t._addSpacing(e)}})}),define.experiment.component("wixapps.integration.components.panels.ListSettingsPanel.AppBuilderListSettings2.New",function(e,t){e.resources(t.merge(["W.AppsGUI","W.Editor","W.EditorDialogs","W.Commands","W.AppsEditor2","W.Components","W.Preview","W.Utils"])),e.utilize(t.merge(["wixapps.core.utils.ListCursor","wixapps.integration.gui.CustomizationBinding","wixapps.core.views.ViewsCustomizer","wixapps.integration.gui.ManageItemsPresenter","wixapps.integration.gui.DataEditPresenter","wixapps.integration.gui.CustomizeItemsPresenter"])),e.traits(t.merge(["core.editor.components.traits.DataPanel"])),e.binds(t.merge(["_onEditOrganizeData","_onCustomizeItems","_listCursorChanged","_loadSharedData","_updateCustomizationPanel","_onOpenItem","_openAdvancedDesign","_onViewDefChange","_onSelectorDataChange","_onTypeChanged","createItem","removeItem","duplicateItem","toggleItemVisibility","editItem","backToSettings","_enablePanelControls","_onEnablePageLinks","_onEditPageTemplate","_openPageLinkFieldsDialog"])),e.methods({_initPageSettings:function(){this._viewBuilder=this.resources.W.AppsEditor2.getViewBuilder(),this._viewDef=this._appPart.getViewDefinition(),this._typesHelper=this.resources.W.AppsEditor2.getTypesHelper()},_initModels:function(){this._setupAction=Q.defer(),this._tabsReady=Q.defer(),this._manageItemsReady=Q.defer(),this._initData()},_createFields:function(){"error"!==this._appPart.getState()&&(this._createPanels(),this.resources.W.Utils.callLater(this._setupViews,null,this))},_createPanels:function(){var e=this,t=[],i=function(e){return[{title:"Items",name:"items",selected:"items"===e},{title:"Design",name:"design",selected:"design"===e},{title:"Options",name:"settings",selected:"settings"===e}]},n=e._appPart.getAppInstance().getDataItemFactory().createDataItem(i("items"));this._selectTab=function(a){n.setValue(i(a)),e.backToSettings(),e._selectRadioPanel(a,t),this._setPanelHeader(null,this._loc(a+(this._isList()?"":"SingleItem")+"TabDescription"))};var a={setupPresenter:function(){},getModel:function(){return n},tabSelected:function(t){var i=n.getValue(),a=i.map(function(e){return e.selected}).indexOf(!0),o=i[a].name,s=t.data.getValue().name;s!==o&&e._selectTab(s)}};this.resources.W.AppsGUI.addViewToPanel(e._appPart.getAppInstance(),this,"ListSettingsTabs",a),this.addBreakLine(10),this._loading=this.addLabel("Loading..."),this._settingsPanel=this.addInputGroupField(function(){e._addRadioPanel(this,"items",function(){e._itemsTab=this},!0,t),e._addRadioPanel(this,"design",function(){e._designTab=this},!1,t),e._addRadioPanel(this,"settings",function(){e._settingsTab=this},!1,t),e._tabsReady.resolve()},"skinless"),this.addInputGroupField(function(){e._advancedDesignPanel=this},"skinless"),this._advancedDesignPanel.collapse(),this.addInputGroupField(function(){e._dataEditPanel=this},"skinless"),this._dataEditPanel.collapse(),this._appPart.addEvent(Constants.WixAppEvents.APP_VIEW_READY,this._updateCustomizationPanel),e._showHelpIfNeeded()},isPageSelector:function(){return this._appPart.getDataSelector().isPageBased()},_setupViews:function(){var e=this;e._setupAction.promise.then(function(){this.resources.W.Utils.callLater(function(){e.resources.W.AppsGUI.addViewToPanel(e._appPart.getAppInstance(),e._itemsTab,"ManageItems2",e._manageItemPresenter),setTimeout(e._manageItemsReady.resolve,500)}),this.resources.W.Utils.callLater(function(){e._designTab.addInputGroupField(function(){e._custPanel=this,e._updateCustomizationPanel()}),e.resources.W.AppsGUI.addViewToPanel(e._appPart.getAppInstance(),e._designTab,"SimpleCustomizeFields",e._customizeItemsPresenter),e._designTab.addButtonField("","Advanced Design Mode",!1,void 0,"withArrow",0,"").runWhenReady(function(t){t.addEvent("click",e._openAdvancedDesign)});var t=e._appInstance.getAppPartDefinitions().filterByType(e._typeName);e.isPageSelector()||e._designTab.addButtonField("","Copy Other List-View's Design",!1,void 0,"blueWithArrow",0,"").runWhenReady(function(i){t.length>1?i.addEvent("click",function(){e.resources.W.AppsEditor2.openCopyViewDialog(e._appPart)}):i.disable()})}),e._loading.collapse()}.bind(this)),e._createPageLinksFrame(e._settingsTab),e._createNamingFrame(e._settingsTab)},_createPageLinksFrame:function(e){this.isPageSelector()||(e.addInputGroupField(function(e){this.addInputGroupField(function(){this.addSubLabel(e._loc("DeepLinkCheckbox"));var t=this.addCheckBoxImageField(e._loc("DeepLinkCheckbox_Btn_Title"),null,"icons/toggle_on_off_sprite.png",{w:48,h:23},"noHoverMultiLine");t.addEvent("inputChanged",e._onEnablePageLinks),t.runWhenReady(function(t){e._enableDeepLinkingChkBox=t}),t.getHtmlElement().setStyle("font-size","14px")},"skinless"),this.addBreakLine(10);var t=this.addButtonField("",e._loc("EditPageTemplate"),null,null,"blueWithArrow");t.addEvent("click",e._onEditPageTemplate),t.runWhenReady(function(t){e._editPageTemplateBtn=t},"blueWithArrow"),this.addBreakLine(5);var i=this.addButtonField("",e._loc("SetLinkToPage"),!1,void 0,"linkRight",0,"");i.addEvent("inputChanged",function(){e._openPageLinkFieldsDialog()}),i.runWhenReady(function(t){e._setLinkToPageLink=t}),i.getHtmlElement().setStyle("font-size","15px")}),this._enablePanelControls())},render:function(){var e=this._loc((this._isList()?"":"SingleItem")+"Title"),t=this._loc("items"+(this._isList()?"":"SingleItem")+"TabDescription");this._setPanelHeader(e,t),this.parent()},_setPanelHeader:function(e,t){var i=this.resources.W.Editor.getPropertyPanel();e&&i.setLabel(e),t&&i.setDescription(t)},_getButtonLabel:function(){return this._isList()?this._loc("EditData"):this._loc("EditItemData")},_isList:function(){return this._appPart.getDataSelector().isListSelector()},_currentIsAppPage:function(){var e=this.resources.W.Preview.getPreviewManagers().Viewer.getCurrentPageNode(),t=e.getLogic().getDataItem();return"AppPage"==t.getType()},_onEnablePageLinks:function(e){var t,i=e.value;if(this._toggleLinkButtons(i),i)this._openPageLinkFieldsDialog(["title"]);else{var n=this._viewDef.getValue(),a=this._viewBuilder.getPageLinkFields(n);for(t=0;a.length>t;t++){var o=a[t];delete o.comp.pageLink,this._viewDef.setValue(n)}}},_enablePanelControls:function(e){if(!this._enableDeepLinkingChkBox)return this.callLater(this._enablePanelControls,[],this),void 0;if(!e){var t=this._viewBuilder.getPageLinkFields(this._viewDef.getValue());e=t.length>0}this._enableDeepLinkingChkBox.setChecked(e),this._toggleLinkButtons(e)},_toggleLinkButtons:function(e){return this._enableDeepLinkingChkBox&&this._editPageTemplateBtn&&this._setLinkToPageLink?(void 0===e&&(e=this._enableDeepLinkingChkBox.getViewNode().checked),e?(this._editPageTemplateBtn.enable(),this._setLinkToPageLink.enable()):(this._editPageTemplateBtn.disable(),this._setLinkToPageLink.disable()),void 0):(this.callLater(this._toggleLinkButtons,[e],this),void 0)},_onEditPageTemplate:function(){var e=this._appPart.getAppPartDefinition().getType(),t=this._appPart.getAppInstance();this.resources.W.Commands.executeCommand("WAppsEditor2Commands.EditPageTemplate",{type:e,appInstance:t})},_openPageLinkFieldsDialog:function(e){this.resources.W.Commands.executeCommand("WAppsEditor2Commands.OpenPageLinkFieldsDialog",{appPart:this._previewComponent,suggestedFields:e,onComplete:this._enablePanelControls,moveToPage:!0})},_createWidgetNameHelpTooltip:function(){var e=this.resources.W.Data.getDataByQuery("#TOOLTIPS.toolTips"),t=this.resources.W.Utils.AppsUtils.getTimeBasedUniqueId("list_name_tooltip");return e.set(t,{isMoreLess:!1,isDontShowAgain:!1,content:"<p>"+this._loc("ListNameHelpTooltip")+"</p>",isPublished:!0,help:{isMoreHelp:!1,text:null,url:""}}),t},_createTypeNameHelpTooltip:function(){var e=this.resources.W.Data.getDataByQuery("#TOOLTIPS.toolTips"),t=this.resources.W.Utils.AppsUtils.getTimeBasedUniqueId("type_name_tooltip");return e.set(t,{isMoreLess:!1,isDontShowAgain:!1,content:"<p>"+this._loc("TypeNameHelpTooltip")+"</p>",isPublished:!0,help:{isMoreHelp:!1,text:null,url:""}}),t},_createNamingFrame:function(e){var t=this;
e.addInputGroupField(function(){t._createPartNameInput(this),t._createTypeNameInput(this)})},_createPartNameInput:function(e){function t(e){if(e=p.removeExtraSpaces(e),0===e.length)return o._loc("PartNameInvalidErrorMessage");var t=e.toLowerCase(),i=void 0!==_.find(d,function(e){return t==e.getDisplayName().toLowerCase()});return i?o._loc("PartNameExistsErrorMessage"):""}function i(){r.setDisplayName(h.getValue())}function n(e,t){h.setValue(p.removeExtraSpaces(h.getValue())),t(e)}function a(e){return e!=r.getDisplayName()}if(!this.isPageSelector())var o=this,s=this._appPart.getAppInstance(),r=this._appPart.getAppPartDefinition(),l=r.getType(),p=this.resources.W.Utils.AppsUtils,d=s.getAppPartDefinitions().filterByType(l),c=this._createWidgetNameHelpTooltip(),h=this.addSubmitInput(e,r.getDisplayName(),this._loc("PartName"),this._loc("SubmitPartName"),t,n,i,a,c)},_createTypeNameInput:function(e){function t(e){if(e=c.removeExtraSpaces(e),0===e.length)return o._loc("TypeNameInvalidErrorMessage");var t=d.isTypeDisplayNameExists(s,p,e);return t?o._loc("TypeNameExistsErrorMessage"):""}function i(){l.displayName=u.getValue(),o.resources.W.Commands.executeCommand("WAppsEditor2Commands.AppBuilderTypeNameChanged",{displayName:l.displayName,typeName:p,appInstance:s})}function n(e,t){u.setValue(c.removeExtraSpaces(u.getValue())),t(e)}function a(e){return e!=l.displayName}var o=this,s=this._appPart.getAppInstance(),r=this._appPart.getAppPartDefinition(),l=r.getTypeDef(),p=s.getTypesManager().getTypeName(l),d=this.resources.W.AppsEditor2,c=this.resources.W.Utils.AppsUtils,h=this._createTypeNameHelpTooltip(),u=this.addSubmitInput(e,l.displayName,this._loc("TypeName"),this._loc("SubmitTypeName"),t,n,i,a,h)},_addRadioPanel:function(e,t,i,n,a){n=void 0!==n?n:!1;var o=e.addInputGroupField(i,"skinless"),s=function(e){e?o.runWhenReady(function(e){e.uncollapseGroup()}.bind(this)):o.runWhenReady(function(e){e.collapseGroup()}.bind(this))};return a&&a.push({name:t,setIsOpen:s}),s(n),o},_selectRadioPanel:function(e,t){for(var i=0;t.length>i;i++)t[i].setIsOpen(t[i].name===e)},_onOpenItem:function(e){e&&e.reloadBeforeOpen===!0?this._loadSharedData(function(){this._openDataItemEditing()}.bind(this)):this._openDataItemEditing()},backToSettings:function(){this._settingsPanel.uncollapse(),this._advancedDesignPanel.collapse(),this._dataEditPanel.collapse()},_openAdvancedDesign:function(){this._settingsPanel.collapse(),this._advancedDesignPanel.uncollapse(),this._dataEditPanel.collapse(),this._advancedDesignAdded||(this._advancedDesignAdded=!0,this.resources.W.AppsGUI.addViewToPanel(this._appPart.getAppInstance(),this._advancedDesignPanel,"CustomizeItems2",this._customizeItemsPresenter))},_openDataItemEditing:function(){this._tabsReady.promise.then(function(){this._selectTab("items"),this._settingsPanel.collapse(),this._advancedDesignPanel.collapse(),this._dataEditPanel.uncollapse(),this._dataPanelAdded||(this._dataPanelAdded=!0,this.resources.W.AppsGUI.addViewToPanel(this._appPart.getAppInstance(),this._dataEditPanel,"DataEdit2",this._dataEditPresenter))}.bind(this))},_initData:function(){var e=this._appPart.getAppInstance().getTypesManager();this._typeName=this._appPart.getAppPartDefinition().getType(),this._typeDef=e.getType(this._typeName),this._appInstance=this._appPart.getAppInstance(),this._usedDataSelector=this._appPart.getDataSelector(),this._viewDataItem=this._appPart.getViewDefinition();var t=this._appInstance.getDataItemFactory();this._itemsData=t.createVirtualArray(),this._loadSharedData(function(){this._initCursor(),this._initPresenters(),this._addListeners()}.bind(this))},_initPresenters:function(){this._manageItemPresenter=new this.imports.ManageItemsPresenter(this._appPart,this._usedDataSelector,this._itemsData,this._typeDef,this._listCursor,this),this._customizeItemsPresenter=new this.imports.CustomizeItemsPresenter(this._appInstance,this._usedDataSelector,this._typeDef,this._appPart,this._updateModel,this),this._dataEditPresenter=new this.imports.DataEditPresenter(this._appPart,this._listCursor,this._usedDataSelector,this._itemsData,function(){return!1},function(){},this),this._setupAction.resolve()},_loadSharedData:function(e){var t,i=this._usedDataSelector.getSelectionType(),n=this._usedDataSelector.getDataProvider();this._usedDataSelector.isListSelector()?(t=this._usedDataSelector.getItemIds(),n.readItems(i,t,function(t){this._itemsData.setChildren(t),e&&e(this._itemsData)}.bind(this))):(this._usedDataSelector=this.resources.W.AppsEditor2.getAllItemsOfTypeDataSelector(i,this._appInstance),t=this._usedDataSelector.getItemsIdsLocally(),n.readItems(i,t,function(t){this._itemsData.setChildren(t),e&&e(this._itemsData)}.bind(this)))},_initCursor:function(){this._selectionHandler=this.resources.W.AppsEditor2.getSelectionHandler();var e=this._selectionHandler.getCurrentDataItem(),t=-1;if(e){var i=e.getChildValue("_iid");t=this._usedDataSelector.getItemIdRealIndex(i)}this._listCursor=new this.imports.ListCursor(this._itemsData,t),this._listCursor.addEvent(Constants.WixAppEvents.SELECTED_INDEX_CHANGED,this._listCursorChanged)},_listCursorChanged:function(e){var t=e.index;e.oldIndex,this._manageItemPresenter.rebuildModel(),this._dataEditPresenter.rebuildModel();var i=this._itemsData.getChildByIndex(t);if(i){var n=i.getChildValue("_iid");t=this._usedDataSelector.getItemIdIndex(n),0>t?this._selectionHandler.removeSelection():this._selectionHandler.setSelectedIndex(t,!0),this._handleNonListSelectors(n)}},_handleNonListSelectors:function(e){var t=this._appPart.getDataSelector();if(t.isListSelector()===!1){var i=t.getLogicalTypeName();switch(i){case"IB.PageSelectedItem":var n=this.resources.W.Preview.getPreviewManagers().Viewer.getCurrentPageNode(),a=n.getLogic();a.updateParams({type:this._typeName,itemId:e});break;case"IB.ManualSelectedItem":t.setItemId(e)}}},_onViewDefChange:function(e){this._customizeItemsPresenter.onViewChanged(e)},_onTypeChanged:function(e){this._dataEditPresenter.onTypeChanged(e),this._customizeItemsPresenter.onTypeChanged(e),this._manageItemPresenter.onTypeChanged(e)},_componentSelectionChanged:function(e){if(e.appPart.getDataSelector().isListSelector()!==!1){var t=e.dataItem,i=t.getChildValue("_iid"),n=this._usedDataSelector.getItemIdRealIndex(i);this._listCursor.setSelectedIndex(n)}},_onSelectorDataChange:function(){this._loadSharedData(function(){this._manageItemPresenter.rebuildModel(),this._dataEditPresenter.rebuildModel(!0)}.bind(this))},_addListeners:function(){this._usedDataSelector.addEvent(Constants.DataEvents.DATA_CHANGED,this._onSelectorDataChange),this._appInstance.addEvent(Constants.WixAppEvents.TYPE_CHANGE,this._onTypeChanged),this._viewDataItem.addEvent(Constants.DataItemEvents.CHANGE,this._onViewDefChange),this.resources.W.Commands.registerCommandListenerByName("WAppsEditor2Commands.SelectionChanged",this,this._componentSelectionChanged),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.OpenDesignPanel",this,this.designList,null,!1),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.OpenEditItemPanel",this,this._onOpenItem,null,!1),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.ShowSelectItemsHelp",this,this._showSelectItemsHelp,null,!1)},_removeListeners:function(){this._usedDataSelector.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onSelectorDataChange),this._appInstance.removeEvent(Constants.WixAppEvents.TYPE_CHANGE,this._onTypeChanged),this._viewDataItem.removeEvent(Constants.DataItemEvents.CHANGE,this._onViewDefChange),this.resources.W.Commands.unregisterCommand("WAppsEditor2Commands.ShowSelectItemsHelp"),this.resources.W.Commands.unregisterCommand("WAppsEditor2Commands.OpenEditItemPanel"),this.resources.W.Commands.unregisterCommand("WAppsEditor2Commands.OpenDesignPanel"),this.resources.W.Commands.unregisterListener(this)},_disposePresenters:function(){this._manageItemPresenter.dispose(),this._customizeItemsPresenter.dispose(),this._dataEditPresenter.dispose()},createItem:function(){W.Commands.executeCommand("WAppsEditor2Commands.AddNewDataItem",{appPart:this._appPart,onDataItemAdded:function(){this._listCursor.first(),this._loadSharedData()}.bind(this)})},removeItem:function(){var e=this._listCursor.getCurrentItemIndex();this._listCursor.removeSelection();var t=this._itemsData.getChildByIndex(e);if(t){var i=t.getChildValue("_iid");this.resources.W.Commands.executeCommand("WAppsEditor2Commands.RemoveDataItem",{appPart:this._appPart,dataItemId:i,onDataItemRemoved:function(){this._loadSharedData()}.bind(this)})}},duplicateItem:function(){var e=this._listCursor.getCurrentItemIndex(),t=this._itemsData.getChildByIndex(e),i=t.getValue();delete i._createdAt,delete i._updatedAt,i._iid=this.resources.W.Utils.AppsUtils.getTimeBasedUniqueId(),this.resources.W.Commands.executeCommand("WAppsEditor2Commands.AddNewDataItem",{appPart:this._appPart,rawData:i,onDataItemAdded:function(){this._listCursor.first(),this._loadSharedData()}.bind(this)})},toggleItemVisibility:function(){var e=this._listCursor.getCurrentItemIndex();if(e>=0){var t=this._usedDataSelector.getItemIds()[e];if(t){var i=this._usedDataSelector.isHidden(t);this._usedDataSelector.setVisibility(t,i),W.UndoRedoManager.startTransaction(),this.resources.W.Commands.executeCommand("WAppsEditor2Commands.Undo.DataSelectorChange",{changeType:"Hide",selector:this._usedDataSelector,dataItemId:t,newValue:i,oldValue:!i,appPart:this._appPart}),W.UndoRedoManager.endTransaction()}}},editItem:function(){this._openDataItemEditing()},designList:function(){this._tabsReady.promise.then(function(){this._selectTab("design")}.bind(this))},selectItems:function(){W.Commands.executeCommand("WAppsEditor2Commands.DataItemSelectionRequested",{dataSelector:this._appPart.getDataSelector(),type:this._typeName,appInstance:this._appInstance,okCallback:this._onSelectorDataChange})},_showSelectItemsHelp:function(){this._manageItemsReady.promise.then(function(){this.resources.W.Commands.executeCommand("WAppsEditor2Commands.OpenHelpBubble",{appPart:this._appPart,ftHelpSetName:"FT_AFTER_COPY_LIST",anchorElement:this._view.getElement("[vcfield='selectItemContainer']")})}.bind(this))},_showHelpIfNeeded:function(){this.isPageSelector()&&this.resources.W.Commands.executeCommand("WAppsEditor2Commands.OpenHelpBubble",{appPart:this._appPart,ftHelpSetName:"FT_HELP_AFTER_ENABLE_PAGE",anchorElement:this.resources.W.Editor.getPropertyPanel().getSkinPart("help")})},addSubmitInput:function(e,t,i,n,a,o,s,r,l){var p=e._addField("wysiwyg.editor.components.inputs.SubmitInput","wixapps.integration.skins.inputs.SubmitInputMessageAboveButtonSkin",{labelText:i,placeholderText:"",minLength:void 0,maxLength:void 0,validatorArgs:{validators:[a],validationOkCallback:function(){s(p.getValue()),c(r(p.getValue()))}},buttonLabel:n,iconSrc:void 0,preSubmitFunction:o,toolTip:{toolTipId:l,addQuestionMark:!0}}),d=null,c=function(e){e?(d.enable(),d.getViewNode().setStyle("cursor","pointer")):(d.disable(),d.getViewNode().setStyle("cursor","default"))};return p.runWhenReady(function(e){d=e.getSkinPart("button"),e.setValue(t);var i=e.getSkinPart("input");i.addEvent(Constants.CoreEvents.KEY_UP,function(t){t&&13!=t.code&&e._resetInvalidState(),c(r(e.getValue()))}),i.removeEvent("blur",e._revertToLastValidInputIfCurrentInvalid),c(r(t))}),p},dispose:function(){this._removeListeners(),this._disposePresenters(),this._appPart.removeEvent(Constants.WixAppEvents.APP_VIEW_READY,this._updateCustomizationPanel),this._bindings.forEach(function(e){e.dispose()})}})}),define.experiment.component("wixapps.integration.components.panels.ListSettingsPanel.AppBuilderPage.New",function(e,t){var i=e,n=t;i.binds(n.merge(["_onEditOrganizeData","_onCustomizeItems","_updateCustomizationPanel","_validateListName","_submitListName","_enablePanelControls","_onEnablePageLinks","_onEditPageTemplate","_openPageLinkFieldsDialog","_preSubmitListName"])),i.resources(n.merge(["W.Commands","W.AppsEditor2","W.Preview","W.Utils"])),i.methods({_initPageSettings:function(){this._viewBuilder=this.resources.W.AppsEditor2.getViewBuilder(),this._viewDef=this._appPart.getViewDefinition(),this._typesHelper=this.resources.W.AppsEditor2.getTypesHelper()},_createPageLinksFrame:function(e){this._appPart.getDataSelector().isPageBased()||(e.addInputGroupField(function(e){this.addInputGroupField(function(){this.addSubLabel(e._loc("DeepLinkCheckbox"));var t=this.addCheckBoxImageField(e._loc("DeepLinkCheckbox_Btn_Title"),null,"icons/toggle_on_off_sprite.png",{w:48,h:23},"noHoverMultiLine");t.addEvent("inputChanged",e._onEnablePageLinks),t.runWhenReady(function(t){e._enableDeepLinkingChkBox=t}),t.getHtmlElement().setStyle("font-size","14px")},"skinless"),this.addBreakLine(10);var t=this.addButtonField("",e._loc("EditPageTemplate"),null,null,"blueWithArrow");t.addEvent("click",e._onEditPageTemplate),t.runWhenReady(function(t){e._editPageTemplateBtn=t},"blueWithArrow"),this.addBreakLine(5);var i=this.addButtonField("",e._loc("SetLinkToPage"),!1,void 0,"linkRight",0,"");i.addEvent("inputChanged",function(){e._openPageLinkFieldsDialog()}),i.runWhenReady(function(t){e._setLinkToPageLink=t}),i.getHtmlElement().setStyle("font-size","15px")}),this._enablePanelControls())},render:function(){if(!this._isList()){var e=W.Editor.getPropertyPanel();e.setLabel(this._loc("ItemSettings")),e.setDescription(this._loc("ItemSettingsDescription"))}this.parent()},_getButtonLabel:function(){return this._isList()?this._loc("EditData"):this._loc("EditItemData")},_isList:function(){return this._appPart.getDataSelector().isListSelector()},_currentIsAppPage:function(){var e=this.resources.W.Preview.getPreviewManagers().Viewer.getCurrentPageNode(),t=e.getLogic().getDataItem();return"AppPage"==t.getType()},_onEnablePageLinks:function(e){var t,i=e.value;if(this._toggleLinkButtons(i),i)this._openPageLinkFieldsDialog(["title"]);else{var n=this._viewDef.getValue(),a=this._viewBuilder.getPageLinkFields(n);for(t=0;a.length>t;t++){var o=a[t];delete o.comp.pageLink,this._viewDef.setValue(n)}}},_enablePanelControls:function(e){if(!this._enableDeepLinkingChkBox)return this.callLater(this._enablePanelControls,[],this),void 0;if(!e){var t=this._viewBuilder.getPageLinkFields(this._viewDef.getValue());e=t.length>0}this._enableDeepLinkingChkBox.setChecked(e),this._toggleLinkButtons(e)},_toggleLinkButtons:function(e){return this._enableDeepLinkingChkBox&&this._editPageTemplateBtn&&this._setLinkToPageLink?(void 0===e&&(e=this._enableDeepLinkingChkBox.getViewNode().checked),e?(this._editPageTemplateBtn.enable(),this._setLinkToPageLink.enable()):(this._editPageTemplateBtn.disable(),this._setLinkToPageLink.disable()),void 0):(this.callLater(this._toggleLinkButtons,[e],this),void 0)},_onEditPageTemplate:function(){var e=this._appPart.getAppPartDefinition().getType(),t=this._appPart.getAppInstance();this.resources.W.Commands.executeCommand("WAppsEditor2Commands.EditPageTemplate",{type:e,appInstance:t})},_openPageLinkFieldsDialog:function(e){this.resources.W.Commands.executeCommand("WAppsEditor2Commands.OpenPageLinkFieldsDialog",{appPart:this._previewComponent,suggestedFields:e,onComplete:this._enablePanelControls,pos:this.resources.W.Utils.getPositionRelativeToWindow(this._enableDeepLinkingChkBox.getViewNode())})},_createListNameHelpTooltip:function(){var e=this.resources.W.Data.getDataByQuery("#TOOLTIPS.toolTips"),t=this.resources.W.Utils.AppsUtils.getTimeBasedUniqueId("list_name_tooltip");return e.set(t,{isMoreLess:!1,isDontShowAgain:!1,content:"<p>"+this._loc("ListNameHelpTooltip")+"</p>",isPublished:!0,help:{isMoreHelp:!1,text:null,url:""}}),t},_trimListNameValue:function(e){return e.replace(/(?:(?:^|\n)\s+|\s+(?:$|\n))/g,"").replace(/\s+/g," ")},_validateListName:function(e){var t=this._appPart.getAppInstance(),i=t.getAppPartDefinitions(),n=i.toObject(),a=this._appPart.getAppPartDefinition();if(e=this._trimListNameValue(e),0===e.length)return this._loc("ListNameExistsErrorMessage");if(e.test(/[^A-Za-z0-9 ]/g))return this._loc("ListNameExistsErrorMessage");var o=!1;for(var s in n)if(n.hasOwnProperty(s)&&s!==a.getId()&&n[s].displayName===e){o=!0;break}return o?this._loc("ListNameExistsErrorMessage"):""},_submitListName:function(){var e=this._listNameInput.getValue(),t=this._appPart.getAppPartDefinition();t.setDisplayName(e),this._updateListNameInputState()},_preSubmitListName:function(e,t){var i=this._listNameInput.getValue();i=this._trimListNameValue(i),this._listNameInput.setValue(i),t(e)},_addListNameInput:function(e,t){return e._addField("wysiwyg.editor.components.inputs.SubmitInput","wixapps.integration.skins.inputs.SubmitInputMessageAboveButtonSkin",{labelText:this._loc("ListName"),placeholderText:"",minLength:void 0,maxLength:void 0,validatorArgs:{validators:[this._validateListName],validationOkCallback:this._submitListName},buttonLabel:this._loc("SubmitListName"),iconSrc:void 0,preSubmitFunction:this._preSubmitListName,toolTip:{toolTipId:t,addQuestionMark:!0}})},_updateListNameInputState:function(){var e=this._listNameInput.getSkinPart("button"),t=this._listNameInput.getValue(),i=this._appPart.getAppPartDefinition().getDisplayName();t===i?(e.disable(),e.getViewNode().setStyle("cursor","default")):(e.enable(),e.getViewNode().setStyle("cursor","pointer"))},_createListNameFrame:function(e){if(!this._appPart.getDataSelector().isPageBased()){var t=this,i=this._createListNameHelpTooltip();e.addInputGroupField(function(e){var n=t._addListNameInput(this,i);n.setValue(t._appPart.getAppPartDefinition().getDisplayName()),n.runWhenReady(function(e){t._listNameInput=e,t._updateListNameInputState();var i=t._listNameInput.getSkinPart("input");i.addEvent(Constants.CoreEvents.KEY_UP,function(){t._updateListNameInputState()})}),e._createCollectionSettingsFields(this)})}},_createCollectionSettingsFields:function(e){e.addButtonField("",this._loc("CollectionSettings"),null,null,"linkLeft","60px",void 0,"WAppsEditor2Commands.OpenCollectionSettings",{appPart:this._previewComponent,appInstance:this._appPart.getAppInstance(),typeName:this._appPart.getAppPartDefinition().getType()}).getHtmlElement().setStyle("font-size","15px")}})}),define.experiment.component("wixapps.integration.components.panels.ProxyStylePanel.StylePerComponent.New",function(e,t){var i=e,n=t;i.methods({setEditedComponent:n.remove(),_createFields:function(){this._originalStyle=this._editedComponent.getStyle().getId(),this._currentlySelectedStyle=this._originalStyle,this._buildStyleButtons()}})}),define.experiment.Class("wixapps.integration.components.traits.FppMetaDataBuilderTrait2.AppBuilderListSettings2.New",function(e){e.methods({_getListTitle:function(e){var t=e.getAppPartDefinition();return t.getDisplayName()},_createMetaData:function(e){return{general:{settings:!1,design:!1,title:e},dblClick:{command:"WAppsEditor2Commands.OpenEditItem",commandParameter:{}},custom:[]}},_createPageTemplateLink:function(e,t,i){var n=W.AppsEditor2.getViewBuilder(),a=i.getViewDefinition(),o=n.getPageLinkFields(a.getValue()),s=o.length>0;if(s){var r=i.getAppPartDefinition().getType(),l=i.getAppInstance();this._addCustomItem(e,t,"WAppsEditor2Commands.EditPageTemplate",{type:r,appInstance:l})}else this._addCustomItem(e,t,"WAppsEditor2Commands.OpenPageLinkFieldsDialog",{appPart:i,suggestedFields:["title"],onComplete:function(){},moveToPage:!0})},_createEditItemLink:function(e,t){this._addCustomItem(e,t,"WAppsEditor2Commands.OpenEditItem")},_createDesignFieldsLink:function(e,t){this._addCustomItem(e,t,"WAppsEditor2Commands.OpenDesignList")},_createAddItemLink:function(e,t,i){this._addCustomItem(e,"FPP_ADD_NEW_ITEM_LABEL","WAppsEditor2Commands.AddNewDataItem",{appPart:i,onDataItemAdded:function(){W.Commands.executeCommand("WAppsEditor2Commands.OpenEditItem",{reloadBeforeOpen:!0})}})}})}),define.experiment.Class("wixapps.integration.components.traits.FppMetaDataBuilderTrait2.AppBuilderPage.New",function(e,t){var i=e;i.methods({_getListTitle:function(e){var t=e.getAppPartDefinition();return t.getDisplayName()},_createPageTemplateLink:function(e,t,i){var n=W.AppsEditor2.getViewBuilder(),a=i.getViewDefinition(),o=n.getPageLinkFields(a.getValue()),s=o.length>0;if(s){var r=i.getAppPartDefinition().getType(),l=i.getAppInstance();this._addCustomItem(e,t,"WAppsEditor2Commands.EditPageTemplate",{type:r,appInstance:l})}else this._addCustomItem(e,t,"WAppsEditor2Commands.OpenPageLinkFieldsDialog",{appPart:i,suggestedFields:["title"],onComplete:function(){},pos:function(){return W.Editor.getFloatingPanel().getPosition()},moveToPage:!0})}})}),define.experiment.Class("wixapps.integration.components.traits.ResizableProxyTrait.AutoResizeEvent.New",function(e){var t=e;t.statics({COMPONENT_AUTO_RESIZE_EVENT:"autoSized"}),t.methods({_handleSizeChange:function(){if(!this.isDisposed()){if(this._isCompBasedWidth()){var e=this._getComponentWidth();this._element.setStyle("width",e),this._innerElement.setStyle("width",e)}if(this._isCompBasedHeight()){var t=this._getComponentHeight();this._element.setStyle("height",t),this._innerElement.setStyle("height",t)}this.fireEvent(Constants.WixAppEvents.APP_CONTENT_RESIZE,{})}}})}),define.experiment.Class("wixapps.integration.gui.BubblePresenter.AppBuilderListSettings2.New",function(e){e.methods({initialize:function(e,t,i){this._helpLinks=t.helpLinks||[],this._title=t.title,this._description=t.description,this._iconSrc=t.iconSrc,this._hasDontShowAgainCheckbox=t.hasDontShowAgainCheckbox===!0,this._dontShowAgainKey=i,this.parent(e),this.markAsSeen()},createModel:function(){this._model=this._dataItemFactory.createDataItem({title:this._title,description:this._description,iconData:{_type:"wix:Image",src:this._iconSrc,width:65,height:55},links:this._helpLinks,hasDontShowAgainCheckbox:this._hasDontShowAgainCheckbox,dontShowAgain:!1}),this._model.addEvent(Constants.DataItemEvents.CHANGE,this._onModelChanged)},markAsSeen:function(){if(!this._hasDontShowAgainCheckbox||this._model.getValue().dontShowAgain){var e=this.resources.W.Editor.getEditorPreferences(),t=e.get("dontShowAgainDialogs");t.include(this._dontShowAgainKey),e.fireDataChangeEvent()}},onBeforeDialogClose:function(){this.markAsSeen()}})}),define.experiment.Class("wixapps.integration.gui.ChooseTemplatePresenter.AppBuilderListSettings2.New",function(e,t){e.resources(t.merge(["W.Commands"])),e.methods({setupPresenter:function(e){var t=this._appInstance.getDataItemFactory();this._builderDialogPanel=e,this._model=t.createDataItem([]),this._rebuildModel()},_rebuildModel:function(){var e=this._templateBundles.map(function(e){var t="images/templates/"+e.id.toLowerCase()+".jpg";return{imageData:{_type:"wix:Image",src:t,width:275,height:206},title:this._getLocalizedTitle(e),description:this._getLocalizedDescription(e),id:e.id}}.bind(this));this._model.setValue(this._getModelRaw(e))},_getModelRaw:function(e){return e||this._model.getChildValue("templates")},propogateEvent:function(e){var t=e.sender.getElement();if(t){var i=t.getElement("[vcfield='collectionArrow']"),n=e.cause.type;"mouseover"===n&&(n="mouseenter"),"mouseout"===n&&(n="mouseleave"),i.fireEvent(n)}},getModel:function(){return this._model}})}),define.experiment.Class("wixapps.integration.gui.ChooseTemplatePresenter.AppBuilderPage.New",function(e){e.resources(["W.Commands"]),e.statics({Tabs:{EXISTING:"existing",NEW:"new"}}),e.methods({setupPresenter:function(e){var t=this._appInstance.getDataItemFactory();this._builderDialogPanel=e,this._model=t.createDataItem({}),this._getTemplateData();var i=this._appInstance.getAppPartDefinitions();i.getIds().length>0&&this._moveToTab(this.Tabs.EXISTING)},_getTemplateData:function(){var e=this._templateBundles.map(function(e){var t="images/templates/"+e.id.toLowerCase()+".jpg";return{imageData:{_type:"wix:Image",src:t,width:275,height:206},title:this._getLocalizedTitle(e),description:this._getLocalizedDescription(e),id:e.id}}.bind(this));this._model.setValue(this._getModelRaw(this.Tabs.NEW,e))},_getModelRaw:function(e,t){return{tabs:this._getTabsRawData(e),templates:t||this._model.getChildValue("templates"),selected:e,existingCollections:this._getExistingCollections()}},_getTabsRawData:function(e){return[{title:this._localizer.localize("CHOOSE_TEMPLATE_Tabs_NewList"),name:this.Tabs.NEW,selected:e===this.Tabs.NEW},{title:this._localizer.localize("CHOOSE_TEMPLATE_Tabs_ExistingList"),name:this.Tabs.EXISTING,selected:e===this.Tabs.EXISTING}]},_getExistingCollections:function(){var e=this._appInstance.getDataProviders().getWixDbDataProvider(),t=e.getManagedTypes();return t},tabSelected:function(e){this._moveToTab(e.data.getValue().name)},_moveToTab:function(e){var t=this._model.getValue(),i=t.tabs,n=i.map(function(e){return e.selected}).indexOf(!0),a=i[n].name;e!==a&&this._model.setValue(this._getModelRaw(e))},onCollectionClick:function(e){this._builderDialogPanel.closeDialog();var t=e.data.getChildValue("name");this.resources.W.Commands.executeCommand("WAppsEditor2Commands.OpenCollectionSettings",{appInstance:this._appInstance,typeName:t})},_getMouseOverStyles:function(){return{"border-color":"#29a7eb"}},_getMouseOutStyles:function(){return{"border-color":"#e1e1e1"}},propogateEvent:function(e){var t=e.sender.getElement();if(t){var i=t.getElement("[vcfield='collectionArrow']"),n=e.cause.type;"mouseover"===n&&(n="mouseenter"),"mouseout"===n&&(n="mouseleave"),i.fireEvent(n)}}})}),define.experiment.newClass("wixapps.integration.gui.CopyViewPresenter.AppBuilderListSettings2.New",function(e){e.inherits("wixapps.integration.gui.BasePresenter"),e.utilize(["wixapps.core.views.ViewsCustomizer"]),e.resources(["W.Editor","W.Resources"]),e.methods({initialize:function(e){this.parent(e),this._partDef=this._appPart.getAppPartDefinition(),this._originalViewName=this._partDef.getViewName(),this._originalViews=this.getPartViews(this._partDef),this._typeName=this._partDef.getType(),this._displayName=this._partDef.getTypeDef().displayName,this._typeParts=this._appInstance.getAppPartDefinitions().filterByType(this._typeName),this.rebuildModel()},createModel:function(){this._model=this._dataItemFactory.createDataItem({})},rebuildModel:function(){this._model.setValue(this._createRawModel())},getAllViewsByName:function(e){return _.filter(this._appInstance.getViewDefinitions().toArray(),function(t){return t.name==e})},_createRawModel:function(){var e=function(e){return"IB.PageSelectedItem"==e.getDataSelector().getLogicalTypeName()?this._displayName+" Item Page":e.getDisplayName()}.bind(this);return{typeDisplayName:this._displayName,parts:_.map(this._typeParts,function(t,i){return{displayName:e(t),index:i,selected:!1,original:t===this._partDef}},this)}},getPartViews:function(e){return this.getAllViewsByName(e.getViewName())},onBeforeDialogClose:function(e){e.result==W.EditorDialogs.DialogButtons.CANCEL&&this.resetView()},resetView:function(){this._applyViews(this._originalViews)},selectView:function(e){var t=e.data.getChildValue("index"),i=this._model.getValue();_.forEach(i.parts,function(e,i){e.selected=t===i}),this._model.setValue(i),this._showView(e)},_showView:function(e){var t=e.data.getChildValue("original");if(t)this._applyViews(this._originalViews);else{var i=e.data.getChildValue("index");this._showPartViews(this._typeParts[i])}},_showPartViews:function(e){this._applyViews(this.getPartViews(e))},_applyViews:function(e){var t=this._appInstance.getViewDefinitions();_.forEach(e,function(e){e.name=this._originalViewName,"Array"==e.forType&&this.imports.ViewsCustomizer.applyRule(e,{fieldId:"listItem",key:"comp.name",mode:"view",value:e.name}),t.setViewDefinition(e)},this)}})}),define.experiment.Class("wixapps.integration.gui.CustomizeItemsPresenter.AppBuilderListSettings2.New",function(e){e.methods({initialize:function(e,t,i,n,a,o){this._appInstance=e,this._typeDef=i,this._viewBuilder=this.resources.W.AppsEditor2.getViewBuilder(),this._typesHelper=this.resources.W.AppsEditor2.getTypesHelper(),this._dataItemFactory=e.getDataItemFactory(),this._viewDataItem=n.getViewDefinition(),this._parentUpdateModel=a,this._fieldHighlighter=this.resources.W.AppsEditor2.getFieldHighlighter(),this._dataItemUtils=new this.imports.DataItemUtils,this._settingsPanel=o,this._metaData=this._dataItemFactory.createDataItem({}),this._updateMetadata(),this.parent(n)},exportVars:function(){return{metaData:this._metaData}},_isMobile:function(){return!1},_updateMetadata:function(){var e=this._isMobile(),t={allowAddField:!e};this._metaData.setValue(t)},onViewChanged:function(e){if(e.phase==Constants.DataItemEventPhase.ON_TARGET&&!this._ignoreChanges){var t=this._dataItemUtils.createDataChangeEventList(e,this._data),i=t.some(function(e){return"add"==e.type||"delete"==e.type});i&&(this._model.setValue([]),this._createDataStructure())}},_createDataStructure:function(){if(!this._ignoreChanges){var e=[],t=this._viewDataItem.getValue(),i=this._viewBuilder.getViewFieldsMapping(t),n=this._addShownContainersAndFields(i,e);this._addHiddenContainer(e),this._addHiddenFields(n,e),this._model.setValue(e)}},backToSettings:function(){this._settingsPanel.backToSettings()},_addShownContainersAndFields:function(e,t){for(var i,n,a,o={},s=this._appInstance.getTypesManager(),r=0;e.length>r;r++)if(i=e[r],t.push({isContainer:!0,displayName:i.containerName,containerId:i.containerId,dragEnabled:!1,hasFields:i.hasFields,iconType:"none",fieldIcon:"none",showEditLabel:!1,orientation:i.orientation,hideEditLink:!1}),i.hasFields&&(n=i.containerFields,n.length>0))for(var l=0;n.length>l;l++){a=n[l];var p={isContainer:!1,containerId:a.containerId,hasFields:!1,displayName:this._getFieldDisplayName(a.data),iconType:"arrow",dragEnabled:!0,fieldIcon:this._getFieldIconClass(a),showEditLabel:!1,hideEditLink:!1,boxOrientation:i.orientation,isMandatory:this._typesHelper.isMandatoryField(s.getField(this._typeDef,a.data))};o[a.data]=!0,t.push(Object.merge(p,a))}return o},onItemMoved:function(e){var t=e.cause.oldIndex,i=e.cause.newIndex;if(t!==i){this._ignoreChanges=!0;var n=e.data.getValue(),a=n.slice(0);a.splice(t,0,a.splice(i,1)[0]);var o=n[i],s=o.id,r=o.displayName,l=o.data,p=o.type,d="Hidden"===o.containerId,c=this._viewDataItem.getValue(),h=Object.clone(c),u=this._getContainerByIndex(i,n),m=this._getContainerByIndex(t,a);if(!m||!u)return this._createDataStructure(),void 0;var g=m.data.containerId,_=u.data.containerId;t-=m.indexInList+1,i-=u.indexInList+1,"Hidden"==_?this.resources.W.Commands.executeCommand("WAppsEditor2Commands.HideField",{appPart:this._appPart,fieldId:s}):d?this.resources.W.Commands.executeCommand("WAppsEditor2Commands.AddExtraField",{appPartLogic:this._appPart,typeFieldId:l,fieldTemplateKey:this._viewBuilder.getDefaultTemplateKey(p),fieldDisplayName:r,extraFieldContainerId:_}):(_===g?this._viewBuilder.reorderExtraFields(c,g,t,i):this._viewBuilder.moveField(c,s,_,i),this._viewDataItem.setValue(c),W.UndoRedoManager.startTransaction(),W.Commands.executeCommand("WAppsEditor2Commands.Undo.ViewDefinitionChange",{viewRepo:this._appInstance.getViewDefinitions(),oldValue:h,newValue:c,appPart:this._appPart}),W.UndoRedoManager.endTransaction()),this._ignoreChanges=!1,this._createDataStructure()}},_getContainerById:function(e,t){for(var i=0;t.length>i;i++){var n=t[i];if(n.isContainer&&n.containerId==e)return{data:t[i],indexInList:i}}},onFieldClicked:function(e){var t=e.data.getValue();"Hidden"!==t.containerId&&this.resources.W.AppsEditor2.openEditFieldDialog(t.id,this._model.getValue(),this._appPart,this._updateModel)},_updateModel:function(){this._createDataStructure()}})}),define.experiment.Class("wixapps.integration.gui.DataEditPresenter.AppBuilderListSettings2.New",function(e){e.methods({initialize:function(e,t,i,n,a,o,s){this._appPart=e,this._isExpandedFunc=a,this._onExpand=o,this._usedDataSelector=i,this._listCursor=t,this._itemsData=n,this._typeName=this._appPart.getAppPartDefinition().getType(),this._appInstance=this._appPart.getAppInstance(),this._typesManager=this._appInstance.getTypesManager(),this._typeDef=this._typesManager.getType(this._typeName),this._dataItemFactory=this._appInstance.getDataItemFactory(),this._editViewGenerator=new this.imports.EditViewGenerator(this._typesManager),this._settingsPanel=s,this._itemActions=s,this._isInRichTextEditing=!1,this.resources.W.Commands.registerCommand("WAppsEditor2Commands.BeforeStartEditingText",!0),this.resources.W.Commands.registerCommandListenerByName("WAppsEditor2Commands.BeforeStartEditingText",this,this._onBeforeStartEditingText);
var r=this.resources.W.Commands.getCommand("WEditorCommands.StopEditingText");r&&r.registerListener(this,this._onStopEditingText),this._model=this._dataItemFactory.createDataItem(this._getNullItemRawData()),this._model.addEvent(Constants.DataItemEvents.CHANGE,this._onModelChanged)},setupPresenter:function(){this.rebuildModel(),this.updateGeneratedViewPart(),this._updateMetadata()},backToSettings:function(){this._settingsPanel.backToSettings()},createItem:function(){this._itemActions.createItem()},removeItem:function(){this._itemActions.removeItem()},duplicateItem:function(){this._itemActions.duplicateItem()},toggleItemVisibility:function(){this._itemActions.toggleItemVisibility()},editItem:function(){this._itemActions.editItem()},selectItems:function(){this._itemActions.selectItems()},createField:function(){this.resources.W.AppsEditor2.openAddFieldDialog(this._appPart,!0)},_getCurrentDataItemId:function(){var e=this._listCursor.getCurrentItemIndex();return e>=0?this._usedDataSelector.getItemIds()[e]:void 0},_updateMetadata:function(){if(!this._appPart.getIsDisposed()){var e=this._appPart.getDataSelector().isListSelector(),t=W.AppsEditor2.getTypesHelper().getDisplayableFields(this._typeDef),i=this._isInRichTextEditing,n=this._typeDef.displayName,a=this._model.getChildValue("title")?this._model.getChildValue("title"):this.resources.W.AppsEditor2.localize("DATA_EDIT_PANEL_UntitledItem"),o={noItems:0===this._itemsData.getChildren().length,pagingLabel:this._createPagingLabel(),noFields:0===t.length,expanded:this._isExpandedFunc(),isList:e,isInRichTextEditing:i,typeFriendlyName:n,itemTitle:a};this._setMetaDataValue(o)}},_setMetaDataValue:function(e){this._metaData?this._metaData.setValue(e):this._metaData=this._dataItemFactory.createDataItem(e)}})}),define.experiment.Class("wixapps.integration.gui.DataEditPresenter.AppBuilderPage.New",function(e,t){var i=e;i.methods({_updateMetadata:function(){var e=this._model.getChildValue("_iid"),t=this._usedDataSelector.getHiddenItemIds().contains(e),i=this._appPart.getDataSelector().isListSelector(),n=W.AppsEditor2.getTypesHelper().getDisplayableFields(this._typeDef),a=this._isInRichTextEditing,o=this._typeDef.displayName,s=this._model.getChildValue("title")?this._model.getChildValue("title"):this.resources.W.AppsEditor2.localize("DATA_EDIT_PANEL_UntitledItem"),r={hidden:t,noItems:0===this._itemsData.getChildren().length,pagingLabel:this._createPagingLabel(),noFields:0===n.length,expanded:this._isExpandedFunc(),isList:i,isInRichTextEditing:a,typeFriendlyName:o,itemTitle:s};this._setMetaDataValue(r)},_setMetaDataValue:function(e){this._metaData?this._metaData.setValue(e):this._metaData=this._dataItemFactory.createDataItem(e)}})}),define.experiment.Class("wixapps.integration.gui.DataItemsSelectionPresenter.AppBuilderListSettings2.New",function(e){e.methods({_buildModel:function(e){for(var t=this._dataSelector.getItemIds(),i=[],n=[],a=0;e.length>a;a++){var o=e[a],s=o.getChildValue("_iid"),r=o.getChildValue("title")?o.getChildValue("title"):this._appsEditor2Mgr.localize("DATA_EDIT_PANEL_UntitledItem"),l=t.contains(s),p={id:s,title:r,selected:l};if(l){var d=t.indexOf(s);i.splice(d,0,p),this._setItemSelectionState(s,!0)}else n.push(p)}this._model.setValue(i.append(n)),this._updateMetadata()},onItemClick:function(e){var t=e.context._data.getChildValue("id"),i=e.data.getValue();this._setItemSelectionState(t,i)},_updateAllItemsWithSelection:function(e){for(var t=this._model.getValue(),i=0;t.length>i;i++){var n=t[i];n.selected=e,this._setItemSelectionState(n.id,e)}this._model.setValue(t)},_setItemSelectionState:function(e,t){t?this._selectedItems[e]={selected:!0}:delete this._selectedItems[e],this._updateMetadata()},_updateDataSelector:function(){var e=[];Object.each(this._selectedItems,function(t,i){var n=this._dataSelector.getItemIdIndex(i);n=n>=0?n:e.length,e.splice(n,0,i)}.bind(this)),this._dataSelector.setItemIds(e)}})}),define.experiment.Class("wixapps.integration.gui.FieldEditPresenter.AppBuilderListSettings2.New",function(e){e.methods({initialize:function(e,t,i,n){this._fieldsMetaData=t,this._appPart=i,this._appInstance=i.getAppInstance(),this._updateModel=n,this._typeName=this._appPart.getAppPartDefinition().getType(),this._typeDef=this._appInstance.getTypesManager().getType(this._typeName),this.selectEditedField(e)},setupPresenter:function(){},selectEditedField:function(e){this._editedFieldId=e,this._editedFieldMetaData=_.find(this._fieldsMetaData,function(e){return this._editedFieldId===e.id},this);var t=this._appPart.getAppPartDefinition().getViewName();this._customizationTemplate={forType:this._typeName,view:t,fieldId:this.getFieldId(),mode:"view"};var i=this._appPart.getViewNode();this._associatedProxy=this._findAssociatedProxy(this.getFieldId(),i)},createFieldSelectionModel:function(){return{mode:"selectField",fieldDisplayName:this._editedFieldMetaData.displayName,fields:{selectedValue:this._editedFieldId,isSelectedMandatory:this._editedFieldMetaData.isMandatory,items:_.map(_.filter(this._fieldsMetaData,function(e){return!e.isContainer&&"Hidden"!==e.containerId}),function(e){return{value:e.id,text:e.displayName}})}}}})}),define.experiment.Class("wixapps.integration.gui.ManageItemsPresenter.AppBuilderListSettings2.New",function(e,t){e.binds(t.merge(["onItemMoved","onSelectionChanged","_onSharedDataChange"])),e.methods({initialize:function(e,t,i,n,a,o){this._appPart=e,this._appInstance=e.getAppInstance(),this._typeDef=n,this._typeName=this._typeDef.name,this._itemsData=i,this._appPartDataSelector=t,this._dataItemFactory=this._appInstance.getDataItemFactory(),this._model=this._dataItemFactory.createDataItem([]),this._listCursor=a,this._itemsData.addEvent(Constants.DataItemEvents.CHANGE,this._onSharedDataChange),this._itemActions=o,this._setupAction=Q.defer()},setupPresenter:function(){this._createModel(),this._updateMetadata(),0>this._listCursor.getCurrentItemIndex()&&this._listCursor.next(),this._setupAction.resolve()},runWhenReady:function(e){this._setupAction.promise.then(e)},rebuildModel:function(){this._ignoreChanges||(this._createModel(),this._updateMetadata())},_createModel:function(){for(var e=[],t=this._listCursor.getCurrentItemIndex(),i=this._itemsData.getChildren(),n=0;i.length>n;n++){var a=i[n],o=a.getChildValue("_iid"),s={itemId:o,title:this._getItemTitle(a),selected:t===n};e.push(s)}this.resources.W.Utils.AppsUtils.deepEquals(this._model.getValue(),e)||this._model.setValue(e)},_isMobile:function(){return!1},_updateMetadata:function(){var e=this._isMobile(),t={noItems:0===this._itemsData.getChildren().length,allowDrag:"IB.ManualSelectedList"==this._appPartDataSelector.getLogicalTypeName()&&!e,allowListActions:"IB.ManualSelectedList"==this._appPartDataSelector.getLogicalTypeName()&&!e,allowEditItem:!e};this._setMetaDataValue(t)},_setMetaDataValue:function(e){this._metaData?this._metaData.setValue(e):this._metaData=this._dataItemFactory.createDataItem(e)},createItem:function(){this._itemActions.createItem()},removeItem:function(){this._itemActions.removeItem()},duplicateItem:function(){this._itemActions.duplicateItem()},toggleItemVisibility:function(){this._itemActions.toggleItemVisibility()},editItem:function(){this._itemActions.editItem()},selectItems:function(){this._itemActions.selectItems()},onItemMoved:function(e){var t=e.cause.oldIndex,i=e.cause.newIndex;this._ignoreChanges=!0,W.UndoRedoManager.startTransaction(),this._appPartDataSelector.moveItem(t,i),this.resources.W.Commands.executeCommand("WAppsEditor2Commands.Undo.DataSelectorChange",{changeType:"Move",selector:this._appPartDataSelector,dataItemId:this._appPartDataSelector.getItemIds()[t],newValue:i,oldValue:t,appPart:this._appPart}),W.UndoRedoManager.endTransaction(),this._ignoreChanges=!1;var n=this._listCursor.getCurrentItemIndex(),a=n;n===t?a=i:(n>t&&a--,a>=i&&a++),n!==a&&this._listCursor.setSelectedIndex(a)},onSelectionChanged:function(e){var t=e.data.getParent().getChildIndex(e.data);0>t||this._listCursor.setSelectedIndex(t)}})}),define.experiment.Class("wixapps.integration.gui.ManageItemsPresenter.AppBuilderPage.New",function(e,t){var i=e;i.methods({_updateMetadata:function(){var e={noItems:0===this._itemsData.getChildren().length,allowDrag:"IB.ManualSelectedList"===this._appPartDataSelector.getLogicalTypeName(),allowListActions:"IB.ManualSelectedList"===this._appPartDataSelector.getLogicalTypeName()};this._setMetaDataValue(e)},_setMetaDataValue:function(e){this._metaData?this._metaData.setValue(e):this._metaData=this._dataItemFactory.createDataItem(e)}})}),define.experiment.Class("wixapps.integration.managers.ApplicationInstance.WixAppsApplicationData.New",function(e,t){var i=e,n=t;i.binds(n.merge(["_updateAppVars"])),i.methods({initialize:n.after(function(){this._appVars=null}),getAppVars:function(){return this._appVars},getAppVar:function(e){var t=this._appVars.getChildByRef(e);return void 0===t&&(this.setAppVar(e,void 0),t=this._appVars.getChildByRef(e)),t},getAppVarValue:function(e){return this._appVars.getChildValue(e)},setAppVar:function(e,t){var i=this._appVars.getValue();i[e]=t,this._appVars.setValue(i)},_setupAppVars:function(){var e=this._descriptor.appVars||{},t=this._getSavedAppVars(),i=function(){return Object.map(t.get("vars"),function(e){return JSON.parse(e.value)})},n=t?i():{},a=Object.merge(e,n);this._appVars=this._dataFactory.createDataItem(a);var o=this;this._appVars.addEvent(Constants.DataItemEvents.CHANGE,function(){if(!this._ignoreChanges){var e=o._appVars.getValue();o._setAppVarsWData(e)}})},_updateAppVars:function(e){var t=Object.map(e.get("vars"),function(e){return JSON.parse(e.value)}),i=this._appVars.getValue(),n=_.merge({},i,t);this._ignoreChanges=!0,this._appVars.setValue(n),this._ignoreChanges=!1},_getSavedAppVars:function(){var e=this.resources.W.Data,t="#appVars_"+this._appDefinitionId;if(e.isDataAvailable(t))return e.getDataByQuery(t);var i=this;return e.getDataByQuery(t,function(e){i._updateAppVars(e)}),null},_setAppVarsWData:function(e){var t=this.resources.W.Data,i="appVars_"+this._appDefinitionId;t.isDataAvailable("#"+i)||t.addDataItem(i,{type:"AppVars",vars:{}});var n=t.getDataByQuery("#"+i),a=Object.map(e,function(e){return{type:"AppPartParam",value:JSON.stringify(e)}});n.set("vars",a)}})}),define.experiment.Class("wixapps.integration.managers.ApplicationInstance.WixAppsPage.New",function(e,t){var i=e,n=t;i.resources(n.merge(["W.Classes","W.Viewer"])),i.methods({_onDescriptorLoaded:function(e){this._descriptor=e,this._setupAppVars();var t=e.lang||{};this._localizer=new this.imports.ApplicationLocalizer(t),e=this._localizer.localizeDescriptor(e);var i,n=Constants.WixAppsSystemTypes;for(i=0;n.length>i;i++)this._types.registerType(n[i]);for(i=0;e.types.length>i;i++)this._types.registerType(e.types[i]);var a=e.pages,o=this._getPageConfigurationRepository();if(a){var s=this;_.forEach(a,function(e){e.pageSettings&&e.pageSettings.pageIcon&&(e.pageSettings.pageIcon=s.resolveResourcePath(e.pageSettings.pageIcon)),e.pageSettings&&e.pageSettings.pageConfigurationType?o.registerConfig(e.id,{options:e.pageSettings,type:e.pageSettings.pageConfigurationType}):o.registerConfig(e.id,{options:e.pageSettings})})}for(this._customizations.addRules(e.customizations),this._addDataEditingCustomizations(),i=0;e.views.length>i;i++)for(var r=this._viewDefinitions.cloneAndMultiply(e.views[i]),l=0;r.length>l;l++)this._customizations.fillMissingIds(r[l]),this._customizations.applyAll(r[l]),this._viewDefinitions.setViewDefinition(r[l]);for(i=0;this._appParts.length>i;i++)this._appParts[i].initApp();for(i=0;this._appPages.length>i;i++)this._appPages[i].initApp();W.Viewer&&W.Viewer.isSiteReady()?this._zoomHandler.validateZoomRelatedData():this._callValidateZoomData()},_getPageConfigurationRepository:function(){return this.resources.W.Viewer.getPageConfigurationRepository()},setApplicationActiveState:function(e){this.setAppVar("applicationActiveState",e)},getApplicationActiveState:function(){return this.getAppVarValue("applicationActiveState")}})}),define.experiment.Class("wixapps.integration.managers.BubbleHandler.AppBuilderListSettings2.New",function(e){e.statics({ARROW_HGAP:12,ARROW_VGAP:45,Sets:{FT_AFTER_COPY_LIST:{titleKey:"FT_AFTER_COPY_LIST_Title",descriptionKey:"FT_AFTER_COPY_LIST_Description",iconFileName:"ft-tow-list-icon.png",links:[{titleKey:"FT_AFTER_COPY_LIST_1",helpId:"/node/6038"},{titleKey:"FT_AFTER_COPY_LIST_2",helpId:"/node/6038"}],hasDontShowAgainCheckbox:!0},FT_HELP_AFTER_ENABLE_PAGE:{titleKey:"FT_HELP_AFTER_ENABLE_PAGE_Title",descriptionKey:"FT_HELP_AFTER_ENABLE_PAGE_Description",iconFileName:"ft-item-page-icon.png",links:[{titleKey:"FT_HELP_AFTER_ENABLE_PAGE_1",helpId:"/node/6038"},{titleKey:"FT_HELP_AFTER_ENABLE_PAGE_2",helpId:"/node/6038"}]}}}),e.methods({showBubble:function(e,t,i,n){function a(){if(!n.isNodeDisplayed())return this.resources.W.Utils.callLater(a.bind(this)),void 0;var t=n.getPosition(),o=n.getSize();this._openBubbleDialog(r,e,i,{top:t.y+o.y/2-this.ARROW_VGAP,left:t.x+o.x+this.ARROW_HGAP})}var o=this.Sets[e];if(o){var s=o.links.map(function(e){return{title:this.localize(e.titleKey),helpId:e.helpId}}.bind(this)),r={helpLinks:s,title:this.localize(o.titleKey),description:this.localize(o.descriptionKey),iconSrc:"images/icons/"+o.iconFileName,hasDontShowAgainCheckbox:o.hasDontShowAgainCheckbox};a.call(this)}}})}),define.experiment.Class("wixapps.integration.managers.LifecycleManager.NBC_WCD.New",function(e){var t=e;t.methods({_waitsForWixification:function(e){return e.$viewProxy.isWixificationPending()},_performCleanup:function(){var e=this._pendingComponents;this._pendingComponents=[];for(var t=0;e.length>t;t++){var i=e[t];this._waitsForWixification(i)&&this._pendingComponents.push(i)}}})}),define.experiment.Class("wixapps.integration.managers.LifecycleManager.RenderPerf.New",function(e){var t=e;t.methods({notifyComponentReady:function(e){var t=this._pendingComponents.indexOf(e);t>-1&&this._pendingComponents.splice(t,1),this._performCleanup(),0===this._pendingComponents.length&&_.defer(this._executeAllPendingActions.bind(this))},performAction:function(e,t){t=t||this.ExecutionOrder.Normal,this._pendingActions[t]||(this._pendingActions[t]=[]),-1==this._pendingActions[t].indexOf(e)&&this._pendingActions[t].push(e),this._performCleanup(),0===this._pendingComponents.length&&_.defer(this._executeAllPendingActions.bind(this))},_executeAllPendingActions:function(){if(0===this._pendingComponents.length){var e=this._pendingActions;this._pendingActions={},Object.keys(e).sort().each(function(t){e[t].each(function(e){e()})})}}})}),define.experiment.Class("wixapps.integration.managers.ViewHolder.AppBuilderListSettings2.New",function(e){e.methods({_updateContent:function(){var e=this._rootProxy;this._stylesheetManager.reset(),this._rootProxy=this._proxyFactory.createView(this._data,this._viewName,this._mode),this._stylesheetManager.updateDocumentStylesheet();var t=this._rootProxy.createComponent();this._container.addClass("viewHolder"+(""+this._viewHolderID)),this.destroyContent(),this._container.adopt(t),this._resizeHandler.activateResizeHandler(this._eventDispatcher,t),this._rootProxy.setupProxy(),e&&e.dispose(),window.requestAnimFrame(function(){this._lifecycleManager.performAction(function(){this._eventDispatcher.fireEvent(Constants.WixAppEvents.APP_VIEW_READY),this._eventDispatcher.fireEvent(Constants.WixAppEvents.APP_VIEW_CREATED)}.bind(this))}.bind(this))}})}),define.experiment.Class("wixapps.integration.managers.WixAppsEditorManager.NBC_WCD.New",function(e,t){var i=e;i.methods({_addAppPart:function(e,t){var i=e.applicationId;this._applicationPageMgr.openDestinationPageDialogIfNeeded(i,t,function(){this._applicationPageMgr.addApplicationPages(i,function(){var n=e.widgets[t]||{},a={comp:"wixapps.integration.components.AppPart",data:{type:"AppPart",appInnerID:i,appLogicParams:{"wixapps:first-load-after-add-to-stage":{type:"AppPartParam",value:"true"}},appLogicCustomizations:[],appPartName:t,viewName:""},layout:{width:n.defaultWidth||500,height:n.defaultHeight||500},skin:"wysiwyg.viewer.skins.AppPartSkin"},o=e.packageName+"_"+t+"_1",s=W.Commands.getCommand("WEditorCommands.AddComponentFullParams"),r=function(t){var i=t.getAppPartLogic().getDataEditingMetaInfo(),n=i.hasDataSelection,a=i.openDataSelectionOnAddToStage;n&&a!==!1&&(s=W.Commands.getCommand("WAppsEditorCommands.OpenSectionDialog"),s.execute({selectedComp:t}));var o="page/"+this.injects().Preview.getPreviewManagers().Viewer.getCurrentPageId();LOG.reportEvent(wixEvents.APPS_FLOW_APP_ADDED_TO_STAGE,{g1:e.appDefinitionId,c1:o,c2:t.getComponentId()})}.bind(this);s.execute({compDef:a,styleId:o,onCreation:function(e){void 0!==e.getAppPartLogic()?r(e):e.addEvent("logicLoaded",function(){r(e)})}})}.bind(this))}.bind(this))}})}),define.experiment.Class("wixapps.integration.managers.WixAppsEditorManager.ViewerRefactor.New",function(e,t){var i=e;i.methods({getWixAppsComponentsOnSite:function(){return W.Preview.getPreviewManagers().Viewer.getSiteNode().getElements("div[comp='wixapps.integration.components.AppPart']")}})}),define.experiment.Class("wixapps.integration.managers.WixAppsEditorManager2.AppBuilderListSettings2.New",function(e,t){e.binds(t.merge(["_handleAppRepoUpdate","_handleDataStoreUpdate","_openAppBuilderManageDialog","_onDataItemChanged","_onPartCopied","_addDataItemChangeEvent"])),e.utilize(t.merge(["wixapps.integration.gui.CopyViewPresenter","wixapps.integration.gui.DataItemsSelectionPresenter","wixapps.integration.managers.BubbleHandler"])),e.methods({initialize:function(){this._viewBuilder=new this.imports.ViewBuilder,this._typesHelper=new this.imports.AppBuilderTypesHelper,this._appRepoTransport=new this.imports.AppRepoTransport,this._selectionHandler=new this.imports.SelectionHandler,this._fieldHighlighter=new this.imports.FieldHighlightHandler,this._applicationPageMgr=new this.imports.ApplicationPageManager,this._userExperience=new this.imports.UserExperienceKeyHandler,this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.CreateAppFromTemplate",this,this._onCreateAppPart),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.CreateAppByType",this,this._onCreateAppPartByType),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.AddExtraField",this,this._onAddExtraField),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.HideField",this,this._onHideField),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.MoveField",this,this._onMoveField),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.DeleteField",this,this._onDeleteField),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.OpenAppBuilderManageDialog",this,this._openAppBuilderManageDialog),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.CloseAppBuilderManageDialog",this,this._closeAppBuilderManageDialog),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.RefreshAppBuilderManageDialog",this,this._refreshAppBuilderManageDialog),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.AddNewDataItem",this,this._onAddNewDataItem),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.RemoveDataItem",this,this._onRemoveDataItem),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.CreateAppPage",this,this._createAppPage),this.resources.W.Commands.registerCommandAndListener("WEditorCommands.BeforeDeletePage",this,this._deleteAppPage),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.DataItemSelectionRequested",this,this._onDataItemSelectionRequested),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.EditPageTemplate",this,this._onEditPageTemplate),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.AppBuilderListAdded",this,this._onAppBuilderListAdded),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.AppBuilderTypeNameChanged",this,this._onAppBuilderTypeNameChanged,null,!0),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.OpenEditItem",this,this._openEditItem),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.OpenDesignList",this,this._openDesignPanel),this.resources.W.ClipBoard.registerPlugin("wixapps.integration.components.AppPart2",{onSetClip:this._onPartCopied,interceptDuplicate:function(e,t){this._interceptCopyAppBuilderComponent(e,t,!0,!0)}.bind(this),interceptPaste:function(e,t,i,n){this._interceptCopyAppBuilderComponent(e,t,i,n)}.bind(this),onPasteFromClip:function(e){this._modifyDataForCopiedCompOnClip(e)}.bind(this)});var e=this;this.resources.W.Preview.getPreviewManagersAsync(function(t){t.Viewer.addEvent("pageTransitionStarted",function(){e._closeAppBuilderManageDialog()}),e._registerToWixDbProviderChanges()}),this._initializeFTHelp(),this._initializeAppPage(),this._isReady=!0},_initializeFTHelp:function(){this._bubbleHandler=new this.imports.BubbleHandler(this),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.OpenHelpBubble",this,this._openHelpBubble)},_initializeAppPage:function(){this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.OpenPageLinkFieldsDialog",this,this._openPageLinkFieldsDialog)},_onCreateAppPart:function(e){this.getAppBuilderApplicationInstance(function(t){var i=t.getDataProviders().getWixDbDataProvider().getManagedTypes().length>0;i?this._openNewPartFromTemplateOrExistingDialog(t):this._openChooseTemplateDialog(t,function(i){this._createAppPartFromTemplate(t,i,e.type)}.bind(this))}.bind(this))},_createAppPartFromExisting:function(){},_createAppPartFromTemplate:function(e,t,i){var n=this._getApps2Manager();W.AppStoreManager.provisionApp(this.APP_BUILDER_APP_TYPE,this.APP_BUILDER_APP_DEFINITION_ID,null,function(a){var o=a.applicationId,s=a.instanceId;e.setApplicationId(o),e.setInstanceId(s),n.registerNewApplication(e,a);var r=this._viewBuilder.getViewTemplateDefinition(t),l=this._setupAppPart(e,o,r,i);this._openListDbAddedDialog(e,l)}.bind(this))},getAppBuilderApplicationInstance:function(e){var t=this._getAppBuilderApplication(),i=this._getApps2Manager();if(t)i.getApplicationInstance(t,function(i){if(!i)throw"No app instance found for applicationId ["+t+"]";e(i)});else{var n=i.createApplicationInstance(null);e(n)}},_createAppPage:function(e){var t=e.appInnerID,i=e.pageName,n=e.appPart,a=e.onPageCreated,o=n.getAppInstance(),s=n.getDataSelector().getDataProvider(),r=n.getAppPartDefinition().getType(),l=n.getAppPartDefinition().getViewName(),p=l+"_item_page",d=o.getViewDefinitions().getViewDefinition(r,l);d=this._viewBuilder.generatePageView(d.getValue(),"Center",630),d.forType=r,d.name=p,o.addViewDefinition(d);var c=o.getPages().createAndRegister("singleItem",r,i),h=o.getDataSelectors(),u=h.createAndRegister("IB.PageSelectedItem",s,r,{appPageId:c}),m=o.getAppPartDefinitions().createAndRegister(u,p,r);this._applicationPageMgr.addAppBuilderApplicationPage(t,c,o,i,m),a&&setTimeout(function(){a(c)},1e3)},_generateNewListNameForCollection:function(e,t){for(var i=e.getTypesManager().getType(t).displayName,n=i+" "+this.localize("COLLECTION_SETTINGS_BaseListNamePostfix","widget"),a=e.getAppPartDefinitions().filterByType(t,!0),o=_.map(a,function(e){return e.getDisplayName()}),s=n,r=2;_.contains(o,s);r++)s=n+" "+r;return s},_onCreateAppPartByType:function(e){var t=e.typeName,i=e.appInstance,n=e.templateId||"BlankList",a="IB.ManualSelectedList",o=this._generateNewListNameForCollection(i,t),s=e.type||"list",r=i.getDataSelectors(),l=i.getDataProviders().getWixDbDataProvider(),p=i.getApplicationId(),d=this.getAllItemsOfTypeDataSelector(t,i),c=this._viewBuilder.getViewTemplateDefinition(n),h=c.view,u=h.name,m=this;d.getItemIds(function(e){var n=r.createAndRegister(a,l,t,{itemIds:e});h.forType=t,i.addViewDefinition(h),m._setAdditionalViewDefinitions(s,c,i);var d=i.getAppPartDefinitions().createAndRegister(n,u,t,o);m._addAppPartComponent(p,i,d,c)})},_setupAppPart:function(e,t,i,n){this._closeAppBuilderManageDialog();var a,o=e.getDataItemFactory(),s=i.view,r=s.name,l=s.forType,p=i.data;a=e.getDataProviders().getWixDbDataProvider(),a.registerDataItemsChange(this._addDataItemChangeEvent,this._removeDataItemChangeEvent);var d=e.getTypesManager(),c=Object.clone(i.type);a.createType(c);for(var h=0;p.length>h;h++){var u=p[h],m=o.createDataItem(u);d.applyDefaults(m),a.createItem(m)}a.adminTypeMigration(c);var g=this._getSelectorLogicalType(n),f=_.pluck(p,"_iid"),y=e.getDataSelectors().createAndRegister(g,a,l,{itemIds:f});e.addViewDefinition(s),this._setAdditionalViewDefinitions(n,i,e),e.setupCustomizations([]);var v=e.getAppPartDefinitions().createAndRegister(y,r,l,i.friendlyName);return this._addAppPartComponent(t,e,v,i),v},saveDraft:function(e,t,i,n){var a=this._getApps2Manager().getApplicationInstances();"function"==typeof t&&(n=i,i=t,t=!1),a=Object.values(a),this._runAsyncOperation({collection:a,onComplete:i,namingFunction:function(e){return"save -  "+e.getInstanceId()},handlerFunction:function(e,i){e.performCleanup();var a=this.resources.W.ClipBoard.getClip();a&&a.data&&"AppBuilderComponent"===a.data.type&&this.resources.W.ClipBoard.resetClip(),this._handleAppRepoUpdate(e,t,function(){this._handleDataStoreUpdate(e,t,i,function(e){n&&n(e.description,e.code)})}.bind(this),function(e){n&&n(e.description,e.code)})}.bind(this)})},_beforeDeleteField:function(e,t,i){var n=e.countAppPartOfType(t,!1);n>1?this._openPromptDialog(this.localize("CONFIRM_REMOVE_FIELD_TITLE"),this.localize("CONFIRM_REMOVE_FIELD_DESCRIPTION"),"",this.resources.W.EditorDialogs.DialogButtonSet.DELETE_CANCEL,function(e){("DELETE"==e.result||"$AUTOMATED$"==e.result)&&i()},this._userExperience.KEYS.DELETE_FIELD_CONFIRM):i()},isTypeDisplayNameExists:function(e,t,i){function n(e){var i=e.displayName&&e.displayName.toLowerCase();return o===i&&a.getTypeName(e)!==t}var a=e.getTypesManager(),o=i.toLowerCase();return void 0!==_.find(a.getAllTypes(),n)},getNewDisplayNameForType:function(e,t,i){for(var n=i,a=2;this.isTypeDisplayNameExists(e,t,n);a++)n=i+" "+a;return n},_beforeDeleteItem:function(e,t,i){var n=e.countAppPartOfType(t,!0);n>1?this._openPromptDialog(this.localize("CONFIRM_REMOVE_ITEM_TITLE"),this.localize("CONFIRM_REMOVE_ITEM_DESCRIPTION"),"",this.resources.W.EditorDialogs.DialogButtonSet.DELETE_CANCEL,function(e){("DELETE"==e.result||"$AUTOMATED$"==e.result)&&i()},this._userExperience.KEYS.DELETE_ITEM_CONFIRM):i()},_openHelpBubble:function(e){var t=e.appPart,i=t.getAppPartDefinition().getType(),n=e.ftHelpSetName,a=e.anchorElement,o=e.forceOpen;this._bubbleHandler.showBubble(n,i,t,a,o)},_openPropertyPanel:function(){this.resources.W.Commands.executeCommand(Constants.EditorUI.OPEN_PROPERTY_PANEL,{forceOpen:!0})},_openEditItem:function(e){this._openPropertyPanel(),this.resources.W.Commands.executeCommand("WAppsEditor2Commands.OpenEditItemPanel",e)},_openDesignPanel:function(){this._openPropertyPanel(),this.resources.W.Commands.executeCommand("WAppsEditor2Commands.OpenDesignPanel")},openEditFieldDialog:function(e,t,i,n){var a=new this.imports.FieldEditPresenter(e,t,i,n);a.setupPresenter();var o=this.resources.W.AppsGUI.getDialogParams(this.localize("EDIT_FIELD_PANEL_Title"),this.localize("EDIT_FIELD_PANEL_Description"));o.semiModal=!0,delete o.nonModal,this.resources.W.AppsGUI.openWDialog("wixapps.integration.components.panels.EditFieldPanel",a,o,"wixapps.integration.skins.dialogs.EditFieldPanelSkin")},openCopyViewDialog:function(e){var t=new this.imports.CopyViewPresenter(e),i=this.resources.W.AppsGUI.getDialogParams(this.localize("COPY_VIEW_Title"),"","semiModal");i.width=420,i.minHeight=180,i.maxHeight=500,i.buttonSet=this.resources.W.EditorDialogs.DialogButtonSet.OK_CANCEL,this.resources.W.AppsGUI.openDialog(e.getAppInstance(),"CopyView",t,i)},_openNewPartFromTemplateOrExistingDialog:function(e){var t=e.getTypesManager(),i=e.getDataProviders().getWixDbDataProvider().getManagedTypes(),n=e.getDataItemFactory().createDataItem({existingTypes:i}),a=this,o=null,s={setupPresenter:function(e){o=e},getModel:function(){return n},newListFromTemplate:function(){o.closeDialog(),a._openChooseTemplateDialog(e,function(t){a._createAppPartFromTemplate(e,t,"list")})},newListFromExisting:function(i){o.closeDialog();var n=i.data.getValue();a.resources.W.Commands.executeCommand("WAppsEditor2Commands.CreateAppByType",{typeName:t.getTypeName(n),appInstance:e})}},r=this.resources.W.AppsGUI.getDialogParams("Create List Database Widget","","semiModal");r.width=420,r.minHeight=260,r.maxHeight=460,r.buttonSet=this.resources.W.EditorDialogs.DialogButtonSet.NONE,this.resources.W.AppsGUI.openDialog(e,"NewPartFromTemplateOrExisting",s,r)},_openChooseTemplateDialog:function(e,t){var i=this.getViewBuilder().getTemplateBundles(),n=new this.imports.ChooseTemplatePresenter(e,t,i),a=this.resources.W.AppsGUI.getDialogParams(this.localize("CHOOSE_TEMPLATE_Title_Template_Picker_2"),this.localize("CHOOSE_TEMPLATE_Description_Template_Picker_2"));a=Object.merge(a,{width:960,height:455,minHeight:455,position:"center",level:1,allowScroll:!1,showToolbar:!1,nonModal:!0,allowDrag:!0,buttonSet:this.resources.W.EditorDialogs.DialogButtonSet.NONE,helplet:"/node/14831"});var o=["ChooseTemplate2TemplateItem"];this.resources.W.AppsGUI.openDialog(e,"ChooseTemplate2",n,a,o)},_openPageLinkFieldsDialog:function(e){function t(e,t){var i=m._typesHelper.getDisplayableFields(e),n=["String","wix:Image"],a=i.filter(function(e){var i=n.contains(e.type),a=m._viewBuilder.isTypeFieldInView(t,e.name);return i&&a}.bind(this));return a}function i(e){var t=!1;if(e){t=Object.some(e,function(e){return e===!0});var i=o.getAppPartDefinition().getType(),a=o.getAppInstance().getPages().getPageDefByType(i);if(a)n(e,a.getId()),l(t),r&&this.resources.W.Commands.executeCommand("WAppsEditor2Commands.EditPageTemplate",{type:i,appInstance:p});else if(t){var s=o._data.get("appInnerID"),d=o.getAppInstance().getTypesManager().getType(i),c=d.displayName,h=this;W.Commands.executeCommand("WAppsEditor2Commands.CreateAppPage",{appInnerID:s,pageName:c,appPart:this._appPart,onPageCreated:function(a){n(e,a),l(t),r&&h.resources.W.Commands.executeCommand("WAppsEditor2Commands.EditPageTemplate",{type:i,appInstance:p})}})}}else l(t)}function n(e,t){Object.each(e,function(e,i){var n=m._viewBuilder.getViewFieldByTypeField(u,i);e?n.comp.pageLink=t:delete n.comp.pageLink}.bind(this)),h.setValue(u)}var a=e.suggestedFields||[],o=e.appPart,s=e.pos;"function"==typeOf(s)&&(s=s());var r=e.moveToPage,l=e.onComplete,p=o.getAppInstance(),d=o.getAppPartDefinition(),c=d.getTypeDef(),h=o.getViewDefinition(),u=h.getValue(),m=this,g="";this.openContextDialog(400,400,"wixapps.intergration.components.editor.dialogs.PageLinkFieldsDialog","wysiwyg.editor.skins.panels.base.AutoPanelSkin",this.localize("LIST_SETTINGS_PANEL_SetLinkToPage"),o,i,i,g,{suggestedFields:a||[],eligibleFields:t(c,u)})},_onEditPageTemplate:function(e){var t=e.type,i=e.appInstance,n=i.getPages().getPageDefByType(t),a=n.getId(),o=this.resources.W.Preview.getPreviewManagers().Viewer,s=o.getAppPages()[a],r=o.getCurrentPageId();o.goToPage(s._data.get("id"));var l=i.getDataItemFactory().createDataItem({}),p=null,d={setupPresenter:function(e){p=e},getModel:function(){return l},goBack:function(){o.goToPage(r),p.closeDialog()},showHelp:function(){alert("TODO: show help and change icon")}},c=this.resources.W.AppsGUI.getDialogParams("","","noTitle");c.width=400,c.height=36,c.minHeight=36,c.maxHeight=36,c.position="top",this.resources.W.AppsGUI.openDialog(i,"PageTemplateInfo",d,c)},_openDataItemSelectionDialog:function(e,t,i,n,a){var o=new this.imports.DataItemsSelectionPresenter(e,t,i,n,a),s=this.resources.W.AppsGUI.getDialogParams(this.localize("DATA_ITEMS_SELECTION_Title2"),void 0);s=Object.merge(s,{dialogSkin:"wixapps.integration.skins.dialogs.GrayDialogWindowSkin",width:500,height:475,minHeight:475,position:"center",level:1,allowScroll:!1,showToolbar:!1,nonModal:!0,allowDrag:!0,buttonSet:this.resources.W.EditorDialogs.DialogButtonSet.OK_CANCEL,helpButtonId:""}),this.resources.W.AppsGUI.openDialog(i,"DataItemsSelection",o,s)
},_onPartCopied:function(e){var t=e.getAppInstance(),i=e.getAppPartDefinition(),n=t.getLogger(),a={c1:JSON.stringify(i.toObject())};n.reportEvent(n.Events.APP_PART_COPIED,a)},_interceptCopyAppBuilderComponent:function(e,t,i,n){this.resources.W.ClipBoard.pasteFromClip(t,i,e,n),this._openPropertyPanel(),this.resources.W.Commands.executeCommand("WAppsEditor2Commands.ShowSelectItemsHelp")},_modifyDataForCopiedCompOnClip:function(e){var t=e.data.appInnerID,i=e.data.appPartName,n=this.getAppInstanceSync(t),a=n.getAppPartDefinitions(),o=a.getById(i),s=n.getDataSelectors(),r=s.getById(o.getDataSelectorId()),l=s.createBasedOnOtherSelector(r);e.data=this._prepareDataForCopiedComp(t,n,o,l)},_prepareDataForCopiedComp:function(e,t,i,n){var a=t.getViewDefinitions(),o=i.getType(),s=i.getViewName(),r=s+"_dup_"+this.resources.W.Utils.AppsUtils.getTimeBasedUniqueId();a.duplicateListViewDefinition(t,s,r,o,o);var l=n.getId(),p=this._ensureUniqueWidgetName(t,i.getDisplayName()),d=t.getAppPartDefinitions().createAndRegister(l,r,o,p);return{type:"AppBuilderComponent",appInnerID:e,appPartName:d}},_ensureUniqueWidgetName:function(e,t){for(var i=e.getAppPartDefinitions(),n=i.toArray().map(function(e){return e.displayName}),a=t,o=2;n.contains(a);o++)a=t+" "+o;return a},openContextDialog:function(e,t,i,n,a,o,s,r,l,p){p=p||{};var d=this.resources.W.EditorDialogs;d._createAndOpenWDialog("_contextDialog",i,n,function(){},{width:t,maxHeight:e,position:Constants.DialogWindow.POSITIONS.CENTER,allowScroll:!1,tabs:!1,title:a,titleHeight:50,description:null,allowDrag:!1,helpIcon:!0,semiModal:!0,buttonSet:d.DialogButtonSet.OK_CANCEL,helpButtonId:l,helplet:null},null,!0,Object.append({previewComponent:o,okCallback:s,cancelCallback:r},p),!0,!1,!0)},_openListDbAddedDialog:function(e,t){var i=e.getAppPartDefinitions().getById(t),n=i.getTypeDef(),a=e.getTypesManager().getTypeName(n),o=this.resources.W.Utils.AppsUtils,s=e.getDataItemFactory().createDataItem({invalidName:!1,displayName:n.displayName}),r=null,l=this,p={setupPresenter:function(e){r=e},getModel:function(){return s},inputChanged:function(){s.getChildByRef("invalidName").setValue(!1)},saveAndClose:function(){var t=o.removeExtraSpaces(s.getValue().displayName);if(n.displayName!==t){if(l.isTypeDisplayNameExists(e,a,t)||""==t)return s.getChildByRef("invalidName").setValue(!0),void 0;n.displayName=t,l.resources.W.Commands.executeCommand("WAppsEditor2Commands.AppBuilderTypeNameChanged",{displayName:t,typeName:a,appInstance:e})}r.closeDialog()},learnMore:function(){alert("TODO: complete this")}},d=this.resources.W.AppsGUI.getDialogParams("Well done! Youve added a new list view.","","semiModal");d.width=420,d.height=280,d.minHeight=280,d.buttonSet=this.resources.W.EditorDialogs.DialogButtonSet.NONE,this.resources.W.AppsGUI.openDialog(e,"NewListDbCreatedFromTemplate",p,d)},_onAppBuilderTypeNameChanged:function(e){var t=e.appInstance.getPages(),i=t.getPageDefByType(e.typeName);if(i){var n=this.resources.W.Preview.getPreviewManagers().Viewer.getPagesData();_.each(n,function(t){t.get("appPageId")===i.getId()&&t.set("title",e.displayName)},this)}}})}),define.experiment.Class("wixapps.integration.managers.WixAppsEditorManager2.AppBuilderPage.New",function(e,t){var i=e,n=t;i.utilize(n.merge(["wixapps.integration.managers.FAQHandler","wixapps.integration.managers.BubbleHandler"])),i.fields({_faqHandler:null}),i.methods({_initializeFTHelp:function(){this._faqHandler=new this.imports.FAQHandler(this),this._bubbleHandler=new this.imports.BubbleHandler(this),this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.OpenHelpBubble",this,this._openHelpBubble)},_initializeAppPage:function(){this.resources.W.Commands.registerCommandAndListener("WAppsEditor2Commands.OpenPageLinkFieldsDialog",this,this._openPageLinkFieldsDialog)},_beforeDeleteItem:function(e,t,i){var n=e.countAppPartOfType(t,!0);n>1?this._openPromptDialog(this.localize("CONFIRM_REMOVE_ITEM_TITLE"),this.localize("CONFIRM_REMOVE_ITEM_DESCRIPTION"),"",this.resources.W.EditorDialogs.DialogButtonSet.DELETE_CANCEL,function(e){("DELETE"==e.result||"$AUTOMATED$"==e.result)&&i()},this._userExperience.KEYS.DELETE_ITEM_CONFIRM):i()},_beforeDeleteField:function(e,t,i){var n=e.countAppPartOfType(t,!1);n>1?this._openPromptDialog(this.localize("CONFIRM_REMOVE_FIELD_TITLE"),this.localize("CONFIRM_REMOVE_FIELD_DESCRIPTION"),"",this.resources.W.EditorDialogs.DialogButtonSet.DELETE_CANCEL,function(e){("DELETE"==e.result||"$AUTOMATED$"==e.result)&&i()},this._userExperience.KEYS.DELETE_FIELD_CONFIRM):i()},_onAppBuilderListAdded:function(e){this._openFAQ(e.appPart,"LIST_ADDED")},_openFAQ:function(e,t){var i=e.getAppPartDefinition().getType();this._faqHandler.openFAQDialog(t,i,e)},_openHelpBubble:function(e){var t=e.appPart,i=t.getAppPartDefinition().getType(),n=e.ftHelpSetName,a=e.anchorElement;this._bubbleHandler.showBubble(n,i,t,a)},_openChooseTemplateDialog:function(e,t,i){if(i)return t(i),void 0;var n=this.getViewBuilder().getTemplateBundles(),a=new this.imports.ChooseTemplatePresenter(e,t,n),o=this.resources.W.AppsGUI.getDialogParams(this.localize("CHOOSE_TEMPLATE_Title_Template_Picker_2"),this.localize("CHOOSE_TEMPLATE_Description_Template_Picker_2"));o=Object.merge(o,{dialogSkin:"wixapps.integration.skins.dialogs.ChooseTemplateDialogWindowSkin",width:960,height:455,minHeight:455,position:"center",level:1,allowScroll:!1,showToolbar:!1,nonModal:!0,allowDrag:!0,buttonSet:this.resources.W.EditorDialogs.DialogButtonSet.NONE,helplet:"/node/14831"});var s=["Tabs","Templates","ExistingCollections"];this.resources.W.AppsGUI.openDialog(e,"ChooseTemplate2",a,o,s)},_openPageLinkFieldsDialog:function(e){function t(e,t){var i=m._typesHelper.getDisplayableFields(e),n=["String","wix:Image"],a=i.filter(function(e){var i=n.contains(e.type),a=m._viewBuilder.isTypeFieldInView(t,e.name);return i&&a}.bind(this));return a}function i(e){var t=!1;if(e){t=Object.some(e,function(e){return e===!0});var i=o.getAppPartDefinition().getType(),a=o.getAppInstance().getPages().getPageDefByType(i);if(a)n(e,a.getId()),l(t),r&&this.resources.W.Commands.executeCommand("WAppsEditor2Commands.EditPageTemplate",{type:i,appInstance:p});else if(t){var s=o._data.get("appInnerID"),d=o.getAppInstance().getTypesManager().getType(i),c=d.displayName,h=this;W.Commands.executeCommand("WAppsEditor2Commands.CreateAppPage",{appInnerID:s,pageName:c,appPart:this._appPart,onPageCreated:function(a){n(e,a),l(t),r&&h.resources.W.Commands.executeCommand("WAppsEditor2Commands.EditPageTemplate",{type:i,appInstance:p})}})}}else l(t)}function n(e,t){Object.each(e,function(e,i){var n=m._viewBuilder.getViewFieldByTypeField(u,i);e?n.comp.pageLink=t:delete n.comp.pageLink}.bind(this)),h.setValue(u)}var a=e.suggestedFields||[],o=e.appPart,s=e.pos;"function"==typeOf(s)&&(s=s());var r=e.moveToPage,l=e.onComplete,p=o.getAppInstance(),d=o.getAppPartDefinition(),c=d.getTypeDef(),h=o.getViewDefinition(),u=h.getValue(),m=this,g="";this.openContextDialog(400,400,"wixapps.intergration.components.editor.dialogs.PageLinkFieldsDialog","wysiwyg.editor.skins.panels.base.AutoPanelSkin",this.localize("LIST_SETTINGS_PANEL_SetLinkToPage"),{left:s.x,top:s.y},o,i,i,g,{suggestedFields:a||[],eligibleFields:t(c,u)})}})}),define.experiment.Class("wixapps.integration.managers.WixAppsEditorManager2.NBC_WCD.New",function(e,t){var i=e;i.methods({_addAppPartComponent:function(e,t,i,n){var a={comp:"wixapps.integration.components.AppPart2",data:{type:"AppBuilderComponent",appInnerID:e,appPartName:i},layout:{width:n.defaultWidth||500,height:n.defaultHeight||500},skin:"wysiwyg.viewer.skins.AppPartSkin"},o="app1",s=this.resources.W.Commands.getCommand("WEditorCommands.AddComponentFullParams");s.execute({compDef:a,styleId:o,onCreation:function(e){this.resources.W.Commands.executeCommand("WAppsEditor2Commands.AppBuilderListAdded",{appPart:e})}.bind(this)}),this._reportAddPartToBi(t,n,i)}})}),define.experiment.Class("wixapps.integration.managers.WixAppsGUIManager.AppBuilderListSettings2.New",function(e){e.fields({_dialogProfiles:{basicPopup:{width:300,position:"side",level:1,allowScroll:!0,showToolbar:!0,nonModal:!0,allowDrag:!0,buttonSet:["OK"]},semiModal:{width:300,level:1,position:"center",allowScroll:!0,showToolbar:!0,semiModal:!0,allowDrag:!0,buttonSet:["OK"]},noTitle:{width:300,level:1,position:"center",allowScroll:!1,showToolbar:!0,semiModal:!0,allowDrag:!1,buttonSet:[],dialogSkin:"wixapps.integration.skins.dialogs.NoTitleDialogWindowSkin"}}}),e.methods({addViewToPanel:function(e,t,i,n,a){var o=!1,s=this.getViewDescriptor(i),r=[];a&&(r=a.map(function(e){return this.getViewDescriptor(e)}.bind(this)));var l=function(e){var i=t.getSkinPart("content")||t.getSkinPart("inlineContent")||t.getViewNode();i.grab(e),o=!0},p=function(t){o||l(t.getViewNode()),t.setState("content"),t.setupPanel(e,s,n,r)};this.resource.getResourceValue("W.Components",function(e){var t=e.createComponent("wixapps.integration.components.panels.BuilderDialogPanel","wysiwyg.viewer.skins.AppPartSkin","",{},function(){},p);o||l(t)})}})}),define.experiment.Class("wixapps.integration.managers.WixAppsManager.WixAppsPage.New",function(e,t){var i=e;i.methods({_initialize:function(){this._appInstanceMap={},this._appDescriptorMap={},this._descriptionCallBacks={},this._logger=new this.imports.WixAppsLogger,this.resources.W.Utils.AppsUtils.getUserRole(function(e){this._userRole=e}.bind(this)),this.registerAppPageConfiguration(),this._loadInstalledApps()},registerAppPageConfiguration:function(){var e=this._getPageConfigurationRepository();e.registerPageType("AppPage",function(e){return"AppPage"===e.appPageType?e.appPageId:e.appPageType})},_getPageConfigurationRepository:function(){return this.resources.W.Viewer.getPageConfigurationRepository()}})}),define.experiment.Class("wixapps.integration.managers.WixAppsManager2.ViewerRefactor.New",function(e,t){var i=e,n=t;i.resources(n.customizeField(function(e){var t=_.without(e,"W.Pages");return 0>t.indexOf("W.Viewer")&&t.push("W.Viewer"),t})),i.methods({getAppPart2Components:function(e){var t=W.Viewer.getSiteNode().getElements("div[comp*='AppPart2']"),i=[],n=t.map(function(e){return e.getLogic&&e.getLogic()?e.getLogic():(i.push(e.get("id")),void 0)});if(e===!0&&i.length>0)throw"AppPart2 "+JSON.stringify(i)+" has missing logic";return n.clean()}})}),define.experiment.Class("wixapps.integration.managers.WixAppsManager2.WixAppsPage.New",function(e,t){var i=e,n=t;i.utilize(["wixapps.core.apprepo.ApplicationInstance2","wixapps.core.apprepo.AppRepoTransport","wixapps.core.utils.WixAppsLogger","wixapps.core.data.selectors.AllItemsOfTypeDataSelector"]),i.methods({initialize:n.after(function(){this.registerAppBuilderPageConfiguration()}),registerAppBuilderPageConfiguration:function(){var e=this._getPageConfigurationRepository();e.registerConfig("AppBuilderPage",{options:{canBeDeleted:!0,canBeDuplicated:!1,showSeoSettings:!1,canBeHidden:!1,isHidden:!0,canBeReordered:!0,canHaveChildren:!1,canBeAddedFromMenu:!1,canBeSetAsHomePage:!1,showBasicSettings:!1}})},_getPageConfigurationRepository:function(){return this.resources.W.Viewer.getPageConfigurationRepository()}})}),define.experiment.Class("wixapps.integration.managers.applicationhandlers.ZoomHandler.MobileEcomViews.New",function(e,t){var i=e,n=t;i.resources(n.merge(["W.Config"])),i.methods({openZoomForItemsList:function(e,t,i,n){var a=this;this._lastOpenedItem=e[t],this._lastOpenedItemTimestamp=(new Date).getTime(),this._getPermaLinkAndZoomPartData(i,function(i){var o=i&&i.partData;o&&n&&n.viewName&&(a._applicationInstance.getPartDefinition(o.get("appPartName")),o.set("viewName",n.viewName));var s=i&&i.permaLinkData,r=a.resources.W.Data.createDataItem({type:"list",items:e},"list");a.resources.W.Commands.executeCommand("WViewerCommands.OpenZoom",{itemsList:r,currentIndex:t,extraParams:n||{},getDisplayerDivFunction:a._getAppPartDivFunction(s,n),getHashPartsFunction:a._getHashPartsFunction(s)},a)})},_setComponentSize:function(e,t,i,n){var a=e.defaultWidth?Math.min(e.defaultWidth,i):i,o=this.resources.W.Config.mobileConfig.isMobile();o&&(a=this.injects().Utils.getWindowSize().width),t.setWidth(a),e.defaultHeight&&!o&&t.setHeight(e.defaultHeight),window.requestAnimFrame(function(){t.getMainProxy().updateLayoutWhenReady(function(){t.getEventDispatcher().fireEvent(Constants.WixAppEvents.APP_VIEW_READY),n(t.getViewNode())}.bind(this))}.bind(this))},_getZoomPartSkinName:function(e){return e&&e.zoomPartSkin?e.zoomPartSkin:"wysiwyg.viewer.skins.area.CleanZoomAreaSkin"}})}),define.experiment.Class("wixapps.integration.proxies.CheckBoxProxy.MediaZoomDispose.New",function(e){e.methods({dispose:function(){this._disposed||(this._data.removeEvent(Constants.DataItemEvents.VALIDATION_PERFORMED,this._onValidation),this.parent())}})}),define.experiment.Class("wixapps.integration.proxies.CheckBoxGroupProxy.MediaZoomDispose.New",function(e){e.methods({dispose:function(){this._disposed||(this._data.removeEvent(Constants.DataItemEvents.VALIDATION_PERFORMED,this._onValidation),this.parent())}})}),define.experiment.Class("wixapps.integration.proxies.ComboBoxProxy.MediaZoomDispose.New",function(e){e.methods({dispose:function(){this._disposed||(this._data.removeEvent(Constants.DataItemEvents.VALIDATION_PERFORMED,this._onValidation),this.parent())}})}),define.experiment.Class("wixapps.integration.proxies.DateSelectorProxy.MediaZoomDispose.New",function(e){e.methods({dispose:function(){this._disposed||(this._data.removeEvent(Constants.DataItemEvents.VALIDATION_PERFORMED,this._onValidation),this.parent())}})}),define.experiment.newClass("wixapps.integration.proxies.DragAndDropVListProxy.AppBuilderListSettings2.New",function(e){e.binds(["_onItemDrag","_onItemEndDrag"]),e.inherits("wixapps.integration.proxies.ListProxy2"),e.methods({createComponent:function(){var e=this.parent();return e.setStyle("position","relative"),this._applyExtraDragStyling(),e},_updateItemTemplates:function(){this.parent(),this._applyExtraDragStyling()},_onChildCreated:function(e,t){if(this.parent(e,t),!t.hasClass("container")&&!t.hasClass("non-draggable")){var i=function(t){this._startDragChild(e,this._children.indexOf(e),t)}.bind(this);e.dragEventHandler=i,t.addEvent(Constants.CoreEvents.MOUSE_DOWN,i)}},_onBeforeChildDisposed:function(e){this.parent(e),e.dragEventHandler&&e.getElement().removeEvent(Constants.CoreEvents.MOUSE_DOWN,e.dragEventHandler)},_startDragChild:function(e,t,i){if("INPUT"!=i.target.tagName){this._startIdx=t,this._body=this._body||document.body;var n=i.client.y+window.getScroll().y;this._deltaY=n-e.getElement().getPosition().y,this._lastMouseY=n,this._startedDrag=!1,this._body.addEvent(Constants.CoreEvents.MOUSE_MOVE,this._onItemDrag),this._body.addEvent(Constants.CoreEvents.MOUSE_UP,this._onItemEndDrag),this._body.addClass("blockSelection")}},_doStartDrag:function(){var e=this._children[this._startIdx];this._movedElement=e.getElement(),this._undockMovingItem(),this._startedDrag=!0},_undockMovingItem:function(){var e=this._movedElement.getSize(),t=this._movedElement.getPosition(),i=this._rootElement.getPosition();this._placeholder=new Element("DIV"),this._placeholder.setStyles({width:e.x,height:e.y,backgroundColor:"#FF8F00",border:"1px dashed #544300"}),this._movedContainer=new Element("DIV"),this._movedContainer.setStyles({width:e.x,height:e.y,position:"absolute",top:t.y-i.y-this._deltaY,"border-radius":5,"box-shadow":"rgba(0, 59, 202, 0.6) 0px 0px 5px 5px",opacity:.8}),this._rootElement.insertBefore(this._placeholder,this._movedElement),this._rootElement.grab(this._movedContainer),this._movedContainer.grab(this._movedElement),this._applyExtraDragStyling()},_dockMovingItem:function(){this._rootElement.replaceChild(this._movedElement,this._placeholder),this._placeholder.destroy(),this._placeholder=void 0,this._movedContainer.destroy(),this._movedContainer=void 0,this._applyExtraDragStyling()},_onItemDrag:function(e){this._startedDrag||this._doStartDrag();var t=e.client.y+window.getScroll().y,i=this._rootElement.getPosition(),n=t-i.y-this._deltaY;this._movedContainer.setStyle("top",n);var a=this._lastMouseY>t;this._lastMouseY=t;for(var o=void 0,s=0;this._rootElement.children.length>s;s++){var r=this._rootElement.children[s],l=r.getPosition().y,p=l+r.getSize().y;if(t>=l&&p>t){o=r;break}}o!==this._placeholder&&(0>n&&(o=this._rootElement.firstChild),a?this._rootElement.insertBefore(this._placeholder,o):this._rootElement.insertBefore(this._placeholder,o.nextSibling),this._applyExtraDragStyling())},_applyExtraDragStyling:function(){this._hideShowContainers()},_hideShowContainers:function(){var e=this._rootElement.getElements(".container");Array.each(e,function(e){var t=e.getElement(".container-box"),i=e.getNext();!i||i===this._movedContainer||i&&i.hasClass("container")?(t.removeClass("hidden"),e.setStyle("opacity","0.5")):(t.addClass("hidden"),e.setStyle("opacity","1"))}.bind(this))},_onItemEndDrag:function(){if(this._body.removeEvent(Constants.CoreEvents.MOUSE_MOVE,this._onItemDrag),this._body.removeEvent(Constants.CoreEvents.MOUSE_UP,this._onItemEndDrag),this._body.removeClass("blockSelection"),this._startedDrag){for(var e=-1,t=0;this._rootElement.children.length>t;t++)if(this._rootElement.children[t]===this._placeholder){e=t;break}this._dockMovingItem(),this._startIdx!=e&&(this._children.splice(e,0,this._children.splice(this._startIdx,1)[0]),this._data.moveChildByIndex(this._startIdx,e),this.fireEvent("itemMoved",{oldIndex:this._startIdx,newIndex:e}))}},_registerProxyEvents:function(e,t){this.parent(e,t),"itemMoved"===e&&this.addEvent(e,t)}})}),define.experiment.Class("wixapps.integration.proxies.DraggableListItemProxy.AppBuilderListSettings2.New",function(e){e.methods({_onComponentWixified:function(){this.parent();var e=this._getLayoutRootElement();this.imports.BoxFlexPolyfill.applyBoxFlexPolyfill(e),this._applyBoxStyles(e),this._setupBox(e)}})}),define.experiment.Class("wixapps.integration.proxies.ImageSelectorProxy.AppBuilderListSettings2.New",function(e,t){e.resources(t.merge(["W.Commands"])),e.methods({_openReplaceMedia:function(){this.resources.W.Commands.executeCommand("WEditorCommands.OpenMediaFrame",{galleryConfigID:this._def.getChildValue("galleryConfigID"),deleteText:this._def.getChildValue("removeImageLabel"),selectionType:this._def.getChildValue("selectionType")||"single",publicMediaFile:this._def.getChildValue("publicMediaFile")||"photos",i18nPrefix:this._def.getChildValue("i18nPrefix")||"single_image",mediaType:this._def.getChildValue("mediaType")||"picture",callback:this._onImgSelect})}})}),define.experiment.Class("wixapps.integration.proxies.ListProxy2.AppBuilderListSettings2.New",function(e){e.methods({_removeChild:function(e){var t=this._children.splice(e,1);this._onBeforeChildDisposed(t),t[0].dispose(),this._childrenTemplateMap.splice(e,1)}})}),define.experiment.Class("wixapps.integration.proxies.OptionListInputProxy.MediaZoomDispose.New",function(e){e.methods({dispose:function(){this._disposed||(this._data.removeEvent(Constants.DataItemEvents.VALIDATION_PERFORMED,this._onValidation),this.parent())}})}),define.experiment.Class("wixapps.integration.proxies.OptionsListProxy.MediaZoomDispose.New",function(e){e.methods({dispose:function(){this._disposed||(this._data.removeEvent(Constants.DataItemEvents.VALIDATION_PERFORMED,this._onValidation),this.parent())}})}),define.experiment.Class("wixapps.integration.proxies.ProxyMap.AppBuilderListSettings2.New",function(e,t){e.utilize(t.merge(["wixapps.integration.proxies.DragAndDropVListProxy"])),e.methods({registerComponentProxies:function(e){e.registerProxy("Label",this.imports.LabelProxy,"String",[{forType:"String",forMode:"view"},{forType:"Number",forMode:"view"},{forType:"wix:RichText",forMode:"view"}]),e.registerProxy("ClippedParagraph",this.imports.ClippedParagraphProxy,"String"),e.registerProxy("Date",this.imports.DateProxy,"wix:Date"),e.registerProxy("DateEdit",this.imports.DateSelectorProxy,"wix:Date"),e.registerProxy("TimeEdit",this.imports.TimeSelectorProxy,"wix:Date"),e.registerProxy("InlineText",this.imports.InlineTextProxy,"String"),e.registerProxy("InlineTextInput",this.imports.InlineTextInputProxy,"String"),e.registerProxy("TextInput",this.imports.TextInputProxy,"String",[{forType:"String",forMode:"edit"}]),e.registerProxy("NumberInput",this.imports.NumberInputProxy,"Number",[{forType:"Number",forMode:"edit"}]),e.registerProxy("NumericStepper",this.imports.NumericStepperProxy,"Number",[{forType:"NumberInRange",forMode:"edit"}]),e.registerProxy("CheckBox",this.imports.CheckBoxProxy,"Boolean",[{forType:"Boolean",forMode:"edit"}]),e.registerProxy("CheckBoxViewProxy",this.imports.CheckBoxViewProxy,"Boolean",[{forType:"Boolean",forMode:"view"}]),e.registerProxy("RichTextEditor",this.imports.RichTextEditorProxy,"wix:RichText"),e.registerProxy("RichTextEditorInline",this.imports.RichTextEditorInlineProxy,"wix:RichText",[{forType:"wix:RichText",forMode:"edit"}]),e.registerProxy("Price",this.imports.FormattedPriceProxy,"Price",[{forType:"Price",forMode:"view"}]),e.registerProxy("Image",this.imports.ImageProxy,"wix:Image",[{forType:"wix:Image",forMode:"view"}]),e.registerProxy("Video",this.imports.VideoProxy,"wix:Video",[{forType:"Video",forMode:"view"},{forType:"wix:Video",forMode:"view"}]),e.registerProxy("VideoSelector",this.imports.VideoSelectorProxy,"wix:Video",[{forType:"Video",forMode:"edit"},{forType:"wix:Video",forMode:"edit"}]),e.registerProxy("VideoThumb",this.imports.VideoThumbProxy,""),e.registerProxy("ImageSelector",this.imports.ImageSelectorProxy,"wix:Image",[{forType:"wix:Image",forMode:"edit"}]),e.registerProxy("ImageInput",this.imports.ImageInputProxy,""),e.registerProxy("VerticalList",this.imports.VerticalListProxy,"Array",[{forType:"Array",forMode:"view"},{forType:"Array",forMode:"edit"}]),e.registerProxy("FlowList",this.imports.FlowListProxy,""),e.registerProxy("MultiColumn",this.imports.MultiColumnListProxy,""),e.registerProxy("VerticalListEditor",this.imports.VerticalListEditorProxy,""),e.registerProxy("DraggableListItem",this.imports.DraggableListItemProxy,""),e.registerProxy("Gallery",this.imports.GalleryProxy,""),e.registerProxy("Box",this.imports.BoxLayoutProxy,""),e.registerProxy("VBox",this.imports.BoxLayoutProxy,""),e.registerProxy("HBox",this.imports.BoxLayoutProxy,""),e.registerProxy("Field",this.imports.FieldProxy,""),e.registerProxy("FieldBox",this.imports.FieldBoxProxy,""),e.registerProxy("TextField",this.imports.TextFieldProxy,""),e.registerProxy("DataEditField",this.imports.DataEditFieldProxy,""),e.registerProxy("Stack",this.imports.StackLayoutProxy,""),e.registerProxy("Css",this.imports.CssLayoutProxy,""),e.registerProxy("VSpacer",this.imports.SpacerProxy,""),e.registerProxy("HSpacer",this.imports.SpacerProxy,""),e.registerProxy("InlineSpacer",this.imports.SpacerProxy,""),e.registerProxy("HorizontalLine",this.imports.HorizontalLineProxy,""),e.registerProxy("VerticalLine",this.imports.VerticalLineProxy,""),e.registerProxy("Switch",this.imports.SwitchProxy,""),e.registerProxy("SwitchBox",this.imports.SwitchBoxProxy,""),e.registerProxy("OptionalArea",this.imports.OptionalAreaProxy,""),e.registerProxy("SuperFlow",this.imports.SuperFlowProxy,""),e.registerProxy("Button",this.imports.ButtonProxy,""),e.registerProxy("Button2",this.imports.Button2Proxy,""),e.registerProxy("Table",this.imports.TableProxy,""),e.registerProxy("Expander",this.imports.ExpanderProxy,""),e.registerProxy("Deck",this.imports.DeckProxy,""),e.registerProxy("TabMenu",this.imports.TabMenuProxy,""),e.registerProxy("Icon",this.imports.IconProxy,""),e.registerProxy("StringArrayInput",this.imports.StringArrayInputProxy,""),e.registerProxy("Toggle",this.imports.ToggleProxy,""),e.registerProxy("AudioPlayer",this.imports.AudioPlayerProxy,""),e.registerProxy("AudioInput",this.imports.AudioInputProxy,""),e.registerProxy("Link",this.imports.LinkProxy,"wix:LinkBase",[{forType:"wix:LinkBase",forMode:"view"}]),e.registerProxy("LinkSelector",this.imports.LinkSelectorProxy,"wix:LinkBase",[{forType:"wix:LinkBase",forMode:"edit"}]),e.registerProxy("OptionsList",this.imports.OptionsListProxy,"OptionsList",[{forType:"OptionsList",forMode:"view"}]),e.registerProxy("SelectOptionsList",this.imports.SelectOptionsListProxy,"OptionsList",[{forType:"OptionsList",forMode:"view"}]),e.registerProxy("OptionsListInput",this.imports.OptionListInputProxy,"OptionsList",[{forType:"ComboOptionsList",forMode:"edit"},{forType:"OptionsList",forMode:"edit"}]),e.registerProxy("ComboBox",this.imports.ComboBoxProxy,"ComboOptionsList",[{forType:"ComboOptionsList",forMode:"view"}]),e.registerProxy("RadioGroup",this.imports.RadioGroupProxy,"ComboOptionsList",[{forType:"ComboOptionsList",forMode:"view"}]),e.registerProxy("CheckBoxGroup",this.imports.CheckBoxGroupProxy,"MultiOptionsList",[{forType:"MultiOptionsList",forMode:"view"}]),e.registerProxy("TextArea",this.imports.TextAreaProxy,"String"),e.registerProxy("Area",this.imports.AreaProxy),e.registerProxy("SliderGallery",this.imports.SliderGalleryProxy,"Array",[{forType:"Array<wix:Image>",forMode:"view"}]),e.registerProxy("Container",this.imports.ContainerProxy,""),e.registerProxy("ZoomLink",this.imports.ZoomLinkProxy,""),e.registerProxy("AppLink",this.imports.AppLinkProxy,""),e.registerProxy("ZoomLayout",this.imports.ZoomLayoutProxy,""),e.registerProxy("FixedRatioLayout",this.imports.FixedRatioLayoutProxy,""),e.registerProxy("GoogleMap",this.imports.GoogleMapProxy,"wix:Location"),e.registerProxy("LocationSelector",this.imports.LocationSelectorProxy,"wix:Location"),e.registerProxy("Empty",this.imports.EmptyProxy,"",[]),e.registerProxy("TagInput",this.imports.TagInputProxy,""),e.registerProxy("DragAndDropVList",this.imports.DragAndDropVListProxy,""),e.registerProxy("List2",this.imports.ListProxy2,"Array",[{forType:"Array",forMode:"view"},{forType:"Array",forMode:"edit"}]),e.registerProxy("UnstyledLabel",this.imports.UnstyledLabelProxy,"String"),e.registerProxy("TooltipIcon",this.imports.TooltipIconProxy,""),e.registerProxy("Help",this.imports.HelpProxy,""),e.registerProxy("IFrame",this.imports.IFrameProxy,"String"),e.registerProxy("ImageButton",this.imports.ImageButtonProxy,"")}})}),define.experiment.Class("wixapps.integration.proxies.RichTextEditorInlineProxy.AppBuilderListSettings2.New",function(e){e.methods({_onComponentWixified:function(){var e=this._def.getChildValue("height"),t=this._element.getWidth();this._migrateHtml();var i=this._data.getChildValue("text");this._componentLogic.addEvent(Constants.ComponentEvents.READY,function(){this._componentLogic.startEditing(i,e,t,this._stylesMap)}.bind(this)),this._componentLogic.addEvent("endEditing",this._onEditingCompleted),this.resources.W.Commands.registerCommandAndListener("WAppsEditorCommands.FinalizeDataItemEditing",this,this._onFinalizeDataItemEditing)},_onFinalizeDataItemEditing:function(){this.resources.W.Commands.executeCommand("WEditorCommands.StopEditingText"),this.resources.W.Commands.unregisterCommand("WAppsEditorCommands.FinalizeDataItemEditing")},dispose:function(){this._componentLogic.removeEvent("endEditing",this._onEditingCompleted),this.parent()}})}),define.experiment.Class("wixapps.integration.proxies.RichTextEditorInlineProxy.AppsBuilderPage.New",function(e,t){var i=e;i.methods({_onComponentWixified:function(){var e=this._def.getChildValue("height"),t=this._element.getWidth();this._migrateHtml();var i=this._data.getChildValue("text");this._componentLogic.addEvent(Constants.ComponentEvents.READY,function(){this._componentLogic.startEditing(i,e,t,this._stylesMap)}.bind(this)),this._componentLogic.addEvent("endEditing",this._onEditingCompleted),this.resources.W.Commands.registerCommandAndListener("WAppsEditorCommands.FinalizeDataItemEditing",this,this._onFinalizeDataItemEditing)},_onFinalizeDataItemEditing:function(){this.resources.W.Commands.executeCommand("WEditorCommands.StopEditingText"),this.resources.W.Commands.unregisterCommand("WAppsEditorCommands.FinalizeDataItemEditing")},dispose:function(){this._componentLogic.removeEvent("endEditing",this._onEditingCompleted),this.parent()}})}),define.experiment.Class("wixapps.integration.proxies.RichTextEditorProxy.RichText2.New",function(e,t){var i=e;i.binds(["_linkIdGenerator","_onPreviewClicked","_onEditingCompleted","_onCKDataChanged","_onScrollContainerScroll"]),i.methods({_createRTEditorComponent:function(){var e=W.Data;W.Editor&&(e=W.Preview.getPreviewManagers().Data),this._updateLinkDataItems(e);var t=new Element("DIV");t.set("comp","wysiwyg.editor.components.richtext.WRichTextEditor"),t.set("skin","wixapps.integration.skins.editor.WRichTextEditorAppBuilderSkin"),t.set("pos",""),this._editorElement=t,this._editorElement.addEvent(Constants.ComponentEvents.WIXIFIED,function(){}.bind(this)),this._editorElement.addEvent(Constants.ComponentEvents.READY,function(){this._editorLogic=t.getLogic(),this._editorLogic.addEvent("richTextEditorReady",function(){this._componentLogic.getSkinPart("richTextContainer").setStyle("visibility","hidden")}.bind(this)),this._scrollContainer=this._findFirstScrollerContainer(),this._notifyEditorReady()}.bind(this)),this._componentLogic.getSkinPart("frame").grab(t);var i={isFixedHeight:!0,isPersistent:!1,generateLinkIdFunc:this._linkIdGenerator,getDataOnCKChange:!0,addTextBackground:!0};this._editorElement.wixify(i,this._editorData)},_onPreviewClicked:function(){this._getEditorComponent(function(e){var t=this._element.getWidth(),i=this._def.getChildValue("height"),n=this._data.getChildValue("text");e.addEvent("endEditing",this._onEditingCompleted),e.addEvent("ckDataChanged",this._onCKDataChanged),this.resources.W.Commands.registerCommand("WAppsEditor2Commands.BeforeListItemSelectionMadafaka",!0),this.resources.W.Commands.registerCommandListenerByName("WAppsEditor2Commands.BeforeListItemSelectionMadafaka",this,this._onBeforeDataItemChanged),this._scrollContainer&&(this._scrollIntoView(),this._scrollContainer.addEvent("scroll",this._onScrollContainerScroll)),this.resources.W.Commands.executeCommand("WAppsEditor2Commands.BeforeStartEditingText"),e.startEditing(n,i,t,this._stylesMap)}.bind(this))},_onScrollContainerScroll:function(){this._getEditorComponent(function(e){var t=e.getViewNode().getPosition(),i=e.getSkinPart("toolBar").getViewNode();i.setStyle("top",t.y-i.getHeight()-10+"px")}.bind(this))},_scrollIntoView:function(){var e=this._scrollContainer,t=this._element.getPosition(e),i=this._element.getHeight()+t.y,n=e.getHeight();0>t.y?e.scrollTop=e.scrollTop+t.y:i>n&&(e.scrollTop=e.scrollTop+Math.abs(i-n))},_findFirstScrollerContainer:function(){for(var e=this._element;e.getParent();)if(e=e.getParent(),e.scrollHeight>e.getHeight())return e;return null},_onEditingCompleted:function(e){var t=this._data.getValue();t.text=e,t.links=this._getLinksDataFromHtml(t.text),this._data.setValue(t),this._componentLogic.getSkinPart("richTextContainer").setStyle("visibility","inherit"),this._editorLogic.removeEvent("endEditing"),this._editorLogic.removeEvent("ckDataChanged"),this._scrollContainer&&this._scrollContainer.removeEvent("scroll",this._onScrollContainerScroll);var i=this.resources.W.Commands.getCommand("WAppsEditor2Commands.BeforeListItemSelectionMadafaka");i&&i.unregisterListener(this)},_onCKDataChanged:function(e){var t=this._data.getValue();t.text!==e&&(t.text=e,t.links=this._getLinksDataFromHtml(t.text),this._data.setValue(t))}})}),define.experiment.Class("wixapps.integration.proxies.TextAreaProxy.MediaZoomDispose.New",function(e){e.methods({dispose:function(){this._disposed||(this._data.removeEvent(Constants.DataItemEvents.VALIDATION_PERFORMED,this._onValidation),this.parent())}})}),define.experiment.Class("wixapps.integration.proxies.TextInputProxy.MediaZoomDispose.New",function(e){e.methods({dispose:function(){this._disposed||(this._data.removeEvent(Constants.DataItemEvents.VALIDATION_PERFORMED,this._onValidation),this.parent())}})}),define.experiment.Class("wixapps.integration.proxies.TimeSelectorProxy.MediaZoomDispose.New",function(e){e.methods({dispose:function(){this._disposed||(this._data.removeEvent(Constants.DataItemEvents.VALIDATION_PERFORMED,this._onValidation),this.parent())
}})}),define.experiment.Class("wixapps.integration.proxies.ToggleProxy.WixAppsContentResize.New",function(e){e.methods({_onComponentWixified:function(){this._componentLogic.addEvent("wix:toggle",function(e){this.fireEvent("wix:togglegroup",{state:e.state,toggleGroup:this.getToggleGroup()}),this._viewContext.getEnvironment().getEventsDispatcher().fireEvent(Constants.WixAppEvents.APP_PART_RESIZE)}.bind(this)),this.addEventFilteredByScope(this.getToggleScope(),"wix:togglegroup",this._handlePeerToggleEvent)}})}),define.experiment.Class("wixapps.integration.proxies.VideoProxy.EcomExp1.New",function(e,t){var i=e;i.methods({createComponent:function(){var e=this._createRawData(this._data.getValue()),t={type:"Video"};return this._createWixComponent("wixapps.integration.components.Video",e,void 0,t)}})}),define.experiment.Class("wixapps.integration.proxies.WIntegrationTrait.AppBuilderListSettings2.New",function(e){e.methods({dispose:function(){this._disposed||(this._isWixificationPending=!1,this._dataItem&&this._dataItem.removeEvent(Constants.DataEvents.DATA_CHANGED,this._onComponentDataChanged),this._children&&this._children.forEach(function(e){this._onBeforeChildDisposed&&this._onBeforeChildDisposed(e),e.dispose()}),this._deactivateResizeMechanism&&this._deactivateResizeMechanism(this._element),this._styleObj&&(this._styleObj.removeEvent(Constants.StyleEvents.PROPERTY_CHANGED,this._onStyleChangeInternal),this._styleObj.removeEvent(Constants.StyleEvents.SKIN_CHANGED,this._onSkinChange),this._styleObj=null),this._nativeEventHandlers.forEach(function(e){this._element.removeEvent(e.type,e.handler)}.bind(this)),this._nativeEventHandlers=null,this._element.removeEvent("mouseover",this._onHover),this._element.removeEvent("mouseout",this._onHoverOut),this._componentLogic?this._componentLogic.dispose():this._element.destroy(),this._dataItem=null,this._componentLogic=null,this._element=null,this.parent())}})}),define.experiment.Class("wixapps.integration.proxies.WIntegrationTrait.NBC_WCD.New",function(e){var t=e;t.methods({_onWixComponentWixifiedInternal:function(e){this._disposed||(this._componentLogic=e,this._updateComponentState(),this._onComponentWixified(),this._registerStyleChangeHandler(),this._applyAfterWixifiedActions.forEach(function(e){e.apply(this)}.bind(this)),this._applyAfterWixifiedActions=[],this._isWixificationPending=!1,this._applyAccumulatedPropertyChanges())}})}),define.experiment.Class("wixapps.integration.proxies.WIntegrationTrait.NBC_WCD.New",function(e){var t=e;t.methods({_onWixComponentWixifiedInternal:function(e){this._disposed||(this._componentLogic=e,this._updateComponentState(),this._onComponentWixified(),this._registerStyleChangeHandler(),this._applyAfterWixifiedActions.forEach(function(e){e.apply(this)}.bind(this)),this._applyAfterWixifiedActions=[],this._componentLogic.addEvent("autoSizeChange",this._onAutoSizeChange))},_onWixComponentReadyInternal:function(e){this._isWixificationPending=!1,this._applyAccumulatedPropertyChanges(),this._defferedDataChangeEvent&&this._onDataChanged(this._defferedDataChangeEvent),this._onWixComponentReadyInternalNotifyLifecycle(e)}})}),define.experiment.Class("wixapps.integration.proxies.WIntegrationTrait.RenderPerf.New",function(e,t){var i=e,n=t;i.methods({_preventReflowCssClass:function(){return"wixAppsInRenderPreventReflow"},_onWixComponentReadyInternalNotifyLifecycle:n.before(function(){this.resetResizingCache&&this.resetResizingCache()}),_createElement:n.around(function(e){var t=e(),i=this._preventReflowCssClass();return i&&this._lifecycleManager&&t.addClass(i),i&&this._lifecycleManager&&this._lifecycleManager.performAction(function(){t.removeClass(i)}.bind(this),this._lifecycleManager.ExecutionOrder.Early),t})})}),define.experiment.newDataSchema("AppVars.WixAppsApplicationData.New",function(){return{vars:"object"}}),define.experiment.skin("wixapps.integration.skins.ClippedParagraphSkin.RichTextPresets.New",function(e){var t=e;t.css([" {word-wrap: break-word;}"," ul { list-style-type: disc; padding-left: 1.3em; margin-left: 0.5em; line-height: normal; letter-spacing: normal;}"," ol {  list-style-type: decimal;padding-left: 1.3em; margin-left: 0.5em; line-height: normal; letter-spacing: normal;}",' ul[dir="rtl"] {padding-right: 1.3em; margin-right: 0.5em;}',' ol[dir="rtl"] {padding-right: 1.3em; margin-right: 0.5em;}'," ul ul {list-style-type: circle; line-height: normal;}"," ol ul {list-style-type: circle; line-height: normal;}"," ol ol ul {list-style-type: square; line-height: normal;}"," ol ul ul {list-style-type: square; line-height: normal;}"," ul ol ul {list-style-type: square; line-height: normal;}"," ul ul ul {list-style-type: square; line-height: normal;}"," li{ color: inherit; font-size: inherit; font-family: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; letter-spacing: normal;}"," p {margin: 0; line-height: normal; letter-spacing: normal;}"," h1 {margin: 0;  line-height: normal; letter-spacing: normal;}"," h2 {margin: 0; line-height: normal; letter-spacing: normal;}"," h3 {margin: 0;  line-height: normal; letter-spacing: normal;}"," h4 {margin: 0; line-height: normal; letter-spacing: normal;}"," h5 {margin: 0;  line-height: normal; letter-spacing: normal;}"," h6 {margin: 0;  line-height: normal; letter-spacing: normal;}"," a { color: inherit}"])}),define.experiment.skin("wixapps.integration.skins.WixAppsButtonSkin.NBC_SiteButton.New",function(e){var t=e;t.inherits("core.managers.skin.BaseSkin2")}),define.experiment.skin("wixapps.integration.skins.dialogs.AppBuilderDataPanelSkin.AppBuilderListSettings2.New",function(e,t){e.html('<div skinPart="topBar"><strong skinPart="panelLabel"></strong><div skinPart="titleContent"></div><div skinPart="help" class="help"><span>&nbsp;</span></div><div skinPart="close"><span>&nbsp;</span></div></div><div skinPart="panelDescription"></div><div skinPart="inlineContent"></div>'),e.css(t.merge(["%topBar% {width:100%; height:50px; [$topBorderRadius]; border-bottom:1px solid #dddddd; cursor:move; position:relative}","%close% {position:absolute; top:1px; right:0; height:50px; width:34px; border-left:1px solid #ccc; cursor:pointer; [$closeBorderRadius]}","%.help% {width:35px; height:50px; position:absolute; right:35px; top:1px; cursor:default;}","%.help% span {background:url([webThemeDir]icons/help_sprite.png) no-repeat 0 1px; width:19px; height:18px; position:absolute; right:8px; top:15px; cursor:pointer}","%inlineContent% { top:10px; padding:0; }",' .font_6 { font: normal bold normal 16px/1.4em "Helvetica Neue Medium", sans-serif; color: #333; }',' .font_7 { font: normal normal normal 13px/1.4em "Helvetica Neue Medium", sans-serif; color: #333; }']))}),define.experiment.skin("wixapps.integration.skins.dialogs.AppBuilderDataPanelSkin.AppBuilderPage.New",function(e,t){var i=e;i.html('<div skinPart="topBar"><strong skinPart="panelLabel"></strong><div skinPart="titleContent"></div><div skinPart="help" class="help"><span>&nbsp;</span></div><div skinPart="close"><span>&nbsp;</span></div></div><div skinPart="panelDescription"></div><div skinPart="inlineContent"></div>'),i.css(["{background:#f7f7f7; width:[panelWidth]; [$panelBorderRadius] [noShadow]}","[state=expanded] { [$contentAreaShadow] }","%topBar% {width:100%; height:50px; [$topBorderRadius]; border-bottom:1px solid #dddddd; cursor:move; position:relative}","%panelLabel% {display:none;}","%panelDescription% {display:none;}","%close% {position:absolute; top:1px; right:0; height:50px; width:34px; border-left:1px solid #ccc; cursor:pointer; [$closeBorderRadius]}",'%close% span {position:absolute; left:8px; top:14px; width:15px; height:15px; display:block; background:url("[webThemeDir]icons/top-bar-icons.png") 0 0 no-repeat}',"%close%:hover span {background-position:0 -140px}","%.help% {width:35px; height:50px; position:absolute; right:35px; top:1px; cursor:default;}","%.help% span {background:url([webThemeDir]icons/help_sprite.png) no-repeat 0 1px; width:19px; height:18px; position:absolute; right:8px; top:15px; cursor:pointer}","%.help% span:hover { background-position: 0 -16px}","%.help% span:active { background-position: 0 -33px}","%inlineContent% { top:10px; padding:0; }",' .font_6 { font: normal bold normal 16px/1.4em "Helvetica Neue Medium", sans-serif; color: #333; }',' .font_7 { font: normal normal normal 13px/1.4em "Helvetica Neue Medium", sans-serif; color: #333; }'])}),define.experiment.skin("wixapps.integration.skins.dialogs.ChooseTemplateDialogWindowSkin.AppBuilderPage.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.skinParams([{id:"webThemeDir",type:Constants.SkinParamTypes.URL,defaultTheme:"WEB_THEME_DIRECTORY"},{id:"$blockBg",type:Constants.SkinParamTypes.BG_COLOR,defaultValue:"0,0,0,0.5"},{id:"$tabRadius",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"5px 5px 0 0"},{id:"$closeRadius",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"0px 5px 0 0"},{id:"$borderRadius",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"5px 5px 5px 5px"},{id:"$borderRadiusBottom",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"0px 0px 5px 5px"},{id:"$contentAreaShadow",type:Constants.SkinParamTypes.BOX_SHADOW,defaultValue:"-3px 0 50px #000"},{id:"titleFontSize",type:Constants.SkinParamTypes.OTHER,defaultValue:"16px"},{id:"descriptionFontSize",type:Constants.SkinParamTypes.OTHER,defaultValue:"13px"}]),t.html('<div skinPart="blockLayer"></div><div skinPart="dialogBox"><div class="dialogLayout"><div skinPart="dragArea"></div><strong skinPart="dialogTitle"></strong><div class="dialogDescriptionWrapper"><div skinPart="dialogDescription"></div><div skinPart="helplet"></div></div><div skinPart="xButton"><div skinPart="x"></div></div><div class="dialogToolbar clearfix" skinPart="dialogToolbar"><div class="tabs" skinPart="tabs"></div></div><div class="dialogContent clearfix" skinPart="innerDialog"></div><div skinPart="buttonContainer"><div skinPart="cancelContainer" class="leftButton"></div><div skinPart="okContainer" class="rightButton"></div></div></div></div>'),t.css(["{position:absolute;width:850px;height:100%;}","%.dialogLayout% {background:#fdfdfd; padding-bottom: 33px; [$borderRadius] [$contentAreaShadow]}","[state~=modal]      %blockLayer% {[$blockBg]; display:block; position:fixed; top:0; bottom:0; left:0; right:0; visibility:visible; zoom:1; }","[state~=nonModal]   %blockLayer% {display:none}","[state~=semiModal]  %blockLayer% {background: url([webThemeDir]transparent.gif) repeat; display:block; position:fixed; top:0; bottom:0; left:0; right:0; visibility:visible; zoom:1;}","[state~=transparentModal]  %blockLayer% {background: url([webThemeDir]transparent.gif) repeat; display:block; position:fixed; top:0; bottom:0; left:0; right:0; visibility:visible; zoom:1;}","%dragArea%{position:absolute; left:0px; top:0px; height:34px; width:85%; cursor:move; background: url([webThemeDir]transparent.gif) repeat;}","[state~=modal] %dragArea%{cursor: default}","%dialogBox% {position:relative; zoom:0; top:0px; left:0px;}","%xButton% {position:absolute; top:0; right:0; width:34px; height:34px; cursor:pointer; border-left:1px solid #ccc; [$closeRadius]}","%xButton%:hover {background:#ddd;}","%xButton%:hover %x% {background-position:50% -140px;}","%x% {background:url([webThemeDir]icons/top-bar-icons.png) 50% 0; width:16px; height:16px; position:absolute; top: 50%; left: 50%; margin: -8px 0 0 -8px; }","%xButton%[disabled]:hover{cursor: default; background:none;}","%xButton%[disabled] %x%{cursor: default; background-position:50% 0; opacity: .5;}","%buttonContainer% {clear:both; overflow:hidden; padding:15px 10px 5px; background:#fdfdfd; [$borderRadiusBottom]}","%buttonContainer% .leftButton {float:left;}","%buttonContainer% .rightButton {float:right;}","%buttonContainer% .rightButton >div {float:right;margin-left:5px;}","%dialogTitle% {font-size:[titleFontSize]; display:block; padding:0 20px; border-bottom:1px solid #ccc; line-height:34px; }","%.dialogDescriptionWrapper% {border-top:1px solid #fff; padding:20px 45px; font-size: [descriptionFontSize]}","%dialogDescription% {margin-bottom:4px; color: #373737}","%helplet% {margin-top:10px; cursor:pointer; color:#09f; font-size:90%; }","%helplet%:hover {text-decoration:underline}","[state~=topHelpLocation] %helplet%{position:absolute;right:32px;top:12px;}","%.dialogToolbar% .tabs {top:1px; left:1px; height:45px; margin:0 10px 0; position:relative}","%.dialogToolbar% .tab {font-size:12px; padding:15px 25px; margin-top:1px; margin-right:3px; float:left; position:relative; cursor:pointer; border:1px solid #ccc; border-bottom:none; [$tabRadius]}","%.dialogToolbar% .selectedTab {background-color:#fdfdfd; border-bottom:none;position:relative;top:1px; font-weight:bold;}","%.dialogToolbar% .controlBtn {float:right;margin-top:8px; margin-right:10px}","%innerDialog% {margin:0; overflow:hidden;}","%helpButton% {position:absolute; top:0; right:35px; width:35px; height:35px; cursor:pointer;}","%helpButton%:hover {background:#ddd;}","%helpButton% span {background:url([webThemeDir]icons/help_sprite.png) no-repeat 0 1px; width:19px; height:18px; position:absolute; right:8px; top:10px; cursor:pointer}","%helpButton% span:hover { background-position: 0 -16px}","%helpButton% span:active { background-position: 0 -33px}","%innerDialog% .tabs-border-bottom {position: absolute; height:0; bottom: 0; left: 0; right:0; border-bottom: 1px solid #c2c2c2;}","%innerDialog% .tabs { position:relative; top:0px; left:0px; }","%innerDialog% .tab { cursor:pointer;  padding: 0px 10px; margin:0 0 0 6px; border:1px solid #c2c2c2; position:relative; border-radius:5px 5px 0 0; }","%innerDialog% .tab.selected { top: 1px; border-bottom:2px solid #ffffff; background-color:#ffffff; }",'%innerDialog% .tab.not-selected { top:2px; border-bottom:1px solid #cecece; background: #ededed; background: -moz-linear-gradient(top, #fefefe 0%, #ededed 100%); background: -webkit-gradient(linear, left top, left bottom, color-stop(0%,#fefefe), color-stop(100%,#ededed)); background: -webkit-linear-gradient(top, #fefefe 0%,#ededed 100%); background: -o-linear-gradient(top, #fefefe 0%,#ededed 100%); background: -ms-linear-gradient(top, #fefefe 0%,#ededed 100%); background: linear-gradient(to bottom, #fefefe 0%,#ededed 100%); filter: progid:DXImageTransform.Microsoft.gradient( startColorstr="#fefefe", endColorstr="#ededed",GradientType=0)}'])}),define.experiment.skin("wixapps.integration.skins.dialogs.NoTitleDialogWindowSkin.AppBuilderListSettings2.New",function(e,t){e.css(t.merge(["%.dialogLayout% {background:#fdfdfd; [$borderRadius] [$contentAreaShadow]}","[state~=semiModal] %dragArea% {display:none}"]))}),define.experiment.skin("wixapps.integration.skins.editor.DraggableListItemSkin.AppBuilderListSettings2.New",function(e,t){e.css(t.merge(["%inlineContent% { position:absolute; top:0; bottom:0; left:44px; right:5px; overflow:hidden; }"]))}),define.experiment.newSkin("wixapps.integration.skins.editor.EditorButtonBlueBackSkin.AppBuilderListSettings2.New",function(e){e.inherits("mobile.core.skins.BaseSkin"),e.skinParams([{id:"webThemeDir",type:"themeUrl",defaultTheme:"WEB_THEME_DIRECTORY"},{id:"$borderRadius",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"4px"},{id:"shadowColor",type:Constants.SkinParamTypes.COLOR_ALPHA,defaultValue:"0,0,0,.2"},{id:"shadowInsetColor",type:Constants.SkinParamTypes.COLOR_ALPHA,defaultValue:"0,0,0,.7"},{id:"shadowInsetColorOver",type:Constants.SkinParamTypes.COLOR_ALPHA,defaultValue:"68,175,233,.7"},{id:"borderColor",type:Constants.SkinParamTypes.COLOR,defaultValue:"#5b8fa7"},{id:"borderColorOver",type:Constants.SkinParamTypes.COLOR,defaultValue:"#237aa7"},{id:"bgColor",type:Constants.SkinParamTypes.COLOR,defaultValue:"#2aa7ea"},{id:"bgColorOver",type:Constants.SkinParamTypes.COLOR,defaultValue:"#179ce1"},{id:"labelColor",type:Constants.SkinParamTypes.COLOR,defaultValue:"#ffffff"},{id:"borderGrayColor",type:Constants.SkinParamTypes.COLOR,defaultValue:"#c4c4c4"},{id:"borderGrayColorOver",type:Constants.SkinParamTypes.COLOR,defaultValue:"#89a4af"},{id:"bgGrayColor",type:Constants.SkinParamTypes.COLOR,defaultValue:"#f9fafc"},{id:"bgGrayColorOver",type:Constants.SkinParamTypes.COLOR,defaultValue:"#f2f3f5"},{id:"labelGrayColor",type:Constants.SkinParamTypes.COLOR,defaultValue:"#24a0c4"},{id:"borderDisabledColor",type:Constants.SkinParamTypes.COLOR,defaultValue:"#d5d5d5"},{id:"bgDisabledColor",type:Constants.SkinParamTypes.COLOR,defaultValue:"#f9fafc"},{id:"labelDisabledColor",type:Constants.SkinParamTypes.COLOR,defaultValue:"#c4c4c4"}]),e.html('<a skinpart="link"><div class="arrow"></div><div skinpart="label"></div></a>'),e.css(["{ cursor:pointer;}","{ border: 1px solid [borderColor]; [$borderRadius]; background: [bgColor] url([webThemeDir]button/button-gradient.png) repeat-x 0 50%; position:relative; text-align: center; cursor: pointer}","[state~=over] {border: 1px solid [borderColorOver]; background: [bgColorOver] none; box-shadow: 0 2px 3px 0 [shadowColor], 0 1px 2px 0 [shadowInsetColorOver] inset}",'[state~="pressed"] {background: [bgColor] none; border-color: transparent; box-shadow: 0 1px 3px 0 [shadowInsetColor] inset}',"%label% {color: [labelColor]; height:1.8em; line-height:1.8em; }","%.arrow% {position:absolute; width:20px; height:20px; top: 50%; left:0; margin-top: -10px; background: url([webThemeDir]icons/left_arrows.png) no-repeat 0 -20px; }","[state~=grayed] {border-color: [borderGrayColor]; background-color: [bgGrayColor] }","[state~=grayed][state~=over] {border-color: [borderGrayColorOver]; background-color: [bgGrayColorOver]; box-shadow: 0 2px 3px 0 [shadowColor], 0 1px 2px 0 #ffffff inset}","[state~=grayed][state~=pressed] {border-color: transparent; background-color: [bgGrayColor]}","[state~=grayed] %label% {color: [labelGrayColor];}","[disabled] {border-color: [borderDisabledColor]; background-color: [bgDisabledColor] }","[disabled] %label% {color: [labelDisabledColor];}"])}),define.experiment.skin("wixapps.integration.skins.editor.HorizontalArrowButtonSkin.AppBuilderListSettings2.New",function(e,t){e.css(t.merge(["{  cursor:pointer; width:34px !important; height:41px; text-indent:-9999px;  background: url([webThemeDir]lists/horizontal_arrowbuttons_sprite.png) center -46px no-repeat; }"]))}),define.experiment.skin("wixapps.integration.skins.editor.ImageSelectorSkin.NBC_WPhoto.New",function(e){var t=e;t.inherits("core.managers.skin.BaseSkin2"),t.compParts({img:{skin:"skins.core.ImageNewSkin"}})}),define.experiment.skin("wixapps.integration.skins.editor.RichTextInlineToolBarSkin.RichText2.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.html('<div class="container"><ul><li class="part drop fnt style" skinPart="formatBlock" skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop fnt font" skinPart="fontFamily"  skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop fnt fontsize" skinPart="fontSize"    skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="divider"></li><li class="part cols color fc" skinPart="foreColor"   skin="wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin"></li><li class="divider"></li><li class="part btn" skinPart="bold"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="italic"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="underline" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="removeFormat" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><ul><li class="part drop size sp" skinPart="letterSpacing" skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop size hg" skinPart="lineHeight"    skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="outdent"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="indent"       skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="numberedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bulletedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="bidiltr"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bidirtl"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part cols justify" skinPart="justify"       skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="wixLink"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="wixUnlink"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><div class="close" skinpart="closeButton"></div><div class="drag" skinPart="dragArea"></div></div>')}),define.experiment.skin("wixapps.integration.skins.editor.RichTextInlineToolBarSkin.RichTextToolbar.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.compParts({formatBlock:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddStyle"},fontFamily:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddFont"},justify:{skin:"wysiwyg.editor.skins.richtext.ToolBarIconsDropDownSkin",styleGroup:"toolbarBtn"},fontSize:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddFontSize"},letterSpacing:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddSize"},lineHeight:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddSize"},bold:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},italic:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},underline:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},removeFormat:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},outdent:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},indent:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},numberedlist:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bulletedlist:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bidiltr:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bidirtl:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},wixLink:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},wixUnlink:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},foreColor:{skin:"wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin",styleGroup:"toolbarBtn"},backColor:{skin:"wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin",styleGroup:"toolbarBackgroundBtn"}}),t.html('<div class="container"><ul><li class="part drop style" skinPart="formatBlock" ></li><li class="part drop font" skinPart="fontFamily"  ></li><li class="part drop" skinPart="fontSize" ></li><li class="divider"></li><li class="part cols" skinPart="foreColor"  ></li><li class="part cols" skinPart="backColor"></li><li class="divider"></li><li class="part" skinPart="bold"></li><li class="part" skinPart="italic"></li><li class="part" skinPart="underline" ></li><li class="divider"></li><li class="part cols justify" skinPart="justify"></li><li class="part" skinPart="removeFormat"></li></ul><ul><li class="part drop size spacing" skinPart="letterSpacing"></li><li class="part drop size lines" skinPart="lineHeight"></li><li class="divider"></li><li class="part" skinPart="outdent"></li><li class="part" skinPart="indent"></li><li class="divider"></li><li class="part" skinPart="numberedlist" ></li><li class="part" skinPart="bulletedlist" ></li><li class="divider"></li><li class="part" skinPart="bidiltr" ></li><li class="part" skinPart="bidirtl" ></li><li class="divider"></li><li class="part" skinPart="wixLink"  ></li><li class="part" skinPart="wixUnlink"></li></ul><div class="close" skinpart="closeButton"></div><div class="drag" skinPart="dragArea"></div></div>'),t.skinParams([{id:"rd",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"3px"},{id:"shd",type:Constants.SkinParamTypes.BOX_SHADOW,defaultValue:"0 3px 10px rgba(0,0,0,0.35)"},{id:"tdr",type:Constants.SkinParamTypes.URL,defaultTheme:"WEB_THEME_DIRECTORY"}]),t.css(["%.container% {display:inline-block; font-size:11px; position:relative; color:#353535; background:#fff; [shd][rd]}",'%.drag%  {display:none; left :2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/dragdots.png")  no-repeat 50% 50%; [rd] cursor:move;}','%.close% {display:none; right:2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/xclose.png") no-repeat 50% 4px; [rd]; cursor: pointer; }','%.close%:after { position:absolute; content:""; left:-2px; top:1px; bottom:1px; width:2px; background:url("[tdr]richtext/bigvertdevider.png") no-repeat 50% 50%; }',"ul {position:relative; padding:2px; margin:0px;}",'li.divider { background:url("[tdr]richtext/vertdevider.png") no-repeat 50% 50%; position:relative; height:22px; width:2px; margin:0 2px; display:inline-block; vertical-align:middle;}',"li.part {border:1px solid transparent; [rd] position:relative; line-height:22px; height:22px; min-width:22px; margin:1px; display:inline-block; vertical-align:middle; }",'li[disabled="disabled"] { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }','li[state~="disabled"]   { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }',"%formatBlock% {width:80px;}","%fontFamily% {width:100px;}","%fontSize% {width:50px;}","%letterSpacing% {width:106px;}","%lineHeight% {width:106px;}","li.cols {width:40px;}",'li.size:before {position:absolute; content:""; top:0px; left:0px; bottom:0px; width:24px; background:#f0f0f0 url("[tdr]richtext/icons.png") no-repeat; border:1px solid #ddd; line-height:22px; border-radius:3px 0 0 3px; pointer-events:none;}',"li.spacing:before {background-position:2px -220px}","li.lines:before {background-position:2px -240px}"])}),define.experiment.skin("wixapps.integration.skins.editor.WRichTextEditorAppBuilderSkin.RichTextToolbar.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.compParts({toolBar:{skin:"wixapps.integration.skins.editor.WixAppsToolBarSkin",styleId:"RTAppBuilderToolBar"}}),t.html('<textarea skinPart="ckArea" ></textarea><div skinPart="toolBar"></div>'),t.css(["{margin:0px; cursor:default; position:absolute; top:0px; bottom:0px; left:0px; right:0px}","%toolBar% {position:fixed; top:350px; left:500px;}"])}),define.experiment.skin("wixapps.integration.skins.editor.WRichTextInlineEditorSkin.RichTextToolbar.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.compParts({toolBar:{skin:"wixapps.integration.skins.editor.RichTextInlineToolBarSkin",styleId:"RTInlineAppsToolBar"}}),t.html('<div skinPart="toolBar"></div><div class="bg"><textarea skinPart="ckArea" ></textarea></div>'),t.css(["{margin:5px; cursor:default;}"," .bg { background-color:#fff; }","%toolBar% { padding-bottom: 5px; }"])}),define.experiment.skin("wixapps.integration.skins.editor.WixAppsToolBarSkin.RichText2.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.html('<div class="container"><ul><li class="part drop fnt style" skinPart="formatBlock" skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop fnt font" skinPart="fontFamily"  skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop fnt fontsize" skinPart="fontSize"    skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="divider"></li><li class="part cols color fc" skinPart="foreColor"   skin="wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin"></li><li class="divider"></li><li class="part btn" skinPart="bold"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="italic"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="underline" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="removeFormat" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><ul><li class="part drop size sp" skinPart="letterSpacing" skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="part drop size hg" skinPart="lineHeight"    skin="wysiwyg.editor.skins.richtext.ToolBarWritableDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="outdent"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="indent"       skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="numberedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bulletedlist" skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part btn" skinPart="bidiltr"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="bidirtl"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="divider"></li><li class="part cols justify" skinPart="justify"       skin="wysiwyg.editor.skins.richtext.ToolBarDropDownSkin"></li><li class="divider"></li><li class="part btn" skinPart="wixLink"      skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li><li class="part btn" skinPart="wixUnlink"    skin="wysiwyg.editor.skins.richtext.RichTextEditorButton"></li></ul><div class="close" skinpart="closeButton"></div><div class="drag" skinPart="dragArea"></div></div>')}),define.experiment.skin("wixapps.integration.skins.editor.WixAppsToolBarSkin.RichTextToolbar.New",function(e){var t=e;t.inherits("mobile.core.skins.BaseSkin"),t.compParts({formatBlock:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddStyle"},fontFamily:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddFont"},justify:{skin:"wysiwyg.editor.skins.richtext.ToolBarIconsDropDownSkin",styleGroup:"toolbarBtn"},fontSize:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddFontSize"},letterSpacing:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddSize"},lineHeight:{skin:"wysiwyg.editor.skins.richtext.ToolBarDropDownSkin",styleGroup:"ddSize"},bold:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},italic:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},underline:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},removeFormat:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},outdent:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},indent:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},numberedlist:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bulletedlist:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bidiltr:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},bidirtl:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},wixLink:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},wixUnlink:{skin:"wysiwyg.editor.skins.richtext.RichTextEditorButton",styleGroup:"toolbarBtn"},foreColor:{skin:"wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin",styleGroup:"toolbarBtn"},backColor:{skin:"wysiwyg.editor.skins.richtext.ColorSelectorRTEButtonSkin",styleGroup:"toolbarBackgroundBtn"}}),t.html('<div class="container"><ul><li class="part drop style" skinPart="formatBlock" ></li><li class="part drop font" skinPart="fontFamily"  ></li><li class="part drop" skinPart="fontSize" ></li><li class="divider"></li><li class="part cols" skinPart="foreColor"  ></li><li class="part cols" skinPart="backColor"></li><li class="divider"></li><li class="part" skinPart="bold"></li><li class="part" skinPart="italic"></li><li class="part" skinPart="underline" ></li><li class="divider"></li><li class="part cols justify" skinPart="justify"></li><li class="part" skinPart="removeFormat"></li></ul><ul><li class="part drop size spacing" skinPart="letterSpacing"></li><li class="part drop size lines" skinPart="lineHeight"></li><li class="divider"></li><li class="part" skinPart="outdent"></li><li class="part" skinPart="indent"></li><li class="divider"></li><li class="part" skinPart="numberedlist" ></li><li class="part" skinPart="bulletedlist" ></li><li class="divider"></li><li class="part" skinPart="bidiltr" ></li><li class="part" skinPart="bidirtl" ></li><li class="divider"></li><li class="part" skinPart="wixLink"  ></li><li class="part" skinPart="wixUnlink"></li></ul><div class="close" skinpart="closeButton"></div><div class="drag" skinPart="dragArea"></div></div>'),t.skinParams([{id:"rd",type:Constants.SkinParamTypes.BORDER_RADIUS,defaultValue:"3px"},{id:"shd",type:Constants.SkinParamTypes.BOX_SHADOW,defaultValue:"0 3px 10px rgba(0,0,0,0.35)"},{id:"tdr",type:Constants.SkinParamTypes.URL,defaultTheme:"WEB_THEME_DIRECTORY"}]),t.css(["%.container% {display:inline-block; font-size:11px; position:relative; color:#353535; background:#fff; [shd][rd]}",'%.drag%  {display: none; left :2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/dragdots.png")  no-repeat 50% 50%; [rd] cursor:move;}','%.close% {right:2px; position:absolute; top:1px; bottom:1px; width:15px; background:url("[tdr]richtext/xclose.png") no-repeat 50% 4px; [rd]; cursor: pointer; }','%.close%:after { position:absolute; content:""; left:-2px; top:1px; bottom:1px; width:2px; background:url("[tdr]richtext/bigvertdevider.png") no-repeat 50% 50%; }',"ul {position:relative; padding:2px; margin:0 20px 0 0;}",'li.divider { background:url("[tdr]richtext/vertdevider.png") no-repeat 50% 50%; position:relative; height:22px; width:2px; margin:0 2px; display:inline-block; vertical-align:middle;}',"li.part {border:1px solid transparent; [rd] position:relative; line-height:22px; height:22px; min-width:22px; margin:1px; display:inline-block; vertical-align:middle; }",'li[disabled="disabled"] { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }','li[state~="disabled"]   { background-color: rgba(0, 0, 0, 0.15) !important; opacity:0.25 !important; }',"%formatBlock% {width:80px;}","%fontFamily% {width:100px;}","%fontSize% {width:50px;}","%letterSpacing% {width:106px;}","%lineHeight% {width:106px;}","li.cols {width:40px;}",'li.size:before {position:absolute; content:""; top:0px; left:0px; bottom:0px; width:24px; background:#f0f0f0 url("[tdr]richtext/icons.png") no-repeat; border:1px solid #ddd; line-height:22px; border-radius:3px 0 0 3px; pointer-events:none;}',"li.spacing:before {background-position:2px -220px}","li.lines:before {background-position:2px -240px}"])
}),define.experiment.dataThemeItem("RTInlineAppsToolBar.RichTextToolbar.New",function(e){var t=e;return t.merge({style:{groups:{toolbarBackgroundBtn:{properties:{hover:"border:1px solid #ddd !important; background-color:#fff; box-shadow: 0 1px 0 rgba(0,0,0,0.1)",sel:"border:1px solid #fff; background-color:#d5effe; box-shadow: inset 0 1px 0 rgba(0,0,0,0.4)",bgPosition:"1px -19px"},groups:{},propertiesSource:{minWidth:"value",minHeight:"value",icnoWidth:"value",iconHeight:"value",labelDisplay:"value",iconDisplay:"value",hover:"value",sel:"value"}}}}})}),define.experiment.dataThemeItem("RTAppBuilderToolBar.RichTextToolbar.New",function(e){var t=e;return t.merge({style:{groups:{toolbarBackgroundBtn:{properties:{hover:"border:1px solid #ddd !important; background-color:#fff; box-shadow: 0 1px 0 rgba(0,0,0,0.1)",sel:"border:1px solid #fff; background-color:#d5effe; box-shadow: inset 0 1px 0 rgba(0,0,0,0.4)",bgPosition:"1px -19px"},groups:{},propertiesSource:{minWidth:"value",minHeight:"value",icnoWidth:"value",iconHeight:"value",labelDisplay:"value",iconDisplay:"value",hover:"value",sel:"value"}}}}})}),define.experiment.Class("wixapps.integration.utils.flex.BoxFlexPolyfill.WixAppsFireFoxNewFlex.New",function(e){e.statics({createFlexPolyfill:function(e){var t;if(this.forceComputedFlex||!Modernizr.flexbox&&!Modernizr.flexboxlegacy)t=new this.prototype.imports.ComputedFlex(e);else if(Browser.firefox)t=Browser.version>=22?new this.prototype.imports.FirefoxFlex(!1):new this.prototype.imports.FirefoxFlex(!0);else{var i=this.forceLegacyFlex===!0||!Boolean(Modernizr.flexbox);t=Browser.chrome||Browser.safari?new this.prototype.imports.WebkitFlex(i):Browser.ie?new this.prototype.imports.MSIEFlex:new this.prototype.imports.NativeFlex}return t}})});